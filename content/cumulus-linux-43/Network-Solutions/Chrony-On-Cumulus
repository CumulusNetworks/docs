---
title: Chrony on Cumulus Linux
author: NVIDIA
weight: 1341
toc: 5
---
You can use Chrony as the time provider on Cumulus Linux devices. The high level steps to install Chrony on Cumulus Linux are as follows:

*Allow upstream repositories by editing the `/etc/apt/sources.list` file.
*Update the local index from source using APT.
*Remove and purge NTP.
*Install chrony.
*Edit the system configuration to instantiate chrony as management service.
*Add a low latency time source to the chrony configuration. 

-------------------------------

1. Allow upstream repositories by editing the `/etc/apt/sources.list` file.

```
root@cumulus:mgmt:/home/cumulus# sudo vi /etc/apt/sources.list
```

```
# Cumulus Linux package repository
deb      http://apt.cumulusnetworks.com/repo CumulusLinux-4-latest cumulus upstream netq
deb-src  http://apt.cumulusnetworks.com/repo CumulusLinux-4-latest cumulus upstream netq

# NetQ package repository
#
deb  http://apps3.cumulusnetworks.com/repos/deb/ CumulusLinux-4 netq-latest

# Debian 10 Buster main package repositories
# Uncomment these if you want to install upstream Debian packages
# that are not mirrored in the Cumulus Linux repositories.
# Packages installed this way may cause problems, and are not
# officially supported by Cumulus Networks, Inc.
deb     http://deb.debian.org/debian buster main
deb     http://deb.debian.org/debian buster-updates main
deb     http://security.debian.org buster/updates main
deb     http://deb.debian.org/debian buster-backports main

# Debian 10 Buster main package source repositories
# Only need to uncomment these if you want to install
# upstream Debian source packages
#deb-src http://deb.debian.org/debian buster main
#deb-src http://deb.debian.org/debian buster-updates main
#deb-src http://security.debian.org buster/updates main
#deb-src http://deb.debian.org/debian buster-backports main
```

2.Update the local index from source using APT. 

```
root@cumulus:mgmt:/home/cumulus# sudo -E apt-get update

```

3. Remove and purge NTP from the system:

```
root@cumulus:mgmt:/home/cumulus# sudo -E apt-get -y purge --auto-remove ntp

```


4. Remove and purge NTP from the system:

```
root@cumulus:mgmt:/home/cumulus# sudo -E apt-get -y purge --auto-remove ntp

```

5. Install chrony.

```
root@cumulus:mgmt:/home/cumulus# sudo -E apt-get -y install chrony

```

6. Add chrony to the system startup configuration in the `/etc/vrf/systemd.conf` systemd configuraton file and add as a management VRF service.

```
root@cumulus:mgmt:/home/cumulus# sudo vi /etc/vrf/systemd.conf

```

```
# Systemd-based services that are expected to be run in a VRF context.
#
# If changes are made to this file run systemctl daemon-reload
# to re-generate systemd files.

chef-client
collectd
dhcpd
dhcrelay
docker
hsflowd
netq-agent
netq-notifier
netqd
nslcd
ntp
puppet
salt-minion
snmpd
snmptrapd
ssh
zabbix-agent
chrony <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

```

```
root@cumulus:mgmt:/home/cumulus# systemctl stop chronyd
root@cumulus:mgmt:/home/cumulus# systemctl disable chronyd
root@cumulus:mgmt:/home/cumulus# systemctl enable chrony@mgmt
root@cumulus:mgmt:/home/cumulus# systemctl restart chrony@mgmt
root@cumulus:mgmt:/home/cumulus# systemctl daemon-reload

```

6. For optimal performance add a low latency time source `/etc/chrony/chrony.conf` configuration file. 
This can be verified use the `chronyc sources -v` syntax 

```
root@cumulus:mgmt:/home/cumulus# chronyc sources -v
210 Number of sources = 1

  .-- Source mode  '^' = server, '=' = peer, '#' = local clock.
 / .- Source state '*' = current synced, '+' = combined , '-' = not combined,
| /   '?' = unreachable, 'x' = time may be in error, '~' = time too variable.
||                                                 .- xxxx [ yyyy ] +/- zzzz
||      Reachability register (octal) -.           |  xxxx = adjusted offset,
||      Log2(Polling interval) --.      |          |  yyyy = measured offset,
||                                \     |          |  zzzz = estimated error.
||                                 |    |           \
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^* master_source.local.>     2   6    77     6  -1102us[ -108ms] +/- 2754us
```

References:
Chrony project page: https://chrony.tuxfamily.org



