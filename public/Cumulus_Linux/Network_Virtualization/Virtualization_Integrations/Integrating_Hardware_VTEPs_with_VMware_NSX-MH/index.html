<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Integrating Hardware VTEPs with VMware NSX-MH | Cumulus Networks Documentation</title>

  
  <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">

  
  
  
  <link rel="stylesheet" href="/book.min.a4ec20f62c4bbaad99f9db40524ec8653f6279bcde229add21ff46dfd05dfa96.css">

  
  <link rel="icon" href="/favicon.png" type="image/x-icon">

  
  <!--
  Made with Book Theme
  https://github.com/alex-shpak/hugo-book
  -->

</head>


<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  
  <header id="site-nav">
    <div class="header-wrapper flex">
      <a href="/">
        <img src="/header-logo.png" alt="Cumulus Networks">
        <img src="/cumulus-networks-rt-white.svg" alt="Cumulus Networks" class="header-mobile">
        <span>Docs</span>
      </a>
      <ul class="flex">
        <li><a href="//cumulusnetworks.com">HOME</a></li>
        <li><a href="//support.cumulusnetworks.com/">SUPPORT</a></li>
        <li><a href="//docs.cumulusnetworks.com/">DOCS</a></li>
        <li><a href="//education.cumulusnetworks.com">EDUCATION</a></li>
        <li><a href="//cumulusnetworks.com/blog/">BLOG</a></li>
        <li><a href="//forums.cumulusnetworks.com/">FORUMS</a></li>
      </ul>
      <div class="burger-menu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  <div id="product-nav" class="flex">
    <ul>
      <li class="active"><a href="/Cumulus_Linux/">Cumulus Linux</a></li>
      <li><a href="/Cumulus_NetQ/">Cumulus NetQ</a></li>
      <li><a href="/Chassis/">Cumulus Express</a></li>
      <li><a href="">Cumulus VX</a></li>
    </ul>
    <div class="search-container">
      <div id="doc-search-box">
        <input type="text" class="doc-search-input" placeholder="Search" value="">
        <span><button type="submit"><img src="/icons/search_20x20.svg" alt=""></button></span>
      </div>
      <div id="dropdown" class="dropdown">
          <button class="btn" type="button" id="dropdownMenuButton">
            v3.76
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#">v3.5</a>
            <a class="dropdown-item" href="#">v2.1</a>
            <a class="dropdown-item" href="#">v1.43</a>
          </div>
      </div>
    </div>
  </div>
  <main class="flex container">
    <aside class="book-menu fixed">

      <nav role="navigation">
        <h2 class="book-brand">
          <a href="http://example.org/">Cumulus Networks Documentation</a>
        </h2>
        
        




  <ul id = "top" class = "cn-book-section-container">
  
    

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/" >
    Cumulus Linux 3.7.7
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Cumulus_Linux_User_Guide/" >
    Cumulus Linux User Guide
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Quick_Start_Guide/" >
    Quick Start Guide
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Installation_Management/" >
    Installation Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Managing_Cumulus_Linux_Disk_Images/" >
    Managing Cumulus Linux Disk Images
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Installing_a_New_Cumulus_Linux_Image/" >
    Installing a New Cumulus Linux Image
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Upgrading_Cumulus_Linux/" >
    Upgrading Cumulus Linux
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Using_Snapshots/" >
    Using Snapshots
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Adding_and_Updating_Packages/" >
    Adding and Updating Packages
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Installation_Management/Zero_Touch_Provisioning_-_ZTP/" >
    Zero Touch Provisioning - ZTP
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/System_Configuration/" >
    System Configuration
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/" >
    Authentication, Authorization and Accounting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/SSH_for_Remote_Access/" >
    SSH for Remote Access
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/User_Accounts/" >
    User Accounts
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/Using_sudo_to_Delegate_Privileges/" >
    Using sudo to Delegate Privileges
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/LDAP_Authentication_and_Authorization/" >
    LDAP Authentication and Authorization
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/TACACS_Plus/" >
    TACACS Plus
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Authentication_Authorization_and_Accounting/RADIUS_AAA/" >
    RADIUS AAA
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/System_Configuration/Netfilter_-_ACLs/" >
    Netfilter - ACLs
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Netfilter_-_ACLs/Default_Cumulus_Linux_ACL_Configuration/" >
    Default Cumulus Linux ACL Configuration
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Netfilter_-_ACLs/Filtering_Learned_MAC_Addresses/" >
    Filtering Learned MAC Addresses
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Network_Command_Line_Utility_-_NCLU/" >
    Network Command Line Utility - NCLU
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Setting_Date_and_Time/" >
    Setting Date and Time
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Services_and_Daemons_in_Cumulus_Linux/" >
    Services and Daemons in Cumulus Linux
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Configuring_switchd/" >
    Configuring switchd
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Power_over_Ethernet_-_PoE/" >
    Power over Ethernet - PoE
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/Configuring_a_Global_Proxy/" >
    Configuring a Global Proxy
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/System_Configuration/HTTP_API/" >
    HTTP API
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/" >
    Layer 1 and Switch Ports
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Interface_Configuration_and_Management/" >
    Interface Configuration and Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Interface_Configuration_and_Management/Switch_Port_Attributes/" >
    Switch Port Attributes
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Interface_Configuration_and_Management/ifplugd/" >
    ifplugd
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Buffer_and_Queue_Management/" >
    Buffer and Queue Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Buffer_and_Queue_Management/Hardware-enabled_DDOS_Protection/" >
    Hardware-enabled DDOS Protection
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/DHCP_Relays/" >
    DHCP Relays
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/DHCP_Servers/" >
    DHCP Servers
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Facebook_Voyager_Optical_Interfaces/" >
    Facebook Voyager Optical Interfaces
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/802.1X_Interfaces/" >
    802.1X Interfaces
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_1_and_Switch_Ports/Prescriptive_Topology_Manager_-_PTM/" >
    Prescriptive Topology Manager - PTM
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_2/" >
    Layer 2
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_2/Link_Layer_Discovery_Protocol/" >
    Link Layer Discovery Protocol
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Link_Layer_Discovery_Protocol/Voice_VLAN/" >
    Voice VLAN
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_2/Ethernet_Bridging_-_VLANs/" >
    Ethernet Bridging - VLANs
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Ethernet_Bridging_-_VLANs/VLAN-aware_Bridge_Mode/" >
    VLAN-aware Bridge Mode
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Ethernet_Bridging_-_VLANs/Traditional_Bridge_Mode/" >
    Traditional Bridge Mode
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Ethernet_Bridging_-_VLANs/VLAN_Tagging/" >
    VLAN Tagging
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Spanning_Tree_and_Rapid_Spanning_Tree/" >
    Spanning Tree and Rapid Spanning Tree
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Bonding_-_Link_Aggregation/" >
    Bonding - Link Aggregation
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Multi-Chassis_Link_Aggregation_-_MLAG/" >
    Multi-Chassis Link Aggregation - MLAG
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/LACP_Bypass/" >
    LACP Bypass
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/Virtual_Router_Redundancy_-_VRR_and_VRRP/" >
    Virtual Router Redundancy - VRR and VRRP
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_2/IGMP_and_MLD_Snooping/" >
    IGMP and MLD Snooping
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Network_Virtualization/" >
    Network Virtualization
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Network_Virtualization/Static_VXLAN_Configurations/" >
    Static VXLAN Configurations
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Static_VXLAN_Configurations/Static_VXLAN_Tunnels/" >
    Static VXLAN Tunnels
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Static_VXLAN_Configurations/Static_MAC_Bindings_with_VXLAN/" >
    Static MAC Bindings with VXLAN
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Network_Virtualization/Lightweight_Network_Virtualization_Overview/" >
    Lightweight Network Virtualization Overview
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Lightweight_Network_Virtualization_Overview/LNV_Full_Example/" >
    LNV Full Example
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/" >
    Virtualization Integrations
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack/" >
    Integrating Hardware VTEPs with Midokura MidoNet and OpenStack
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/Integrating_Hardware_VTEPs_with_VMware_NSX-V/" >
    Integrating Hardware VTEPs with VMware NSX-V
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/Integrating_Hardware_VTEPs_with_VMware_NSX-MH/"  class="active" >
    Integrating Hardware VTEPs with VMware NSX-MH
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/OVSDB_Server_High_Availability/" >
    OVSDB Server High Availability
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Ethernet_Virtual_Private_Network_-_EVPN/" >
    Ethernet Virtual Private Network - EVPN
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/VXLAN_Active-Active_Mode/" >
    VXLAN Active-Active Mode
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/VXLAN_Routing/" >
    VXLAN Routing
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/VXLAN_Scale/" >
    VXLAN Scale
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Hybrid_Cloud_Connectivity_with_QinQ_and_VXLANs/" >
    Hybrid Cloud Connectivity with QinQ and VXLANs
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Virtualization/Troubleshooting_VXLANs/" >
    Troubleshooting VXLANs
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_3/" >
    Layer 3
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_3/FRRouting_Overview/" >
    FRRouting Overview
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/FRRouting_Overview/Upgrading_from_Quagga_to_FRRouting/" >
    Upgrading from Quagga to FRRouting
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Layer_3/Configuring_FRRouting/" >
    Configuring FRRouting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Configuring_FRRouting/Comparing_NCLU_and_vtysh_Commands/" >
    Comparing NCLU and vtysh Commands
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Routing/" >
    Routing
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Introduction_to_Routing_Protocols/" >
    Introduction to Routing Protocols
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Network_Topology/" >
    Network Topology
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Address_Resolution_Protocol_-_ARP/" >
    Address Resolution Protocol - ARP
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Open_Shortest_Path_First_-_OSPF/" >
    Open Shortest Path First - OSPF
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Open_Shortest_Path_First_v3_-_OSPFv3/" >
    Open Shortest Path First v3 - OSPFv3
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Border_Gateway_Protocol_-_BGP/" >
    Border Gateway Protocol - BGP
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Policy-based_Routing/" >
    Policy-based Routing
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Bidirectional_Forwarding_Detection_-_BFD/" >
    Bidirectional Forwarding Detection - BFD
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP/" >
    Equal Cost Multipath Load Sharing - Hardware ECMP
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Redistribute_Neighbor/" >
    Redistribute Neighbor
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Virtual_Routing_and_Forwarding_-_VRF/" >
    Virtual Routing and Forwarding - VRF
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Management_VRF/" >
    Management VRF
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/GRE_Tunneling/" >
    GRE Tunneling
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Protocol_Independent_Multicast_-_PIM/" >
    Protocol Independent Multicast - PIM
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Layer_3/Segment_Routing/" >
    Segment Routing
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/" >
    Monitoring and Troubleshooting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Monitoring_System_Hardware/" >
    Monitoring System Hardware
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Monitoring_System_Hardware/Network_Switch_Port_LED_and_Status_LED_Guidelines/" >
    Network Switch Port LED and Status LED Guidelines
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Understanding_the_cl-support_Output_File/" >
    Understanding the cl-support Output File
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Understanding_the_cl-support_Output_File/Troubleshooting_Log_Files/" >
    Troubleshooting Log Files
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Understanding_the_cl-support_Output_File/Troubleshooting_the_etc_Directory/" >
    Troubleshooting the etc Directory
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Troubleshooting_Network_Interfaces/" >
    Troubleshooting Network Interfaces
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Troubleshooting_Network_Interfaces/Monitoring_Interfaces_and_Transceivers_Using_ethtool/" >
    Monitoring Interfaces and Transceivers Using ethtool
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Troubleshooting_Network_Interfaces/Monitoring_Interfaces_and_Transceivers_Using_ethtool_-ethtool_Counter_Definitions/" >
    Monitoring Interfaces and Transceivers Using ethtool — ethtool Counter Definitions
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Network_Troubleshooting/" >
    Network Troubleshooting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Network_Troubleshooting/Using_NCLU_to_Troubleshoot_Your_Network_Configuration/" >
    Using NCLU to Troubleshoot Your Network Configuration
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Network_Troubleshooting/Monitoring_System_Statistics_and_Network_Traffic_with_sFlow/" >
    Monitoring System Statistics and Network Traffic with sFlow
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/" >
    Simple Network Management Protocol (SNMP) Monitoring
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Simple_Network_Management_Protocol_SNMP_Monitoring/Using_Nutanix_Prism_as_a_Monitoring_Tool/" >
    Using Nutanix Prism as a Monitoring Tool
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Single_User_Mode_-_Boot_Recovery/" >
    Single User Mode - Boot Recovery
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Resource_Diagnostics_Using_cl-resource-query/" >
    Resource Diagnostics Using cl-resource-query
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Monitoring_Virtual_Device_Counters/" >
    Monitoring Virtual Device Counters
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/ASIC_Monitoring/" >
    ASIC Monitoring
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/Monitoring_Best_Practices/" >
    Monitoring Best Practices
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/switchd_Log_Message_Reference/" >
    switchd Log Message Reference
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Monitoring_and_Troubleshooting/FRRouting_Log_Message_Reference/" >
    FRRouting Log Message Reference
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="/Cumulus_Linux/Network_Solutions/" >
    Network Solutions
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/Data_Center_Host_to_ToR_Architecture/" >
    Data Center Host to ToR Architecture
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/Cumulus_Networks_Services_Demos/" >
    Cumulus Networks Services Demos
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/Docker_on_Cumulus_Linux/" >
    Docker on Cumulus Linux
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/OpenStack_Neutron_ML2_and_Cumulus_Linux/" >
    OpenStack Neutron ML2 and Cumulus Linux
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/Anycast_Design_Guide/" >
    Anycast Design Guide
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/RDMA_over_Converged_Ethernet_-_RoCE/" >
    RDMA over Converged Ethernet - RoCE
  </a>


    </li>
    
    <li >
      

  <a href="/Cumulus_Linux/Network_Solutions/Cumulus_Hyperconverged_Solution_with_Nutanix/" >
    Cumulus Hyperconverged Solution with Nutanix
  </a>


    </li>
    
  </ul>


  </li>


    
    
  </ul>


  </li>


  
  </ul>









      </nav>

      
      
      
      

      <script src = "http://example.org/js/menuBundle.js"> </script>

    </aside>

    <div class="book-page">

      
      <header class="align-center justify-between book-header">
        <label for="menu-control">
          <img src="/svg/menu.svg" alt="Menu" />
        </label>
        <strong>Integrating Hardware VTEPs with VMware NSX-MH</strong>
      </header>

      
      
<article class="markdown">
<h1>Integrating Hardware VTEPs with VMware NSX-MH</h1>

<p>Switches running Cumulus Linux can integrate with VMware NSX
Multi-Hypervisor (MH) to act as hardware VTEP gateways. The VMware
NSX-MH controller provides consistent provisioning across virtual and
physical server infrastructures.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_nsx.png" alt = "/images/download/attachments/8362796/vxlan_nsx.png"


width = 500

 />


<p>Cumulus Linux also supports integration with VMware NSX in high
availability mode. Refer to <a href="/old/Cumulus_Linux/OVSDB_Server_High_Availability.html">OVSDB Server High
Availability</a>.</p>

<h2 id="getting-started">Getting Started</h2>

<p>Before you integrate VXLANs with NSX-MH, make sure you have a layer 2
gateway; a Broadcom Tomahawk, Trident II+, Trident II, Maverick, or
Mellanox Spectrum switch running Cumulus Linux. Cumulus Linux includes
OVSDB server (<code>ovsdb-server</code>) and VTEPd (<code>ovs-vtepd</code>), which support
<a href="/old/Cumulus_Linux/VLAN-aware_Bridge_Mode.html">VLAN-aware bridges</a>.</p>

<p>To integrate a VXLAN with NSX-MH, you need to:</p>

<ul>
<li><p>Configure the NSX-MH integration on the switch.</p></li>

<li><p>Configure the transport and logical layers from the NSX Manager.</p></li>

<li><p>Verify the VXLAN configuration.</p></li>
</ul>


<div class="notices note" > <p>Cumulus Linux supports security protocol version TLSv1.2 for SSL
connections between the OVSDB server and the NSX controller.</p>

<p>The OVSDB server cannot select the loopback interface as the source IP
address, causing top of rack registration to the controller to fail. To
work around this issue, run the <code>net add bgp redistribute connected</code>
command followed by the <code>net commit</code> command.</p>
 </div>


<h2 id="configure-the-switch-for-nsx-mh-integration">Configure the Switch for NSX-MH Integration</h2>

<p>Before you start configuring the gateway service, logical switches, and
ports that comprise the VXLAN, you need to enable and start the
<code>openvswitch-vtep</code> service, and configure the NSX integration on the
switch, either using the script or performing the manual configuration.</p>

<h3 id="start-the-openvswitch-vtep-service">Start the openvswitch-vtep Service</h3>

<p>To enable and start the <code>openvswitch-vtep</code> service, run the following
command:</p>

<pre><code>                   
cumulus@switch:~$ sudo systemctl enable openvswitch-vtep.service
cumulus@switch:~$ sudo systemctl start openvswitch-vtep.service
   
    
</code></pre>


<div class="notices note" > <p>In previous versions of Cumulus Linux, you had to edit the
<code>/etc/default/openvswitch-vtep</code> file and then start the
<code>openvswitch-vtep</code> service . Now, you just have to enable and start the
<code>openvswitch-vtep</code> service .</p>
 </div>


<h3 id="configure-the-nsx-mh-integration-using-the-configuration-script">Configure the NSX-MH Integration Using the Configuration Script</h3>

<p>A script is available so you can configure the NSX-MH integration on the
switch automatically.</p>

<p>In a terminal session connected to the switch, run the <code>vtep-bootstrap</code>
command with these options:</p>

<ul>
<li><p><code>controller_ip</code> is the IP address of the NSX controller
(192.168.100.17 in the example command below).</p></li>

<li><p>The ID for the VTEP (<code>vtep7</code> in the example command below).</p></li>

<li><p>The datapath IP address of the VTEP (<code>172.16.20.157</code> in the example
command below). This is the VXLAN anycast IP address.</p></li>

<li><p>The IP address of the management interface on the switch
(<code>192.168.100.157</code> in the example command below). This interface is
used for control traffic.</p></li>
</ul>

<!-- end list -->

<pre><code>                   
cumulus@switch:~$ vtep-bootstrap --controller_ip 192.168.100.17 vtep7 172.16.20.157 192.168.100.157
Executed: 
    create certificate on a switch, to be used for authentication with controller
     ().
Executed: 
    sign certificate
     (vtep-req.pem  Tue Sep 11 21:11:27 UTC 2018
        fingerprint a4cda030fe5e458c0d7ba44e22f52650f01bcd75).
Executed: 
    define physical switch
     ().
Executed: 
    define NSX controller IP address in OVSDB
     ().
Executed: 
    define local tunnel IP address on the switch
     ().
Executed: 
    define management IP address on the switch
     ().
Executed: 
    restart a service
     ().
   
    
</code></pre>

<p>Run the following commands in the order shown to complete the
configuration process:</p>

<pre><code>                   
cumulus@switch:~$ sudo systemctl restart openvswitch-vtep.service
cumulus@switch:~$ sudo ifreload -a
cumulus@switch:~$ sudo systemctl restart networking.service
   
    
</code></pre>

<h3 id="configure-the-nsx-mh-integration-manually">Configure the NSX-MH Integration Manually</h3>


<div class="notices note" > <p>You can configure the NSX-V integration manually for standalone mode
only; manual configuration for OVSDB server high availability is not
supported.</p>
 </div>


<p>If you do <em>not</em> want to use the configuration script to configure the
NSX-MH integration on the switch automatically, you can configure the
integration manually, which requires you to perform the following steps:</p>

<ul>
<li><p>Generate a certificate and key pair for authentication by NSX.</p></li>

<li><p>Configure the switch as a VTEP gateway.</p></li>
</ul>

<h4 id="generate-the-credentials-certificate">Generate the Credentials Certificate</h4>

<p>In Cumulus Linux, generate a certificate that the NSX controller uses
for authentication.</p>

<ol>
<li><p>In a terminal session connected to the switch, run the following
commands:</p>

<pre><code>                       
cumulus@switch:~$ sudo ovs-pki init
Creating controllerca...
Creating switchca...
cumulus@switch:~$ sudo ovs-pki req+sign cumulus
 
cumulus-req.pem Wed Oct 23 05:32:49 UTC 2013
        fingerprint b587c9fe36f09fb371750ab50c430485d33a174a
 
cumulus@switch:~$ ls -l
total 12
-rw-r--r-- 1 root root 4028 Oct 23 05:32 cumulus-cert.pem
-rw------- 1 root root 1679 Oct 23 05:32 cumulus-privkey.pem
-rw-r--r-- 1 root root 3585 Oct 23 05:32 cumulus-req.pem
       
        
</code></pre></li>

<li><p>In the <code>/usr/share/openvswitch/scripts/ovs-ctl-vtep</code> file, make sure
the lines containing <strong>private-key</strong>, <strong>certificate</strong>, and
<strong>bootstrap-ca-cert</strong> point to the correct files;
<strong>bootstrap-ca-cert</strong> is obtained dynamically the first time the
switch talks to the controller:</p>

<pre><code>                       
# Start ovsdb-server.
set ovsdb-server &quot;$DB_FILE&quot;
set &quot;$@&quot; -vANY:CONSOLE:EMER -vANY:SYSLOG:ERR -vANY:FILE:INFO
set &quot;$@&quot; --remote=punix:&quot;$DB_SOCK&quot;
set &quot;$@&quot; --remote=db:Global,managers
set &quot;$@&quot; --remote=ptcp:6633:$LOCALIP
set &quot;$@&quot; --private-key=/root/cumulus-privkey.pem
set &quot;$@&quot; --certificate=/root/cumulus-cert.pem
set &quot;$@&quot; --bootstrap-ca-cert=/root/controller.cacert
       
        
</code></pre>

<p>If files have been moved or regenerated, restart the OVSDB server
and VTEPd:</p>

<pre><code>                       
cumulus@switch:~$ sudo systemctl restart openvswitch-vtep.service
       
        
</code></pre></li>

<li><p>Define the NSX controller cluster IP address in OVSDB. This causes
the OVSDB server to start contacting the NSX controller:</p>

<pre><code>                       
cumulus@switch:~$ sudo vtep-ctl set-manager ssl:192.168.100.17:6632
       
        
</code></pre></li>

<li><p>Define the local IP address on the VTEP for VXLAN tunnel
termination. First, find the physical switch name as recorded in
OVSDB:</p>

<pre><code>                       
cumulus@switch:~$ sudo vtep-ctl list-ps
vtep7
       
        
</code></pre>

<p>Then set the tunnel source IP address of the VTEP. This is the
datapath address of the VTEP, which is typically an address on a
loopback interface on the switch that is reachable from the
underlying layer 3 network:</p>

<pre><code>                       
cumulus@switch:~$ sudo vtep-ctl set Physical_Switch vtep7 tunnel_ips=172.16.20.157
       
        
</code></pre></li>
</ol>

<p>After you generate the certificate, keep the terminal session active;
you need to paste the certificate into NSX Manager when you configure
the VTEP gateway.</p>

<h4 id="enable-ovs-vtepd-to-use-the-vlan-aware-bridge">Enable ovs-vtepd to Use the VLAN-aware Bridge</h4>

<p>By default, in stand-alone mode, the ovs-vtep daemon creates traditional
bridges for each VXLAN VTEP. To use the VLAN-aware bridge with the
VTEPs, edit the <code>/usr/share/openvswitch/scripts/ovs-ctl-vtep</code> file and
uncomment the <code>--enable-vlan-aware-mode</code> line:</p>

<pre><code>                   
# Start ovs-vtepd
set ovs-vtepd unix:“$DB_SOCK”
set “$@” -vconsole:emer -vsyslog:err -vfile:info
#set “$@” --enable-vlan-aware-mode
   
    
</code></pre>

<p>Then restart the OVSDB server and VTEPd:</p>

<pre><code>                   
cumulus@switch:~$ sudo systemctl restart openvswitch-vtep.service
   
    
</code></pre>

<h2 id="provision-vmware-nsx-v">Provision VMware NSX-V</h2>

<h3 id="configure-the-switch-as-a-vtep-gateway">Configure the Switch as a VTEP Gateway</h3>

<p>After you create a certificate, connect to NSX Manager in a browser to
configure a Cumulus Linux switch as a VTEP gateway. In this example, the
IP address of the NSX Manager is 192.168.100.12.</p>

<ol>
<li><p>In NSX Manager, add a new gateway. Click the <strong>Network Components</strong>
tab, then the <strong>Transport Layer</strong> category. Under <strong>Transport
Node</strong>, click <strong>Add</strong>, then select <strong>Manually Enter All Fields</strong>.
The Create Gateway wizard opens.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_netcomponents.png" alt = "/images/download/attachments/8362796/vxlan_netcomponents.png"


width = 500

 />
</li>

<li><p>In the Create Gateway dialog, select <em>Gateway</em> for the <strong>Transport
Node Type</strong>, then click <strong>Next</strong>.</p></li>

<li><p>In the <strong>Display Name</strong> field, provide a name for the gateway, then
click <strong>Next</strong>.</p></li>

<li><p>Enable the VTEP service. Select the <strong>VTEP Enabled</strong> checkbox, then
click <strong>Next</strong>.</p></li>

<li><p>From the terminal session connected to the switch where you
generated the certificate, copy the certificate and paste it into
the <strong>Security Certificate</strong> text field. Copy only the bottom
portion, including the <code>BEGIN CERTIFICATE</code> and <code>END CERTIFICATE</code>
lines. For example, copy all the highlighted text in the terminal:</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_cert_term.png" alt = "/images/download/attachments/8362796/vxlan_cert_term.png"


width = 500

 />


<p>Paste it into NSX Manager, then click <strong>Next</strong>:</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_nsx_cert.png" alt = "/images/download/attachments/8362796/vxlan_nsx_cert.png"


width = 500

 />
</li>

<li><p>In the Connectors dialog, click <strong>Add Connector</strong> to add a transport
connector. This defines the tunnel endpoint that terminates the
VXLAN tunnel and connects NSX to the physical gateway. You must
choose a tunnel <strong>Transport Type</strong> of <em>VXLAN</em>. Choose an existing
transport zone for the connector or click <strong>Create</strong> to create a new
transport zone.</p></li>

<li><p>Define the IP address of the connector (the underlay IP address on
the switch for tunnel termination).</p></li>

<li><p>Click <strong>OK</strong> to save the connector, then click <strong>Save</strong> to save the
gateway.</p></li>
</ol>

<p>After communication is established between the switch and the
controller, a <code>controller.cacert</code> file downloads onto the switch.</p>

<p>Verify that the controller and switch handshake is successful. In a
terminal connected to the switch, run this command:</p>

<pre><code>                   
cumulus@switch:~$ sudo ovsdb-client dump -f list | grep -A 7 &quot;Manager&quot;
Manager table
_uuid               : 505f32af-9acb-4182-a315-022e405aa479
inactivity_probe    : 30000
is_connected        : true
max_backoff         : []
other_config        : {}
status              : {sec_since_connect=&quot;18223&quot;, sec_since_disconnect=&quot;18225&quot;, state=ACTIVE}
target              : &quot;ssl:192.168.100.17:6632&quot;
   
    
</code></pre>

<h2 id="configure-the-transport-and-logical-layers">Configure the Transport and Logical Layers</h2>

<h3 id="configure-the-transport-layer">Configure the Transport Layer</h3>

<p>After you finish configuring the NSX-MH integration on the switch,
configure the transport layer. For each host-facing switch port to be
associated with a VXLAN instance, define a <strong>Gateway Service</strong> for the
port.</p>

<ol>
<li><p>In NSX Manager, add a new gateway service. Click the <strong>Network
Components</strong> tab, then the <strong>Services</strong> category. Under <strong>Gateway
Service</strong>, click <strong>Add</strong>. The Create Gateway Service wizard opens.</p></li>

<li><p>In the Create Gateway Service dialog, select <em>VTEP L2 Gateway
Service</em> as the <strong>Gateway Service Type</strong>.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_gwsvc_create.png" alt = "/images/download/attachments/8362796/vxlan_gwsvc_create.png"


width = 500

 />
</li>

<li><p>Provide a <strong>Display Name</strong> for the service to represent the VTEP in
NSX.</p></li>

<li><p>Click <strong>Add Gateway</strong> to associate the service with the gateway you
created earlier.</p></li>

<li><p>In the <strong>Transport Node</strong> field, choose the name of the gateway you
created earlier.</p></li>

<li><p>In the <strong>Port ID</strong> field, choose the physical port on the gateway
(for example, swp10) that will connect to a logical layer 2 segment
and carry data traffic.</p></li>

<li><p>Click <strong>OK</strong> to save this gateway in the service, then click
<strong>Save</strong> to save the gateway service.</p></li>
</ol>

<p>The gateway service shows up as type <em>VTEP L2</em> in NSX.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_gwsvc.png" alt = "/images/download/attachments/8362796/vxlan_gwsvc.png"


width = 500

 />


<p>Next, configure the logical layer on NSX.</p>

<h3 id="configure-the-logical-layer">Configure the Logical Layer</h3>

<p>To complete the integration with NSX, you need to configure the logical
layer, which requires defining a logical switch (the VXLAN instance) and
all the logical ports needed.</p>

<p>To define the logical switch:</p>

<ol>
<li><p>In NSX Manager, add a new logical switch. Click the <strong>Network
Components</strong> tab, then the <strong>Logical Layer</strong> category. Under
<strong>Logical Switch</strong>, click <strong>Add</strong>. The Create Logical Switch wizard
opens.</p></li>

<li><p>In the <strong>Display Name</strong> field, enter a name for the logical switch,
then click <strong>Next</strong>.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_logswitch.png" alt = "/images/download/attachments/8362796/vxlan_logswitch.png"

height = 215


width = 500

 />
</li>

<li><p>Under <strong>Replication Mode</strong>, select <strong>Service Nodes</strong>, then click
<strong>Next</strong>.</p></li>

<li><p>Specify the transport zone bindings for the logical switch. Click
<strong>Add Binding</strong>. The Create Transport Zone Binding dialog opens.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_addbinding.png" alt = "/images/download/attachments/8362796/vxlan_addbinding.png"


width = 500

 />
</li>

<li><p>In the <strong>Transport Type</strong> list, select <em>VXLAN</em>, then click <strong>OK</strong> to
add the binding to the logical switch.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_createvni.png" alt = "/images/download/attachments/8362796/vxlan_createvni.png"


width = 500

 />
</li>

<li><p>In the <strong>VNI</strong> field, assign the switch a VNI ID, then click <strong>OK</strong>.</p>


<div class="notices note" > <pre><code>Do not use 0 or 16777215 as the VNI ID; these are reserved values
under Cumulus Linux.
</code></pre>
 </div>
</li>

<li><p>Click <strong>Save</strong> to save the logical switch configuration.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_logswitch_done.png" alt = "/images/download/attachments/8362796/vxlan_logswitch_done.png"


width = 500

 />
</li>
</ol>

<h3 id="define-logical-switch-ports">Define Logical Switch Ports</h3>

<p>Logical switch ports can be virtual machine VIF interfaces from a
registered OVS or a VTEP gateway service instance on this switch, as
defined above in the Configuring the Transport Layer. You can define a
VLAN binding for each VTEP gateway service associated with the
particular logical switch.</p>

<p>To define the logical switch ports:</p>

<ol>
<li><p>In NSX Manager, add a new logical switch port. Click the <strong>Network
Components</strong> tab, then the <strong>Logical Layer</strong> category. Under
<strong>Logical Switch Port</strong>, click <strong>Add</strong>. The Create Logical Switch
Port wizard opens.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_loglayer.png" alt = "/images/download/attachments/8362796/vxlan_loglayer.png"


width = 500

 />
</li>

<li><p>In the <strong>Logical Switch UUID</strong> list, select the logical switch you
created above, then click <strong>Create</strong>.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_logswp_create.png" alt = "/images/download/attachments/8362796/vxlan_logswp_create.png"


width = 500

 />
</li>

<li><p>In the <strong>Display Name</strong> field, provide a name for the port that
indicates it is the port that connects the gateway, then click
<strong>Next</strong>.</p></li>

<li><p>In the <strong>Attachment Type</strong> list, select <em>VTEP L2 Gateway</em>.</p></li>

<li><p>In the <strong>VTEP L2 Gateway Service UUID</strong> list, choose the name of the
gateway service you created earlier.</p></li>

<li><p>In the <strong>VLAN</strong> list, you can choose a VLAN if you want to connect
only traffic on a specific VLAN of the physical network. Leave it
blank to handle all traffic.</p></li>

<li><p>Click <strong>Save</strong> to save the logical switch port. Connectivity is
established. Repeat this procedure for each logical switch port you
want to define.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/8362796/vxlan_logswp_done.png" alt = "/images/download/attachments/8362796/vxlan_logswp_done.png"


width = 500

 />
</li>
</ol>

<h2 id="verify-the-vxlan-configuration">Verify the VXLAN Configuration</h2>

<p>After configuration is complete, verify the VXLAN configuration in a
terminal connected to the switch using these Cumulus Linux commands:</p>

<pre><code>                   
cumulus@switch1:~$ sudo ip –d link show vxln100
71: vxln100:  mtu 1500 qdisc noqueue master br-vxln100 state UNKNOWN mode DEFAULT
    link/ether d2:ca:78:bb:7c:9b brd ff:ff:ff:ff:ff:ff
    vxlan id 100 local 172.16.20.157 port 32768 61000 nolearning ageing 1800 svcnode 172.16.21.125
   
    
</code></pre>

<p>or</p>

<pre><code>                   
cumulus@switch1:~$ sudo bridge fdb show
52:54:00:ae:2a:e0 dev vxln100 dst 172.16.21.150 self permanent
d2:ca:78:bb:7c:9b dev vxln100 permanent
90:e2:ba:3f:ce:34 dev swp2s1.100
90:e2:ba:3f:ce:35 dev swp2s0.100
44:38:39:00:48:0e dev swp2s1.100 permanent
44:38:39:00:48:0d dev swp2s0.100 permanent
   
    
</code></pre>

<p>Use the <code>ovsdb-client dump</code> command to troubleshoot issues on the
switch. This command verifies that the controller and switch handshake
is successful (and works only for VXLANs integrated with NSX):</p>

<pre><code>                   
cumulus@switch:~$ sudo ovsdb-client dump -f list | grep -A 7 &quot;Manager&quot;
Manager table
_uuid               : 505f32af-9acb-4182-a315-022e405aa479
inactivity_probe    : 30000
is_connected        : true
max_backoff         : []
other_config        : {}
status              : {sec_since_connect=&quot;18223&quot;, sec_since_disconnect=&quot;18225&quot;, state=ACTIVE}
target              : &quot;ssl:192.168.100.17:6632&quot;
   
    
</code></pre>
</article>



    </div>
    

      


  

    <aside class="book-toc fixed">

  

  <button> </button>

      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#configure-the-switch-for-nsx-mh-integration">Configure the Switch for NSX-MH Integration</a>
<ul>
<li><a href="#start-the-openvswitch-vtep-service">Start the openvswitch-vtep Service</a></li>
<li><a href="#configure-the-nsx-mh-integration-using-the-configuration-script">Configure the NSX-MH Integration Using the Configuration Script</a></li>
<li><a href="#configure-the-nsx-mh-integration-manually">Configure the NSX-MH Integration Manually</a>
<ul>
<li><a href="#generate-the-credentials-certificate">Generate the Credentials Certificate</a></li>
<li><a href="#enable-ovs-vtepd-to-use-the-vlan-aware-bridge">Enable ovs-vtepd to Use the VLAN-aware Bridge</a></li>
</ul></li>
</ul></li>
<li><a href="#provision-vmware-nsx-v">Provision VMware NSX-V</a>
<ul>
<li><a href="#configure-the-switch-as-a-vtep-gateway">Configure the Switch as a VTEP Gateway</a></li>
</ul></li>
<li><a href="#configure-the-transport-and-logical-layers">Configure the Transport and Logical Layers</a>
<ul>
<li><a href="#configure-the-transport-layer">Configure the Transport Layer</a></li>
<li><a href="#configure-the-logical-layer">Configure the Logical Layer</a></li>
<li><a href="#define-logical-switch-ports">Define Logical Switch Ports</a></li>
</ul></li>
<li><a href="#verify-the-vxlan-configuration">Verify the VXLAN Configuration</a></li>
</ul></li>
</ul>
</nav>

      
      <button>
      <a href="https://github.com/cawleyflower/testDocs/edit/dev/content/Cumulus_Linux/Network_Virtualization/Virtualization_Integrations/Integrating_Hardware_VTEPs_with_VMware_NSX-MH.md" target="_blank" rel="noopener">
        <img src="/svg/pencil-circle.svg" alt="Edit" /> Edit this page
      </a>
    </button>
    


    

</aside>





  </main>
  <footer class="footer-top">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="footer-content">
            <div class="mb-4">
                <img src="https://static.cumulusnetworks.com/static/images/shared/cumulus-networks-rt-white-trademarked.ff839f1b2570.svg">
                <p>© <script type="text/javascript">document.write(new Date().getFullYear());</script> Cumulus Networks.<br>
                Site by <a href="//unomena.com/" target="_blank">Unomena</a>.</p>
            </div>
            <ul class="mb-4">
              <li><h4>Products</h4></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-linux/">Cumulus Linux</a></li>
              <li><a href="//cumulusnetworks.com/products/netq/">Cumulus NetQ</a></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-express/">Cumulus Express</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>Learn</h4></li>
              <li><a href="//cumulusnetworks.com/learn/web-scale-networking-education/">Going web-scale</a></li>
              <li><a href="//cumulusnetworks.com/learn/events/">Events</a></li>
              <li><a href="//cumulusnetworks.com/blog/">Blog</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>About</h4></li>
              <li><a href="//cumulusnetworks.com/about/">Our story</a></li>
              <li><a href="//cumulusnetworks.com/about/careers/">Careers</a></li>
              <li><a href="//cumulusnetworks.com/about/media-coverage/">Media coverage</a></li>
              <li><a href="//docs.cumulusnetworks.com/" target="_blank">Tech docs</a></li>
              <li><a href="//cumulusnetworks.com/community/">Community</a></li>
            </ul>
            <ul>
              <li>
                <a href="//twitter.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M23 6.628l-2-.5 1-2-2.464.7A4.48 4.48 0 0 0 12 8.128v1c-3.539.73-6.634-1.2-9.5-4.5q-.75 4 1.5 6l-3-.5c.405 2.069 1.362 3.7 4 4l-2.5 1c1 2 2.566 2.31 5 2.5a10.748 10.748 0 0 1-6.5 2c12.755 5.669 20-2.664 20-10V8.3z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.facebook.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M17.768 7.5H13.5V5.6a.972.972 0 0 1 1.012-1.1c.418 0 2.988.01 2.988.01V.5h-4.329C9.244.5 8.5 3.474 8.5 5.355V7.5h-3v4h3v12h5v-12h3.851z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//linkedin.com/company/cumulus-networks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M6.5 22.5h-5v-13h5zm9-9a2 2 0 0 0-2 2v7h-5v-13h5v1.485a6.307 6.307 0 0 1 3.99-1.495c2.962 0 5.01 2.2 5.01 6.355V22.5h-5v-7a2 2 0 0 0-2-2zM6.5 5A2.5 2.5 0 1 1 4 2.5 2.5 2.5 0 0 1 6.5 5z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//vimeo.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M.5 7.393l.933 1.224S3.36 7.1 4 7.859s3.1 9.925 3.915 11.617c.714 1.483 2.684 3.444 4.845 2.042s9.34-7.529 10.626-14.769-8.642-5.723-9.693.583c2.627-1.577 4.03.642 2.686 3.154s-2.569 4.145-3.211 4.145-1.135-1.679-1.868-4.613c-.76-3.035-.755-8.5-3.911-7.882C4.412 2.721.5 7.393.5 7.393z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.github.com/cumulusnetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <path class="a" d="M19.459 17c0-5.969-4.126-3.532-7.5-3.532s-7.5-2.375-7.5 3.532a3.5 3.5 0 0 0 3.5 3.5h8a3.5 3.5 0 0 0 3.5-3.5z"></path>
                    <path class="a" d="M21.489 10.214l.032.023s2.646-4.572-.6-7.237c-2 0-5.058 3.3-5.058 3.3l.022.016A14.152 14.152 0 0 0 8.1 6.3C8.083 6.285 5.037 3 3.042 3c-3.173 2.6-.729 7.012-.614 7.217a8.876 8.876 0 0 0-1.395 5.743c.241 3.126 2.847 6.54 5.982 6.54H16.9c3.135 0 5.742-3.414 5.982-6.54a8.857 8.857 0 0 0-1.393-5.746z"></path>
                    <ellipse class="a" cx="15.48" cy="17" rx="1" ry="1.5"></ellipse>
                    <ellipse class="a" cx="8.48" cy="17" rx="1" ry="1.5"></ellipse>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//slack.cumulusnetworks.com/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <rect class="a" x=".5" y=".5" width="23" height="23" rx="6" ry="6"></rect>
                    <circle class="a" cx="12" cy="12" r="6"></circle>
                    <circle class="a" cx="19" cy="5" r="1.5"></circle>
                  </svg>
                </a>
              </li>
              <li>
                <p>Cumulus Networks<sup>®</sup> — Data center networking software for the open, modern data center.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <div class="footer-bottom">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <ul>
                      <li><a href="//cumulusnetworks.com/legal/trademarks/">Trademarks</a></li>
                      <li><a href="//cumulusnetworks.com/legal/privacy/">Privacy</a></li>
                      <li><a href="//cumulusnetworks.com/legal/">Terms of service</a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

  
  

</body>

</html>
