<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Upgrading Cumulus Linux | Cumulus Networks Documentation</title>

  
  <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">

  
  
  
  <link rel="stylesheet" href="/docs.cumulusnetworks.com/book.min.a378d8a2da6f5357a83a43dff33d6f77fb70401e0399d5ba78faf81d7a1ae1a8.css">

  
  <link rel="icon" href="/docs.cumulusnetworks.com/icons/favicon.png" type="image/x-icon">

  
  <!--
  Made with Book Theme
  https://github.com/alex-shpak/hugo-book
  -->

  
  
  <script src = "/docs.cumulusnetworks.com/js/codecopy.js"> </script>

</head>


<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  
  <header id="site-nav">
    <div class="header-wrapper flex">
      <a href="/">
        <img src="/header-logo.png" alt="Cumulus Networks">
        <img src="/cumulus-networks-rt-white.svg" alt="Cumulus Networks" class="header-mobile">
        <span>Docs</span>
      </a>
      <ul class="flex">
        <li><a href="//cumulusnetworks.com">HOME</a></li>
        <li><a href="//support.cumulusnetworks.com/">SUPPORT</a></li>
        <li><a href="//docs.cumulusnetworks.com/">DOCS</a></li>
        <li><a href="//education.cumulusnetworks.com">EDUCATION</a></li>
        <li><a href="//cumulusnetworks.com/blog/">BLOG</a></li>
        <li><a href="//forums.cumulusnetworks.com/">FORUMS</a></li>
      </ul>
      <div class="burger-menu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  <div id="product-nav" class="flex">
      
    
    <ul>
    
      <li class = "active" ><a href = docs.cumulusnetworks.com/cumulus-linux/ >
        Cumulus Linux </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-netq/ >
        Cumulus NetQ </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-vx/ >
        Cumulus VX </a> </li>
    
      <li>
        <div id="products-dropdown" class="dropdown">
            <button class="btn" type="button" id="dropdownMenuButton">
              Products
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="">Cumulus RMP</a>
              <a class="dropdown-item" href="">Cumulus Chassis</a>
              <a class="dropdown-item" href="">Cumulus Host Pack</a>
            </div>
        </div>
      </li>
    </ul>
    <div class="search-container">
      <div id="doc-search-box">
        <input type="text" class="doc-search-input" placeholder="Search" value="">
        <span><button type="submit"><img src="/icons/search_20x20.svg" alt=""></button></span>
      </div>
      <div id="dropdown" class="dropdown">
          <button class="btn" type="button" id="dropdownMenuButton">
            v2.5.12
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/cumulus-linux/"> v3.7.7</a>
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-25esr/"> v2.5.12</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-30/"> v3.0.1</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-31/"> v3.1.2</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-321/"> v3.2.1</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-330/"> v3.3.0</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-332/"> v3.3.2</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-343/"> v3.4.3</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-35/"> v3.5</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-linux-36/"> v3.6</a>
            
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
          </div>
      </div>
    </div>
  </div>
  <main class="flex container">
    <aside class="book-menu fixed">

      <nav role="navigation">
        <h2 class="book-brand">
          <a href="docs.cumulusnetworks.com">Cumulus Networks Documentation</a>
        </h2>
        
        




  <ul class = "cn-book-section-container" id = "top">
    
        
          
            

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/" >
    Cumulus Linux User Guide
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/" >
    Installation, Upgrading and Package Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/Managing-Cumulus-Linux-Disk-Images/" >
    Managing Cumulus Linux Disk Images
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/Managing-Cumulus-Linux-Disk-Images/Installing-a-New-Cumulus-Linux-Image/" >
    Installing a New Cumulus Linux Image
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/Managing-Cumulus-Linux-Disk-Images/Upgrading-Cumulus-Linux/"  class="active" >
    Upgrading Cumulus Linux
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/Adding-and-Updating-Packages/" >
    Adding and Updating Packages
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Installation-Upgrading-and-Package-Management/Zero-Touch-Provisioning-ZTP/" >
    Zero Touch Provisioning - ZTP
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/" >
    System Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/" >
    Authentication, Authorization, and Accounting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/SSH-for-Remote-Access/" >
    SSH for Remote Access
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/User-Accounts/" >
    User Accounts
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/Using-sudo-to-Delegate-Privileges/" >
    Using sudo to Delegate Privileges
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/LDAP-Authentication-and-Authorization/" >
    LDAP Authentication and Authorization
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Setting-Date-and-Time/" >
    Setting Date and Time
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Netfilter-ACLs/" >
    Netfilter - ACLs
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Configuring-switchd/" >
    Configuring switchd
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Power-over-Ethernet-PoE/" >
    Power over Ethernet - PoE
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/System-Management/Configuring-a-Global-Proxy/" >
    Configuring a Global Proxy
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Configuring-and-Managing-Network-Interfaces/" >
    Configuring and Managing Network Interfaces
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Configuring-and-Managing-Network-Interfaces/Layer-1-and-Switch-Port-Attributes/" >
    Layer 1 and Switch Port Attributes
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Configuring-and-Managing-Network-Interfaces/Buffer-and-Queue-Management/" >
    Buffer and Queue Management
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/" >
    Layer 1 and Layer 2 Features
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/" >
    Ethernet Bridging - VLANs
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/VLAN-Tagging/" >
    VLAN Tagging
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/VLAN-aware-Bridge-Mode-for-Large-scale-Layer-2-Environments/" >
    VLAN-aware Bridge Mode for Large-scale Layer 2 Environments
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/" >
    Network Virtualization
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Lightweight-Network-Virtualization-LNV/" >
    Lightweight Network Virtualization - LNV
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Lightweight-Network-Virtualization-LNV/LNV-VXLAN-Active-Active-Mode/" >
    LNV VXLAN Active-Active Mode
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Lightweight-Network-Virtualization-LNV/LNV-Full-Example/" >
    LNV Full Example
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Integrating-with-VMware-NSX/" >
    Integrating with VMware NSX
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Integrating-Hardware-VTEPs-with-Midokura-MidoNet-and-OpenStack/" >
    Integrating Hardware VTEPs with Midokura MidoNet and OpenStack
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Network-Virtualization/Static-MAC-Bindings-with-VXLAN/" >
    Static MAC Bindings with VXLAN
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Spanning-Tree-and-Rapid-Spanning-Tree/" >
    Spanning Tree and Rapid Spanning Tree
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Link-Layer-Discovery-Protocol/" >
    Link Layer Discovery Protocol
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Prescriptive-Topology-Manager-PTM/" >
    Prescriptive Topology Manager - PTM
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Bonding-Link-Aggregation/" >
    Bonding - Link Aggregation
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Multi-Chassis-Link-Aggregation-MLAG/" >
    Multi-Chassis Link Aggregation - MLAG
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/LACP-Bypass/" >
    LACP Bypass
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Virtual-Router-Redundancy-VRR/" >
    Virtual Router Redundancy - VRR
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/IGMP-and-MLD-Snooping/" >
    IGMP and MLD Snooping
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/" >
    Layer 3 Features
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Routing/" >
    Routing
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Introduction-to-Routing-Protocols/" >
    Introduction to Routing Protocols
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Network-Topology/" >
    Network Topology
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Quagga-Overview/" >
    Quagga Overview
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Configuring-Quagga/" >
    Configuring Quagga
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Open-Shortest-Path-First-OSPF-Protocol/" >
    Open Shortest Path First - OSPF - Protocol
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Open-Shortest-Path-First-v3-OSPFv3-Protocol/" >
    Open Shortest Path First v3 - OSPFv3 - Protocol
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Configuring-Border-Gateway-Protocol-BGP/" >
    Configuring Border Gateway Protocol - BGP
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Bidirectional-Forwarding-Detection-BFD/" >
    Bidirectional Forwarding Detection - BFD
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Equal-Cost-Multipath-Load-Sharing-Hardware-ECMP/" >
    Equal Cost Multipath Load Sharing - Hardware ECMP
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Layer-3-Features/Management-VRF/" >
    Management VRF
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/" >
    Monitoring and Troubleshooting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/" >
    Understanding and Decoding the cl-support Output File
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-Log-Files/" >
    Troubleshooting Log Files
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-the-etc-Directory/" >
    Troubleshooting the etc Directory
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-the-support-Directory/" >
    Troubleshooting the support Directory
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Single-User-Mode-Boot-Recovery/" >
    Single User Mode - Boot Recovery
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Using-netshow-to-Troubleshoot-Your-Network-Configuration/" >
    Using netshow to Troubleshoot Your Network Configuration
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Monitoring-Interfaces-and-Transceivers-Using-ethtool/" >
    Monitoring Interfaces and Transceivers Using ethtool
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Resource-Diagnostics-Using-cl-resource-query/" >
    Resource Diagnostics Using cl-resource-query
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Monitoring-System-Hardware/" >
    Monitoring System Hardware
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Monitoring-System-Statistics-and-Network-Traffic-with-sFlow/" >
    Monitoring System Statistics and Network Traffic with sFlow
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Monitoring-Virtual-Device-Counters/" >
    Monitoring Virtual Device Counters
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Managing-Application-Daemons/" >
    Managing Application Daemons
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Troubleshooting-Network-Interfaces/" >
    Troubleshooting Network Interfaces
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/Network-Troubleshooting/" >
    Network Troubleshooting
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Monitoring-and-Troubleshooting/SNMP-Monitoring/" >
    SNMP Monitoring
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Network-Solutions/" >
    Network Solutions
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Network-Solutions/Data-Center-Host-to-ToR-Architecture/" >
    Data Center Host to ToR Architecture
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Network-Solutions/Cumulus-Networks-Services-Demos/" >
    Cumulus Networks Services Demos
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Quick-Start-Guide/" >
    Quick Start Guide
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-linux-25esr/Cumulus-Linux-Index/" >
    Cumulus Linux Index
  </a>


    </li>
    
  </ul>


  </li>


          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
    
  </ul>









      </nav>

      
      
      
      

      <script src = "/docs.cumulusnetworks.com/js/menuBundle.js"> </script>


    </aside>

    <div class="book-page">

      
      <header class="align-center justify-between book-header">
        <label for="menu-control">
          <img src="/docs.cumulusnetworks.com/svg/menu.svg" alt="Menu" />
        </label>
        <strong>Upgrading Cumulus Linux</strong>
      </header>

      
      
<div class= "notices info" id = "info" >
    This documentation is for an older version of the software. If you are using the current version of Cumulus Linux, this content may not be up to date. The current version of the documentation is available [here](https://docs.cumulusnetworks.com/).
  </div>
<article class="markdown">
<h1>Upgrading Cumulus Linux</h1>

<p><details></p>

<p>Cumulus Networks software melds the Linux host world with the networking
devices world. Each world comes with its own paradigm on how to upgrade
software. Before we discuss the various ways to upgrade Cumulus Linux
switches, let&rsquo;s review the general considerations and strategies used to
upgrade network devices and Linux hosts.</p>

<h2 id="span-upgrades-comparing-the-network-device-worldview-vs-the-linux-host-worldview-span"><span>Upgrades: Comparing the Network Device Worldview vs. the Linux Host Worldview</span></h2>

<h3 id="span-manual-vs-automated-configuration-span"><span>Manual vs. Automated Configuration</span></h3>

<p>Historically, <em>network devices</em> were configured in place, and most
network devices required customized configurations, which led
predominantly to configuring the hardware manually. A lack of
standardization between vendors, device types, and device roles hampered
the development of APIs and automation tools. However, in the case of
very large data centers, configurations became uniform and repeatable,
and therefore scriptable. Some larger enterprises had to develop their
own custom scripts to roll out data center network configurations.
Virtually no industry-standard provisioning tools existed.</p>

<p>In contrast to data center network devices, <em>Linux hosts</em> in the data
center number in the thousands and tend to have similar configurations.
This increased scale led Linux sysadmins long ago to move to common
tools to automate installation and configuration, since manually
installing and configuring hosts did not work at the scale of a data
center. Nearly all tasks are done via commonly available provisioning
and orchestration tools.</p>

<h3 id="span-locations-of-configuration-data-vs-executables-span"><span>Locations of Configuration Data vs. Executables</span></h3>

<p><em>Network devices</em> generally separate configuration data from the
executable code. On bootup, the executable code looks into a different
file system and retrieves the configuration file or files, parses the
text and uses that data to configure the software options for each
software subsystem. The model is very centralized, with the executables
generally being packaged together, and the configuration data following
a set of rules that can be read by a centralized parser. Each vendor
controls the configuration format for the entire box, since each vendor
generally supports only their own software. This made sense since the
platform was designed as an application-specific appliance.</p>

<p>Since a <em>Linux host</em> is a general purpose platform, with applications
running on top of it, the locations of the files are much more
distributed. Applications install and read their configuration data from
text files usually stored in the /etc directory tree. Executables are
generally stored in one of several <em>bin</em> directories, but the bin and
etc directories are often on the same physical device. Since each
<em>module</em> (application or executable) was often developed by a different
organization and shared with the world, each module was responsible for
its own configuration data format. Most applications are community
supported, and while there are some generally accepted guiding
principles on how their configuration data is formatted, no central
authority exists to control or ensure compliance.</p>

<h3 id="span-pre-deployment-testing-of-production-environments-span"><span>Pre-deployment Testing of Production Environments</span></h3>

<p>Historically, the cost of <em>network device</em> testing has been hampered by
the cost of a single device. Setting up an appropriately sized lab
topology can be very expensive. As a result, it is difficult to do
comprehensive topology-based testing of a release before deploying it.
Thus, many network admins cannot or will not do comprehensive system
testing of a new release before deploying it.</p>

<p>Alternatively, the cost of a <em>Linux host</em> is cheap (or nearly free when
using virtualization), so rigorous testing of a release before deploying
it is not encumbered by budgeting concerns. Most sysadmins extensively
test new releases in the complete application environment.</p>

<h3 id="span-upgrade-procedure-span"><span>Upgrade Procedure</span></h3>

<p>Both network admins and sysadmins generally plan upgrades only to gain
new functionality or to get bug fixes when the workarounds become too
onerous. The goal is to reduce the number of upgrades as much as
possible.</p>

<p>The <em>network device</em> upgrade paradigm is to leave the configuration data
in place, and <em>replace the executable files</em> either all at once from a
single binary image or in large chunks (subsystems). A full release
upgrade comes with risk due to unexpected behavior changes in subsystems
where the admin did not anticipate or need changes.</p>

<p>The <em>Linux host</em> upgrade paradigm is to independently <em>upgrade a small
list of packages</em> while leaving most of the OS untouched. Changing a
small list of packages reduces the risk of unintended consequences.
Usually upgrades are a &ldquo;forward only&rdquo; paradigm, where the sysadmins
generally plan to move to the latest code within the same major release
when needed. Every few years, when a new kernel train is released, a
major upgrade is planned. A major upgrade involves wiping and replacing
the entire OS and migrating configuration data.</p>

<h3 id="span-rollback-procedure-span"><span>Rollback Procedure</span></h3>

<p>Even the most well planned and tested upgrades can result in unforeseen
problems, and sometimes the best solution to new problems is to roll
back to the previous state.</p>

<p>Since *network device*s clearly separate data and executables, generally
the process is to <em>overwrite the new release executable</em> with the
previously running executable. If the configuration was changed by the
newer release, then you either have to manually back out or repair the
changes, or restore from an already backed up configuration.</p>

<p>The <em>Linux host</em> scenario can be more complicated. There are three main
approaches:</p>

<ul>
<li><p>Back out individual packages: If the problematic package is
identified, the sysadmin can downgrade the affected package
directly. In rare cases the configuration files may have to be
restored from backup, or edited to back out any changes that were
automatically made by the upgrade package.</p></li>

<li><p>Flatten and rebuild: If the OS becomes unusable, you can use
orchestration tools to reinstall the previous OS release from
scratch and then automatically rebuild the configuration.</p></li>

<li><p>Backup and restore: Another common strategy is to restore to a
previous state via a backup captured before the upgrade.</p></li>
</ul>

<h3 id="span-third-party-packages-span"><span>Third Party Packages</span></h3>

<p>Third party packages are rare in the <em>network device</em> world. Because the
network OS is usually proprietary, third party packages are usually
packaged by the network device vendor and upgrades of those packages is
handled by the network device upgrade system.</p>

<p>Third party packages in <em>Linux host</em> world often use the same package
system as the distribution into which it is to be installed (for
example, Debian uses <code>apt-get</code>). Or the package may be compiled and
installed by the sysadmin. Configuration and executable files generally
follow the same filesystem hierarchy standards as other applications.</p>

<h2 id="span-upgrading-cumulus-linux-devices-strategies-and-processes-span"><span>Upgrading Cumulus Linux Devices: Strategies and Processes</span></h2>

<p>Because Cumulus Linux is both Linux <em>and</em> a network device, it has
characteristics of both paradigms. The following describes the Cumulus
Linux paradigm with respect to upgrade planning and execution.</p>

<h3 id="span-automated-configuration-is-preferred-over-manual-configuration-span"><span>Automated Configuration Is Preferred over Manual Configuration</span></h3>

<p>Because Cumulus Linux <em>is</em> Linux, Cumulus Networks recommends that even
with small networks or test labs, network admins should make the jump to
deploy, provision, configure, and upgrade switches using automation from
the very beginning. The small up front investment of time spent learning
an orchestration tool, even to provision a small number of Cumulus Linux
devices, will pay back dividends for a long time. The biggest gain is
realized during the upgrade process, where the network admin can quickly
upgrade dozens of devices in a repeatable manner.</p>

<p>Switches, like servers, should be treated like <em><a href="https://www.google.com/search?q=cattle+not+pets" target="_blank">cattle, not
pets</a>.</em></p>

<h3 id="span-out-of-band-management-is-worth-the-investment-span"><span>Out-of-Band Management Is Worth the Investment</span></h3>

<p>Because network devices are reachable via the IP addresses on the front
panel ports, many network admins of small-to-medium sized networks use
<em>in-band</em> networks to manage their switches. In this design, management
traffic like SSH, SNMP, and console server connections use the same
networks that regular network traffic traverses — there is no separation
between the <em>management plane</em> and the <em>data plane</em>. Larger data centers
create a separate <em>out-of-band</em> network with a completely separate
subnet and reachability path to attach to the management ports — that is
accessible via eth0 and the serial console.</p>

<p>This is a situation where smaller companies should learn from the big
companies. A separate management network isn&rsquo;t free, but it is
relatively cheap. With an inexpensive <a href="https://cumulusnetworks.com/rmp" target="_blank">Cumulus
RMP</a> management switch, an inexpensive
console server, and a separate cable path, up to 48 devices can be
completely controlled via the out-of-band network in the case of a
network emergency.</p>

<p>There are many scenarios where in-band networking can fail and leave the
network admin waiting for someone to drive to the data center or remote
site to connect directly to the console of a misconfigured or failing
device. The cost of one outage would usually more than pay for the
investment in a separate network. For even more security, attach
remote-controllable power distribution units (PDUs) in each rack to the
management network, so you can have complete control to remote power
cycle every device in that rack.</p>

<h3 id="span-pre-deployment-testing-of-new-releases-is-advised-and-enabled-span"><span>Pre-Deployment Testing of New Releases Is Advised and Enabled </span></h3>

<p>White box switches and virtualization (Cumulus VX) brings the cost of
networking devices down, so network admins&rsquo; testing of their own
procedures, configurations, applications, and network topology in an
appropriately-sized lab topology becomes extremely affordable.</p>

<h3 id="span-understanding-the-locations-of-configuration-data-for-management-migration-and-backup-span"><span>Understanding the Locations of Configuration Data for Management, Migration, and Backup</span></h3>

<p>As with other Linux distributions, the <code>/etc</code> directory is the primary
location for all configuration data in Cumulus Linux. You can use the
<a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config File Migration
script</a>
to identify, archive and migrate configuration files that have changed
since the image was installed.</p>

<p>The table below lists the most likely and recommended files to back up
and migrate to a new release, but any file that has been changed would
need to be examined:</p>

<h4 id="span-network-configuration-files-span"><span>Network Configuration Files</span></h4>

<table>
<thead>
<tr>
<th>File Name and Location</th>
<th>Explanation</th>
<th>Cumulus Linux Documentation</th>
<th>Debian Documentation</th>
</tr>
</thead>

<tbody>
<tr>
<td>/etc/network/</td>
<td>Network configuration files, most notably <code>/etc/network/interfaces</code> and <code>/etc/network/interfaces.d/</code></td>
<td><a href="/version/cumulus-linux-25esr/Configuring-and-Managing-Network-Interfaces/">Configuring and Managing Network Interfaces</a></td>
<td><a href="https://wiki.debian.org/NetworkConfiguration" target="_blank">wiki.debian.org/NetworkConfiguration</a></td>
</tr>

<tr>
<td>/etc/resolv.conf</td>
<td>DNS resolution</td>
<td>Not unique to Cumulus Linux: <a href="https://wiki.debian.org/NetworkConfiguration#The_resolv.conf_configuration_file" target="_blank">wiki.debian.org/NetworkConfiguration#The_resolv.conf_configuration_file</a></td>
<td><a href="https://www.debian.org/doc/manuals/debian-reference/ch05.en.html" target="_blank">www.debian.org/doc/manuals/debian-reference/ch05.en.html</a></td>
</tr>

<tr>
<td>/etc/quagga/</td>
<td>Routing application (responsible for BGP and OSPF)</td>
<td><a href="/version/cumulus-linux-25esr/Layer-3-Features/Quagga-Overview">Quagga Overview</a></td>
<td><a href="https://packages.debian.org/wheezy/quagga" target="_blank">packages.debian.org/wheezy/quagga</a></td>
</tr>

<tr>
<td>/etc/hostname</td>
<td>Configuration file for the hostname of the switch</td>
<td><a href="Quick-Start-Guide.html#src-5115897_QuickStartGuide-ConfiguringtheHostnameandTimeZone" target="_blank">Quick Start Guide#ConfiguringtheHostnameandTimeZone</a></td>
<td><a href="https://wiki.debian.org/HowTo/ChangeHostname" target="_blank">wiki.debian.org/HowTo/ChangeHostname</a></td>
</tr>

<tr>
<td>/etc/cumulus/ports.conf</td>
<td>Breakout cable configuration file</td>
<td><a href="Layer-1-and-Switch-Port-Attributes.html#src-5116098_Layer1andSwitchPortAttributes-ConfiguringBreakoutPorts" target="_blank">Layer 1 and Switch Port Attributes#ConfiguringBreakoutPorts</a></td>
<td>N/A; please read the guide on breakout cables</td>
</tr>

<tr>
<td>/etc/cumulus/switchd.conf</td>
<td>Switchd configuration</td>
<td><a href="/version/cumulus-linux-25esr/System-Management/Configuring-switchd">Configuring switchd</a></td>
<td>N/A; please read the guide on switchd configuration</td>
</tr>
</tbody>
</table>

<h4 id="span-additional-commonly-used-files-span"><span>Additional Commonly Used Files</span></h4>

<table>
<thead>
<tr>
<th>File Name and Location</th>
<th>Explanation</th>
<th>Cumulus Linux Documentation</th>
<th>Debian Documentation</th>
</tr>
</thead>

<tbody>
<tr>
<td>/etc/motd</td>
<td>Message of the day</td>
<td>Not unique to Cumulus Linux</td>
<td><a href="https://wiki.debian.org/motd#Wheezy" target="_blank">wiki.debian.org/motd#Wheezy</a></td>
</tr>

<tr>
<td>/etc/passwd</td>
<td>User account information</td>
<td>Not unique to Cumulus Linux</td>
<td><a href="https://www.debian.org/doc/manuals/debian-reference/ch04.en.html" target="_blank">www.debian.org/doc/manuals/debian-reference/ch04.en.html</a></td>
</tr>

<tr>
<td>/etc/shadow</td>
<td>Secure user account information</td>
<td>Not unique to Cumulus Linux</td>
<td><a href="https://www.debian.org/doc/manuals/debian-reference/ch04.en.html" target="_blank">www.debian.org/doc/manuals/debian-reference/ch04.en.html</a></td>
</tr>

<tr>
<td>/etc/group</td>
<td>Defines user groups on the switch</td>
<td>Not unique to Cumulus Linux</td>
<td><a href="https://www.debian.org/doc/manuals/debian-reference/ch04.en.html" target="_blank">www.debian.org/doc/manuals/debian-reference/ch04.en.html</a></td>
</tr>

<tr>
<td>/etc/lldpd.conf</td>
<td>Link Layer Discover Protocol (LLDP) daemon configuration</td>
<td><a href="/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Link-Layer-Discovery-Protocol">Link Layer Discovery Protocol</a></td>
<td><a href="https://packages.debian.org/wheezy/lldpd" target="_blank">packages.debian.org/wheezy/lldpd</a></td>
</tr>

<tr>
<td>/etc/lldpd.d/</td>
<td>Configuration directory for <code>lldpd</code></td>
<td><a href="/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Link-Layer-Discovery-Protocol">Link Layer Discovery Protocol</a></td>
<td><a href="https://packages.debian.org/wheezy/lldpd" target="_blank">packages.debian.org/wheezy/lldpd</a></td>
</tr>

<tr>
<td>/etc/nsswitch.conf</td>
<td>Name Service Switch (NSS) configuration file</td>
<td><a href="/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/LDAP-Authentication-and-Authorization">LDAP Authentication and Authorization</a></td>
<td><a href="https://wiki.debian.org/LDAP/NSS" target="_blank">wiki.debian.org/LDAP/NSS</a></td>
</tr>

<tr>
<td>/etc/ssh/</td>
<td>SSH configuration files</td>
<td><a href="/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/SSH-for-Remote-Access">SSH for Remote Access</a></td>
<td><a href="https://wiki.debian.org/SSH" target="_blank">wiki.debian.org/SSH</a></td>
</tr>

<tr>
<td>/etc/ldap/ldap.conf</td>
<td>Lightweight Directory Access Protocol configuration file</td>
<td><a href="/version/cumulus-linux-25esr/System-Management/Authentication-Authorization-and-Accounting/LDAP-Authentication-and-Authorization">LDAP Authentication and Authorization</a></td>
<td><a href="https://www.debian.org/doc/manuals/debian-reference/ch04.en.html" target="_blank">www.debian.org/doc/manuals/debian-reference/ch04.en.html</a></td>
</tr>
</tbody>
</table>

<ul>
<li><p>If you are using the root user account, consider including <code>/root/</code>.</p></li>

<li><p>If you have custom user accounts, consider including
<code>/home/&lt;username&gt;/</code>.</p></li>
</ul>

<h4 id="span-id-src-5116002-upgradingcumuluslinux-filestonevermigrate-class-confluence-anchor-link-span-span-files-that-should-never-be-migrated-between-versions-or-boxes-span"><span id="src-5116002_UpgradingCumulusLinux-FilesToNeverMigrate" class="confluence-anchor-link"></span><span>Files That Should Never Be Migrated Between Versions or Boxes</span></h4>

<table>
<thead>
<tr>
<th>File Name and Location</th>
<th>Explanation</th>
</tr>
</thead>

<tbody>
<tr>
<td>/etc/adjtime</td>
<td>System clock adjustment data. NTP manages this automatically. It is incorrect when the switch hardware is replaced. Do not copy.</td>
</tr>

<tr>
<td>/etc/bcm.d/</td>
<td>Per-platform hardware configuration directory, created on first boot. Do not copy.</td>
</tr>

<tr>
<td>/etc/blkid.tab</td>
<td>Partition table. It should not be modified manually. Do not copy.</td>
</tr>

<tr>
<td>/etc/blkid.tab.old</td>
<td>A previous partition table; it should not be modified manually. Do not copy.</td>
</tr>

<tr>
<td>/etc/cumulus/init</td>
<td>Platform hardware-specific files. Do not copy.</td>
</tr>

<tr>
<td>/etc/default/clagd</td>
<td>Created and managed by <code>ifupdown2</code>. Do not copy.</td>
</tr>

<tr>
<td>/etc/default/grub</td>
<td>Grub <code>init</code> table; it should not be modified manually.</td>
</tr>

<tr>
<td>/etc/default/hwclock</td>
<td>Platform hardware-specific file. Created during first boot. Do not copy.</td>
</tr>

<tr>
<td>/etc/init</td>
<td>Platform initialization files. Do not copy.</td>
</tr>

<tr>
<td>/etc/init.d/</td>
<td>Platform initialization files. Do not copy.</td>
</tr>

<tr>
<td>/etc/fstab</td>
<td>Static info on filesystem. Do not copy.</td>
</tr>

<tr>
<td>/etc/image-release</td>
<td>System version data. Do not copy.</td>
</tr>

<tr>
<td>/etc/os-release</td>
<td>System version data. Do not copy.</td>
</tr>

<tr>
<td>/etc/lsb-release</td>
<td>System version data. Do not copy.</td>
</tr>

<tr>
<td>/etc/lvm/archive</td>
<td>Filesystem files. Do not copy.</td>
</tr>

<tr>
<td>/etc/lvm/backup</td>
<td>Filesystem files. Do not copy.</td>
</tr>

<tr>
<td>/etc/modules</td>
<td>Created during first boot. Do not copy.</td>
</tr>

<tr>
<td>/etc/modules-load.d/</td>
<td>Created during first boot. Do not copy.</td>
</tr>

<tr>
<td>/etc/sensors.d</td>
<td>Platform-specific sensor data. Created during first boot. Do not copy.</td>
</tr>

<tr>
<td>/root/.ansible</td>
<td>Ansible tmp files. Do not copy.</td>
</tr>

<tr>
<td>/home/cumulus/.ansible</td>
<td>Ansible tmp files. Do not copy.</td>
</tr>
</tbody>
</table>

<h3 id="span-upgrading-switches-in-an-mlag-pair-span"><span>Upgrading Switches in an MLAG Pair</span></h3>

<p>If you have a pair of Cumulus Linux switches as part of an <a href="/version/cumulus-linux-25esr/Layer-1-and-Layer-2-Features/Multi-Chassis-Link-Aggregation---MLAG">MLAG
(multi-chassis link aggregation)
pair</a>,
you should only upgrade each switch when it is in the <em>secondary role</em>.
The upgrade path is as follows:</p>

<ol>
<li><p>Upgrade Cumulus Linux on the switch already in the secondary role.
This is the switch with the higher <code>clagd-priority</code> value.</p></li>

<li><p>Set the switch in the secondary role into the primary role by
setting its <code>clagd-priority</code> to a value lower than the
<code>clagd-priority</code> setting on the switch in the primary role.</p>

<pre><code>cumulus@switch:~$ sudo clagctl priority VALUE 
</code></pre></li>

<li><p>Upgrade the switch that just took on the secondary role.</p></li>

<li><p>Put that switch into the primary role again, if you so choose.</p>

<pre><code>cumulus@switch:~$ sudo clagctl priority VALUE
</code></pre></li>
</ol>

<p>For more information about setting the priority, see <a href="Multi-Chassis-Link-Aggregation---MLAG.html#src-5116071_Multi-ChassisLinkAggregation-MLAG-roles" target="_blank">Understanding
Switch
Roles</a>.</p>

<h2 id="span-upgrading-cumulus-linux-choosing-between-a-binary-install-vs-package-upgrade-span"><span>Upgrading Cumulus Linux: Choosing between a Binary Install vs. Package Upgrade</span></h2>

<p>Network admins have two ways to upgrade Cumulus Linux:</p>

<ul>
<li><p>Performing a binary (full image) install of the new version, running
<code>cl-img-install</code> on the switch</p></li>

<li><p>Upgrading only the changed packages, using <code>apt-get update</code> and
<code>apt-get dist-upgrade</code></p></li>
</ul>

<p>There are advantages and disadvantages to using these methods, which are
outlined below.</p>

<p><span id="src-5116002_UpgradingCumulusLinux-binary_upgrade"></span></p>

<h3 id="span-upgrading-via-binary-install-cl-img-install-span"><span>Upgrading via Binary Install (cl-img-install)</span></h3>

<p>Pros:</p>

<ul>
<li><p>Image is installed to the <a href="Managing-Cumulus-Linux-Disk-Images.html#src-5115988_ManagingCumulusLinuxDiskImages-slots" target="_blank">alternate disk image
slot</a>
while the switch remains operational.</p></li>

<li><p>The only downtime is the reboot/init process.</p></li>

<li><p>You choose the exact version that you want to upgrade to.</p></li>

<li><p>Rolling back to the previous version and config is easy and quick;
it requires only running <code>cl-img-select -s</code> and reboot.</p></li>

<li><p>This is the only method for upgrading to a new major (X.0) or minor
version (X.Y). For example, when you are upgrading from 2.5.5 to 3.0
or from 2.2.2 to 2.5.5.</p></li>
</ul>

<p>Cons:</p>

<ul>
<li><p>Configuration data must be moved to the new OS via some mechanism
before the new OS is booted, or soon afterwards via out-of-band
management.</p></li>

<li><p>Moving the configuration file can go wrong in various ways:</p>

<ul>
<li><p>Identifying all the locations of config data is not always an
easy task.</p></li>

<li><p>Config file changes in the new version may cause merge conflicts
that go undetected.</p></li>
</ul></li>
</ul>

<p>To upgrade the switch by running a binary install:</p>

<ol>
<li><p>Back up the configurations off the switch using the <a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config File
Migration
script</a>
with the <code>--backup</code> option and then copy the archive off the
switch.<br />
<strong>Optional:</strong> Use the Ansible playbook included with the <a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config
File Migration
script</a>
to automate the backup of all your Cumulus Linux 2.5 switches. See
the section below on <a href="#src-5116002_UpgradingCumulusLinux-Using_Automation_Tools">Using Automation Tools to Backup
Configurations</a>
for more details.</p></li>

<li><p><details></p>

<p>Install the binary image to the <a href="Managing-Cumulus-Linux-Disk-Images.html#src-5115988_ManagingCumulusLinuxDiskImages-slots" target="_blank">alternate
slot</a>
and select it as the new primary slot.</p>

<pre><code>cumulus@switch$ sudo cl-img-install -s &lt;image_url&gt;
</code></pre>


<div class="notices note" > <pre><code>If you don't use the `-s` flag here, you will have to run
`cl-img-select -s` after the installation to manually select the
alternate slot.
</code></pre>
 </div>


<p><summary>Click to expand full output </summary></p>

<pre><code>cumulus@switch$ sudo cl-img-install -s CumulusLinux-2.5.3a-amd64.bin
Defaulting to image slot 2 for install.
Dumping image info from CumulusLinux-2.5.3a-amd64.bin ...
Verifying image checksum ... OK.
Preparing image archive ... OK.
Control File Contents
=====================
Description: Cumulus Linux
OS-Release: 2.5.3a-3b46bef-201509041633-build
Architecture: amd64
Date: Fri, 04 Sep 2015 17:10:30 -0700
Installer-Version: 1.2
Platforms: accton_as5712_54x accton_as6712_32x mlx_sx1400_i73612 dell_s6000_s1220 dell_s4000_c2338 dell_s3000_c2338 cel_redstone_xp cel_smallstone_xp cel_pebble quanta_panther quanta_ly8_rangeley quanta_ly6_rangeley quanta_ly9_rangeley
Homepage: http://www.cumulusnetworks.com/
Data Archive Contents
=====================
-rw-r--r-- build/Development       131 2015-09-05 00:10:29 file.list
-rw-r--r-- build/Development        44 2015-09-05 00:10:29 file.list.sha1
-rw-r--r-- build/Development 140238619 2015-09-05 00:10:29 sysroot-release.tar.gz
-rw-r--r-- build/Development        44 2015-09-05 00:10:30 sysroot-release.tar.gz.sha1
-rw-r--r-- build/Development   8094220 2015-09-05 00:10:29 vmlinuz-initrd.tar.xz
-rw-r--r-- build/Development        44 2015-09-05 00:10:30 vmlinuz-initrd.tar.xz.sha1
Current image slot setup:
active =&gt; slot 1 (primary): 2.5.3-c4e83ad-201506011818-build
          slot 2 (alt    ): 2.5.2-727a0c6-201504132125-build
About to update image slot 2 using:
/home/cumulus/CumulusLinux-2.5.3a-amd64.bin
Are you sure (y/N)? y
Verifying image checksum ... OK.
Preparing image archive ... OK.
Validating sha1 for vmlinuz-initrd.tar.xz... done.
Validating sha1 for sysroot-release.tar.gz... done.
Installing OS-Release 2.5.3a-3b46bef-201509041633-build into image slot 2 ...
Info: Copying sysroot into slot 2
Creating logical volume SYSROOT2 on volume group CUMULUS... done.
Verifying sysroot copy... OK.
Copying kernel into CLBOOT partition... done.
Verifying kernel copy... OK.
Generating grub.cfg ...
Found Cumulus Linux image: /boot/cl-vmlinuz-3.2.65-1+deb7u2+cl2.5+5-slot-1
Found Cumulus Linux image: /boot/cl-vmlinuz-3.2.65-1+deb7u2+cl2.5+5-slot-2
done
Success: /home/cumulus/CumulusLinux-2.5.3a-amd64.bin loaded into image slot 2.
</code></pre>

<p></details></p></li>

<li><p><strong>Optional:</strong> Migrate the configuration files to the alternate slot
using the <a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config File Migration
script</a>
with the <code>--sync</code> option.</p></li>

<li><p>Reboot the switch.</p>

<pre><code>cumulus@switch$ sudo reboot
</code></pre></li>

<li><p>Restore the configuration files to the new version — ideally via
automation — if the files were not migrated in step 3. To manually
restore an archive created by the <a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config File Migration
script</a>:</p>

<pre><code># On the switch, copy the config file archive back from the server:
cumulus@switch$ scp user@my_external_server:PATH/SWITCHNAME-config-archive-DATE_TIME.tar.gz .
 
# Untar the archive to the root of the box
cumulus@switch$ sudo tar -C / -xvf SWITCHNAME-config-archive-DATE_TIME.tar.gz
</code></pre></li>

<li><p>Verify correct operation with the old configurations on the new
version.</p></li>

<li><p>Reinstall third party apps and associated configurations.</p></li>
</ol>

<p><span id="src-5116002_UpgradingCumulusLinux-apt_upgrade"></span></p>

<h3 id="span-upgrading-using-package-installs-apt-get-update-apt-get-dist-upgrade-span"><span>Upgrading Using Package Installs (apt-get update &amp;&amp; apt-get dist-upgrade)</span></h3>

<p>Pros:</p>

<ul>
<li><p>Configuration data stays in place while the binaries are upgraded.</p></li>

<li><p>Third-party apps stay in place.</p></li>
</ul>

<p>Cons:</p>

<ul>
<li><p>This method works only if you are upgrading to a later maintenance
release (X.Y.Z, like 2.5.5) from an earlier release in the same
major and minor release family <strong>only</strong> (like 2.5.0 to 2.5.4, or
2.5.2 to 2.5.5).</p></li>

<li><p>Rollback is quite difficult and tedious.</p></li>

<li><p>You can&rsquo;t choose the exact release version that you want to run.</p></li>

<li><p>When you upgrade, you upgrade all packages to the latest available
version.</p></li>

<li><p>The upgrade process takes a while to complete, and various switch
functions are intermittently available during the upgrade.</p></li>

<li><p>Some upgrade operations will terminate SSH sessions on the in-band
(front panel) ports, leaving the user unable to monitor the upgrade
process. As a workaround, use the <a href="https://support.cumulusnetworks.com/hc/en-us/articles/215453578" target="_blank">dtach
tool</a>.</p></li>

<li><p>Just like the binary install method, you still must reboot after the
upgrade, lengthening the downtime.</p></li>
</ul>


<div class="notices note" > <p>Before you upgrade a PowerPC switch, run <code>df -m</code> and make sure the
overlay filesystem <code>/mnt/root-rw</code> has at least 200MB of free disk space.
See <a href="https://support.cumulusnetworks.com/hc/en-us/articles/211153707-Cumulus-Linux-2-5-4-Release-Notes#rn334" target="_blank">this release
note</a>
for more details.</p>
 </div>


<p>To upgrade the switch by updating the packages:</p>

<ol>
<li><p>Back up the configurations off the switch.</p></li>

<li><p>Fetch the latest update meta-data from the repository.</p>

<pre><code>cumulus@switch$ sudo apt-get update
</code></pre></li>

<li><p>Upgrade all the packages to the latest distribution.</p>

<pre><code>cumulus@switch$ sudo apt-get dist-upgrade
</code></pre></li>

<li><p>Reboot the switch.</p>

<pre><code>cumulus@switch$ sudo reboot
</code></pre></li>

<li><p>Verify correct operation with the old configurations on new version.</p></li>
</ol>


<div class="notices warning" > <p>While this method doesn&rsquo;t overwrite the <a href="Managing-Cumulus-Linux-Disk-Images.html#src-5115988_ManagingCumulusLinuxDiskImages-slots" target="_blank">target image
slot</a>,
the disk image does occupy a lot of disk space used by both Cumulus
Linux image slots.</p>
 </div>



<div class="notices note" > <p>After you successfully upgrade Cumulus Linux, you may notice some some
results that you may or may not have expected:</p>

<ul>
<li><p><code>apt-get dist-upgrade</code> always updates the operating system to the
most current version, so if you are currently running Cumulus Linux
2.5.2 and run <code>apt-get dist-upgrade</code> on that switch, the packages
will get upgraded to the latest version.</p></li>

<li><p>When you run <code>cl-img-select</code>, the output still shows the version of
Cumulus Linux from the last binary install. So if you installed
Cumulus Linux 2.5.3 as a full image install and then upgraded to
2.5.8 using <code>apt-get dist-upgrade</code>, the output from <code>cl-img-select</code>
still shows version 2.5.3. To see the current version of Cumulus
Linux running on the switch, use <code>cat /etc/lsb-release</code>.</p></li>
</ul>
 </div>


<p><summary>Why you should use apt-get dist-upgrade instead of apt-get
upgrade (Click here to expand&hellip;) </summary></p>


<div class="notices warning" > <p>Cumulus Networks recommends you upgrade Cumulus Linux using <code>apt-get
dist-upgrade</code> instead of <code>apt-get upgrade</code>.</p>

<p>This ensures all the packages in the distribution get updated to the
current version. <code>apt-get upgrade</code> <strong>may</strong> work correctly if no packages
are held back by <code>apt</code>. A package can be held back if one or more of its
dependencies has changed, or it can occur for other reasons. For
example, if you see this message when running <code>apt-get upgrade</code>:</p>

<pre><code>&quot;The following packages have been kept back:
linux-image-powerpc&quot;
</code></pre>

<p>It means <code>apt-get upgrade</code> did not install the kernel package. However,
<code>apt-get dist-upgrade</code> would have picked it up. Most applications in
Cumulus Linux rely on the correct kernel version. If an application
doesn&rsquo;t get the kernel version it expects, It may result in a
non-functional system.</p>

<p>You can manually install a held back package by running <code>apt-get
install</code> on it:</p>

<pre><code>apt-get install linux-image-powerpc
</code></pre>

<p>If you must use <code>apt-get upgrade</code>, run it twice. For the second time,
include the <code>-s</code> or <code>--dry-run</code> option to verify that all packages were
picked up when you upgraded. Otherwise, you must manually install any
held back packages to complete the upgrade.</p>

<pre><code>apt-get upgrade --dry-run
</code></pre>
 </div>


<h2 id="span-id-src-5116002-upgradingcumuluslinux-using-automation-tools-class-confluence-anchor-link-span-span-using-automation-tools-to-back-up-configurations-span"><span id="src-5116002_UpgradingCumulusLinux-Using_Automation_Tools" class="confluence-anchor-link"></span><span>Using Automation Tools to Back Up Configurations</span></h2>

<p>Adopting the use of automation tools like Ansible, Chef or Puppet for
configuration management greatly increases the speed and accuracy of the
next major upgrade; they also enable the quick swap of failed switch
hardware. Included with the <a href="https://github.com/CumulusNetworks/config-backup-upgrade-helper" target="_blank">Config Migration
Script</a>
is an Ansible playbook that can be used to create a backup archive of
all deployed Cumulus Linux 2.5.z switch configuration files and to
retrieve them to a central server. This is a quick start on the road to
setting up automated configuration and control for your deployment. For
more details on integrating automation into your Cumulus Linux
deployment, see the <a href="https://cumulusnetworks.com/solutions/automation/" target="_blank">Automation Solutions section on
cumulusnetworks.com</a>.</p>

<h2 id="span-rolling-back-a-cumulus-linux-installation-span"><span>Rolling Back a Cumulus Linux Installation</span></h2>

<h3 id="span-rolling-back-after-using-binary-install-span"><span>Rolling Back after Using Binary Install</span></h3>

<ol>
<li><p>Select the alternate slot as the new primary slot. (The primary slot
will be booted at the next reboot)</p>

<pre><code>cumulus@switch$ sudo cl-img-select -s
</code></pre></li>

<li><p>Reboot the switch.</p>

<pre><code>cumulus@switch$ sudo reboot
</code></pre></li>
</ol>

<h3 id="span-rolling-back-after-using-package-install-span"><span>Rolling Back after Using Package Install</span></h3>

<p>Rolling back to an earlier release after upgrading the packages on the
switch follows the same procedure as described for the Linux host OS
rollback above. There are three main strategies, and all require
detailed planning and execution:</p>

<ul>
<li><p>Back out individual packages: If the problematic package is
identified, the network admin can downgrade the affected package
directly. In rare cases the configuration files may have to be
restored from backup, or edited to back out any changes that were
automatically made by the upgrade package.</p></li>

<li><p>Flatten and rebuild: If the OS becomes unusable, you can use
orchestration tools to reinstall the previous OS release from
scratch and then automatically rebuild the configuration.</p></li>

<li><p>Backup and restore: Another common strategy is to restore to a
previous state via a backup captured before the upgrade.</p></li>
</ul>

<p>Which method you employ is specific to your deployment strategy, so
providing detailed steps for each scenario is outside the scope of this
document.</p>

<h2 id="span-third-party-package-considerations-span"><span>Third Party Package Considerations</span></h2>

<p>Note that if you install any third party apps on a Cumulus Linux switch,
any configuration data will likely be installed into the /etc directory,
but it is not guaranteed. It is the responsibility of the network admin
to understand the behavior and config file information of any third
party packages installed on a Cumulus Linux switch.</p>

<p>After you upgrade the OS in the alternate image slot, you will need to
reinstall any third party packages or any Cumulus Linux add-on packages,
such as <code>cl-mgmtvrf</code>, or <code>vxsnd</code> and <code>vxrd</code>.</p>

<h2 id="span-caveats-while-upgrading-cumulus-linux-2-5-x-span"><span>Caveats while Upgrading Cumulus Linux 2.5.x</span></h2>

<ul>
<li><a href="https://support.cumulusnetworks.com/hc/en-us/articles/214459418#rn287" target="_blank">RN-287</a>:
Copying the <code>/etc/passwd</code> file to the other slot when one version is
earlier than Cumulus Linux 2.5.3 and the other version is later than
Cumulus Linux 2.5.3 causes issues with LLDP not starting and Quagga
logs not being created.</li>
</ul>

<article id="html-search-results" class="ht-content" style="display: none;">

</article>

<footer id="ht-footer">

</footer>

<p></details></p>
</article>

      <script src="https://utteranc.es/client.js"
        repo="CumulusNetworks/docs-internal"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
      </script>

    </div>
    

      


  

    <aside class="book-toc fixed">

  
    <div class="toc">
    
      <button>
      <a href="https://github.com/CumulusNetworks/docs/edit/master/content/version/cumulus-linux-25esr/Installation,-Upgrading-and-Package-Management/Managing-Cumulus-Linux-Disk-Images/Upgrading-Cumulus-Linux.md" target="_blank" rel="noopener"><img src="/docs.cumulusnetworks.com/svg/pencil-circle.svg" alt="Edit" /> Edit this page</a>
      </button>
    
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#span-upgrades-comparing-the-network-device-worldview-vs-the-linux-host-worldview-span"><span>Upgrades: Comparing the Network Device Worldview vs. the Linux Host Worldview</span></a>
<ul>
<li><a href="#span-manual-vs-automated-configuration-span"><span>Manual vs. Automated Configuration</span></a></li>
<li><a href="#span-locations-of-configuration-data-vs-executables-span"><span>Locations of Configuration Data vs. Executables</span></a></li>
<li><a href="#span-pre-deployment-testing-of-production-environments-span"><span>Pre-deployment Testing of Production Environments</span></a></li>
<li><a href="#span-upgrade-procedure-span"><span>Upgrade Procedure</span></a></li>
<li><a href="#span-rollback-procedure-span"><span>Rollback Procedure</span></a></li>
<li><a href="#span-third-party-packages-span"><span>Third Party Packages</span></a></li>
</ul></li>
<li><a href="#span-upgrading-cumulus-linux-devices-strategies-and-processes-span"><span>Upgrading Cumulus Linux Devices: Strategies and Processes</span></a>
<ul>
<li><a href="#span-automated-configuration-is-preferred-over-manual-configuration-span"><span>Automated Configuration Is Preferred over Manual Configuration</span></a></li>
<li><a href="#span-out-of-band-management-is-worth-the-investment-span"><span>Out-of-Band Management Is Worth the Investment</span></a></li>
<li><a href="#span-pre-deployment-testing-of-new-releases-is-advised-and-enabled-span"><span>Pre-Deployment Testing of New Releases Is Advised and Enabled </span></a></li>
<li><a href="#span-understanding-the-locations-of-configuration-data-for-management-migration-and-backup-span"><span>Understanding the Locations of Configuration Data for Management, Migration, and Backup</span></a>
<ul>
<li><a href="#span-network-configuration-files-span"><span>Network Configuration Files</span></a></li>
<li><a href="#span-additional-commonly-used-files-span"><span>Additional Commonly Used Files</span></a></li>
<li><a href="#span-id-src-5116002-upgradingcumuluslinux-filestonevermigrate-class-confluence-anchor-link-span-span-files-that-should-never-be-migrated-between-versions-or-boxes-span"><span id="src-5116002_UpgradingCumulusLinux-FilesToNeverMigrate" class="confluence-anchor-link"></span><span>Files That Should Never Be Migrated Between Versions or Boxes</span></a></li>
</ul></li>
<li><a href="#span-upgrading-switches-in-an-mlag-pair-span"><span>Upgrading Switches in an MLAG Pair</span></a></li>
</ul></li>
<li><a href="#span-upgrading-cumulus-linux-choosing-between-a-binary-install-vs-package-upgrade-span"><span>Upgrading Cumulus Linux: Choosing between a Binary Install vs. Package Upgrade</span></a>
<ul>
<li><a href="#span-upgrading-via-binary-install-cl-img-install-span"><span>Upgrading via Binary Install (cl-img-install)</span></a></li>
<li><a href="#span-upgrading-using-package-installs-apt-get-update-apt-get-dist-upgrade-span"><span>Upgrading Using Package Installs (apt-get update &amp;&amp; apt-get dist-upgrade)</span></a></li>
</ul></li>
<li><a href="#span-id-src-5116002-upgradingcumuluslinux-using-automation-tools-class-confluence-anchor-link-span-span-using-automation-tools-to-back-up-configurations-span"><span id="src-5116002_UpgradingCumulusLinux-Using_Automation_Tools" class="confluence-anchor-link"></span><span>Using Automation Tools to Back Up Configurations</span></a></li>
<li><a href="#span-rolling-back-a-cumulus-linux-installation-span"><span>Rolling Back a Cumulus Linux Installation</span></a>
<ul>
<li><a href="#span-rolling-back-after-using-binary-install-span"><span>Rolling Back after Using Binary Install</span></a></li>
<li><a href="#span-rolling-back-after-using-package-install-span"><span>Rolling Back after Using Package Install</span></a></li>
</ul></li>
<li><a href="#span-third-party-package-considerations-span"><span>Third Party Package Considerations</span></a></li>
<li><a href="#span-caveats-while-upgrading-cumulus-linux-2-5-x-span"><span>Caveats while Upgrading Cumulus Linux 2.5.x</span></a></li>
</ul></li>
</ul>
</nav>
    </div>
  

</aside>






  </main>
  <footer class="footer-top">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="footer-content">
            <div class="mb-4">
                <img src="https://static.cumulusnetworks.com/static/images/shared/cumulus-networks-rt-white-trademarked.ff839f1b2570.svg">
                <p>© <script type="text/javascript">document.write(new Date().getFullYear());</script> Cumulus Networks.<br>
                Site by <a href="//unomena.com/" target="_blank">Unomena</a>.</p>
            </div>
            <ul class="mb-4">
              <li><h4>Products</h4></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-linux/">Cumulus Linux</a></li>
              <li><a href="//cumulusnetworks.com/products/netq/">Cumulus NetQ</a></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-express/">Cumulus Express</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>Learn</h4></li>
              <li><a href="//cumulusnetworks.com/learn/web-scale-networking-education/">Going web-scale</a></li>
              <li><a href="//cumulusnetworks.com/learn/events/">Events</a></li>
              <li><a href="//cumulusnetworks.com/blog/">Blog</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>About</h4></li>
              <li><a href="//cumulusnetworks.com/about/">Our story</a></li>
              <li><a href="//cumulusnetworks.com/about/careers/">Careers</a></li>
              <li><a href="//cumulusnetworks.com/about/media-coverage/">Media coverage</a></li>
              <li><a href="//docs.cumulusnetworks.com/" target="_blank">Tech docs</a></li>
              <li><a href="//cumulusnetworks.com/community/">Community</a></li>
            </ul>
            <ul>
              <li>
                <a href="//twitter.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M23 6.628l-2-.5 1-2-2.464.7A4.48 4.48 0 0 0 12 8.128v1c-3.539.73-6.634-1.2-9.5-4.5q-.75 4 1.5 6l-3-.5c.405 2.069 1.362 3.7 4 4l-2.5 1c1 2 2.566 2.31 5 2.5a10.748 10.748 0 0 1-6.5 2c12.755 5.669 20-2.664 20-10V8.3z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.facebook.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M17.768 7.5H13.5V5.6a.972.972 0 0 1 1.012-1.1c.418 0 2.988.01 2.988.01V.5h-4.329C9.244.5 8.5 3.474 8.5 5.355V7.5h-3v4h3v12h5v-12h3.851z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//linkedin.com/company/cumulus-networks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M6.5 22.5h-5v-13h5zm9-9a2 2 0 0 0-2 2v7h-5v-13h5v1.485a6.307 6.307 0 0 1 3.99-1.495c2.962 0 5.01 2.2 5.01 6.355V22.5h-5v-7a2 2 0 0 0-2-2zM6.5 5A2.5 2.5 0 1 1 4 2.5 2.5 2.5 0 0 1 6.5 5z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//vimeo.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M.5 7.393l.933 1.224S3.36 7.1 4 7.859s3.1 9.925 3.915 11.617c.714 1.483 2.684 3.444 4.845 2.042s9.34-7.529 10.626-14.769-8.642-5.723-9.693.583c2.627-1.577 4.03.642 2.686 3.154s-2.569 4.145-3.211 4.145-1.135-1.679-1.868-4.613c-.76-3.035-.755-8.5-3.911-7.882C4.412 2.721.5 7.393.5 7.393z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.github.com/cumulusnetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <path class="a" d="M19.459 17c0-5.969-4.126-3.532-7.5-3.532s-7.5-2.375-7.5 3.532a3.5 3.5 0 0 0 3.5 3.5h8a3.5 3.5 0 0 0 3.5-3.5z"></path>
                    <path class="a" d="M21.489 10.214l.032.023s2.646-4.572-.6-7.237c-2 0-5.058 3.3-5.058 3.3l.022.016A14.152 14.152 0 0 0 8.1 6.3C8.083 6.285 5.037 3 3.042 3c-3.173 2.6-.729 7.012-.614 7.217a8.876 8.876 0 0 0-1.395 5.743c.241 3.126 2.847 6.54 5.982 6.54H16.9c3.135 0 5.742-3.414 5.982-6.54a8.857 8.857 0 0 0-1.393-5.746z"></path>
                    <ellipse class="a" cx="15.48" cy="17" rx="1" ry="1.5"></ellipse>
                    <ellipse class="a" cx="8.48" cy="17" rx="1" ry="1.5"></ellipse>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//slack.cumulusnetworks.com/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <rect class="a" x=".5" y=".5" width="23" height="23" rx="6" ry="6"></rect>
                    <circle class="a" cx="12" cy="12" r="6"></circle>
                    <circle class="a" cx="19" cy="5" r="1.5"></circle>
                  </svg>
                </a>
              </li>
              <li>
                <p>Cumulus Networks<sup>®</sup> — Data center networking software for the open, modern data center.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <div class="footer-bottom">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <ul>
                      <li><a href="//cumulusnetworks.com/legal/trademarks/">Trademarks</a></li>
                      <li><a href="//cumulusnetworks.com/legal/privacy/">Privacy</a></li>
                      <li><a href="//cumulusnetworks.com/legal/">Terms of service</a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

  
  

</body>

</html>
