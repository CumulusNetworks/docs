<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Proactively Monitoring the Network Fabric | Cumulus Networks Documentation</title>

  
  <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">

  
  
  
  <link rel="stylesheet" href="/docs.cumulusnetworks.com/book.min.a378d8a2da6f5357a83a43dff33d6f77fb70401e0399d5ba78faf81d7a1ae1a8.css">

  
  <link rel="icon" href="/docs.cumulusnetworks.com/icons/favicon.png" type="image/x-icon">

  
  <link rel="alternate" type="application/rss+xml" href="docs.cumulusnetworks.com/version/cumulus-netq-10/Proactively-Monitoring-the-Network-Fabric/index.xml" title="Cumulus Networks Documentation" />
  <!--
  Made with Book Theme
  https://github.com/alex-shpak/hugo-book
  -->

  
  
  <script src = "/docs.cumulusnetworks.com/js/codecopy.js"> </script>

</head>


<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  
  <header id="site-nav">
    <div class="header-wrapper flex">
      <a href="/">
        <img src="/header-logo.png" alt="Cumulus Networks">
        <img src="/cumulus-networks-rt-white.svg" alt="Cumulus Networks" class="header-mobile">
        <span>Docs</span>
      </a>
      <ul class="flex">
        <li><a href="//cumulusnetworks.com">HOME</a></li>
        <li><a href="//support.cumulusnetworks.com/">SUPPORT</a></li>
        <li><a href="//docs.cumulusnetworks.com/">DOCS</a></li>
        <li><a href="//education.cumulusnetworks.com">EDUCATION</a></li>
        <li><a href="//cumulusnetworks.com/blog/">BLOG</a></li>
        <li><a href="//forums.cumulusnetworks.com/">FORUMS</a></li>
      </ul>
      <div class="burger-menu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  <div id="product-nav" class="flex">
      
    
    <ul>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-linux/ >
        Cumulus Linux </a> </li>
    
      <li class = "active" ><a href = docs.cumulusnetworks.com/cumulus-netq/ >
        Cumulus NetQ </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-vx/ >
        Cumulus VX </a> </li>
    
      <li>
        <div id="products-dropdown" class="dropdown">
            <button class="btn" type="button" id="dropdownMenuButton">
              Products
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="">Cumulus RMP</a>
              <a class="dropdown-item" href="">Cumulus Chassis</a>
              <a class="dropdown-item" href="">Cumulus Host Pack</a>
            </div>
        </div>
      </li>
    </ul>
    <div class="search-container">
      <div id="doc-search-box">
        <input type="text" class="doc-search-input" placeholder="Search" value="">
        <span><button type="submit"><img src="/icons/search_20x20.svg" alt=""></button></span>
      </div>
      <div id="dropdown" class="dropdown">
          <button class="btn" type="button" id="dropdownMenuButton">
            v1.0.0
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/cumulus-netq/"> v2.2.0</a>
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-netq-10/"> v1.0.0</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-netq-110/"> v1.1.0</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-netq-121/"> v1.2.1</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-netq-141/"> v1.4.1</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-netq-21/"> v2.1</a>
            
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
          </div>
      </div>
    </div>
  </div>
  <main class="flex container">
    <aside class="book-menu fixed">

      <nav role="navigation">
        <h2 class="book-brand">
          <a href="docs.cumulusnetworks.com">Cumulus Networks Documentation</a>
        </h2>
        
        




  <ul class = "cn-book-section-container" id = "top">
    
        
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
            

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/" >
    Cumulus NetQ
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Proactively-Monitoring-the-Network-Fabric/"  class="active" >
    Proactively Monitoring the Network Fabric
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Proactively-Monitoring-the-Network-Fabric/MLAG-Troubleshooting-with-NetQ/" >
    MLAG Troubleshooting with NetQ
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Getting-Started-with-NetQ/" >
    Getting Started with NetQ
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Getting-to-Know-NetQ/" >
    Getting to Know NetQ
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Taking-Preventative-Steps-with-Your-Network/" >
    Taking Preventative Steps with Your Network
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Performing-Network-Diagnostics/" >
    Performing Network Diagnostics
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/NetQ-Service-Console/" >
    NetQ Service Console
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Monitoring-Linux-Hosts-with-NetQ/" >
    Monitoring Linux Hosts with NetQ
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Monitoring-Container-Environments-with-NetQ/" >
    Monitoring Container Environments with NetQ
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Configuring-the-NetQ-Virtual-Environment/" >
    Configuring the NetQ Virtual Environment
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Restoring-from-Backups-with-NetQ/" >
    Restoring from Backups with NetQ
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-netq-10/Troubleshooting-NetQ/" >
    Troubleshooting NetQ
  </a>


    </li>
    
  </ul>


  </li>


          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
    
  </ul>









      </nav>

      
      
      
      

      <script src = "/docs.cumulusnetworks.com/js/menuBundle.js"> </script>


    </aside>

    <div class="book-page">

      
      <header class="align-center justify-between book-header">
        <label for="menu-control">
          <img src="/docs.cumulusnetworks.com/svg/menu.svg" alt="Menu" />
        </label>
        <strong>Proactively Monitoring the Network Fabric</strong>
      </header>

      
      
<div class= "notices info" id = "info" >
  This documentation is for an older version of the software. If you are using the current version of Cumulus Linux, this content may not be up to date. The current version of the documentation is available [here](https://docs.cumulusnetworks.com/).
  </div>
<article class="markdown">
<h1>Proactively Monitoring the Network Fabric</h1>

<p>NetQ continually and algorithmically checks for these symptoms and sends
real-time alerts via <em>NetQ Notifier</em> to notify users that a network
state deviation has occurred. When alerted, you can determine precisely
where the fault occurred so you can remediate quickly.</p>

<h2 id="span-netq-notifier-span"><span>NetQ Notifier</span></h2>

<p>The NetQ Notifier&rsquo;s role within the NetQ suite of applications is to
deliver alerts to users through mediums such as Slack and syslog,
informing users of network events.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/6488207/netq-notifier-and-redis.png" alt = "/images/download/attachments/6488207/netq-notifier-and-redis.png"


 />


<p>Notifications can be provided for the following network events:</p>

<ul>
<li><p>BGP session failures</p></li>

<li><p>Host sensor failures</p></li>

<li><p>License failures</p></li>

<li><p>Link up/down</p></li>

<li><p>LNV failures</p></li>

<li><p>MLAG node failures</p></li>

<li><p>MTU mismatches</p></li>

<li><p>NetQ Agent failures</p></li>

<li><p>OSPF session failures</p></li>

<li><p>VLAN mismatches</p></li>

<li><p>VXLAN failures</p></li>
</ul>

<p>When a notification arrives, what should you do next? Typically, you
could run <code>netq check</code> commands; see <a href="/version/cumulus-netq-10/Performing-Network-Diagnostics">Performing Network
Diagnostics</a>
for more information. For a thorough example, read about troubleshooting
<a href="/version/cumulus-netq-10/Proactively-Monitoring-the-Network-Fabric/MLAG-Troubleshooting-with-NetQ">MLAG node
failures</a>.</p>

<h3 id="span-log-message-format-span"><span>Log Message Format</span></h3>

<p>Messages have the following structure:</p>

<pre><code>&lt;level&gt; &lt;type&gt;: &lt;message&gt;
</code></pre>

<p>For example:</p>

<pre><code>INFO: AGENTS: All nodes are up.
</code></pre>

<p>Enumerated lists are appended to the next line:</p>

<pre><code>WARNING: VLAN: 3 mismatch(es) are found. They are: server01 torbond1, server02 torbond1, server03 torbond1
</code></pre>

<h3 id="span-supported-third-party-applications-span"><span>Supported Third-party Applications</span></h3>

<p>The following applications are supported by NetQ for notifications:</p>

<ul>
<li><p>PagerDuty: NetQ Notifier sends notifications to PagerDuty as
PagerDuty events.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/6488207/netq-to-pager-duty.png" alt = "/images/download/attachments/6488207/netq-to-pager-duty.png"

height = 400


 />
</li>

<li><p>rsyslog: Using <code>rsyslog</code>, NetQ Notifier sends alerts and events to
the <code>/var/log/docker/netq/notifier_1/netq-notifier.log</code> file by
default, but notifications can also be sent to ELK/Logstash or
Splunk.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/6488207/netq-syslog.png" alt = "/images/download/attachments/6488207/netq-syslog.png"

height = 250


 />
</li>

<li><p>Slack: NetQ Notifier sends notifications to Slack as incoming
webhooks for a Slack channel you configure. For example:</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/6488207/netq-to-slack---desktop.png" alt = "/images/download/attachments/6488207/netq-to-slack---desktop.png"

height = 400


 />
</li>
</ul>

<h3 id="span-early-access-support-span"><span>Early Access Support</span></h3>

<p>Early access features include NetQ Notifier integration with:</p>

<ul>
<li><p>ELK</p></li>

<li><p>Splunk</p></li>
</ul>

<p>In addition, you can export NetQ Notifier data to the following
applications:</p>

<ul>
<li><p>ELK/Logstash</p></li>

<li><p>PagerDuty</p></li>

<li><p>Slack</p></li>

<li><p>Splunk</p></li>

<li><p>syslog</p></li>
</ul>

<p>NetQ integrates with ELK and Splunk using <code>rsyslog</code>, a standard
mechanism to capture log files in Linux. Both ELK and Splunk provide
plugins to handle <code>rsyslog</code> inputs.</p>

<p>To configure PagerDuty, Slack or <code>syslog</code>, you need to edit the NetQ
configuration file <code>/etc/netq/netq.yml</code>.</p>

<h3 id="span-exporting-to-elk-span"><span>Exporting to ELK</span></h3>

<p>To export NetQ Notifier data to ELK via Logstash, on the host running
the NetQ Telemetry Server and NetQ Notifier, configure the notifier to
send the logs to a Logstash instance. In the following example, Logstash
is on a host with the IP address 192.168.50.30, using port 51414:</p>

<pre><code># rsyslog - logstash configuration 
sed -i '/$netq_notifier_log/a if $programname == &quot;netq-notifier&quot; then @@192.168.50.30:51414' /etc/rsyslog.d\
/50-netq-notifier.conf
</code></pre>

<p>Then restart <code>rsyslog</code>:</p>

<pre><code>root@ts_host:~# systemctl restart rsyslog
</code></pre>

<p>On the server running Logstash, create a file in <code>/etc/logstash/conf.d/</code>
called <code>notifier_logstash.conf</code>, and paste in the following text, using
the IP address and port you specified earlier:</p>

<pre><code>root@ts_host:~# vi /etc/logstash/conf.d/notifier_logstash.conf
 
input {
    syslog {
        type =&gt; syslog
        port =&gt; 51414                                                                
    }
}
output {
    file {
        path =&gt; &quot;/tmp/logstash_notifier.log&quot;                                                                                  
    }
}
</code></pre>

<p>Then restart Logstash:</p>

<pre><code>root@logstash_host:~# systemctl restart logstash
</code></pre>

<p>NetQ Notifier logs now appear in <code>/tmp/logstash_notifier.log</code> on the
Logstash host.</p>

<h3 id="span-exporting-to-splunk-span"><span>Exporting to Splunk</span></h3>

<p>To export NetQ Notifier data to Splunk, on the host running the NetQ
Telemetry Server and NetQ Notifier, configure the notifier to send the
logs to Splunk. In the following example, Splunk is on a host with the
IP address 192.168.50.30, using port 51414:</p>

<pre><code># rsyslog - splunk configuration 
sed -i ‘/$netq_notifier_log/a if $programname == “netq-notifier” then @@192.168.50.30:51415’ /etc/rsyslog.d\
/50-netq-notifier.conf
</code></pre>

<p>Then restart <code>rsyslog</code>:</p>

<pre><code>root@ts_host:~# systemctl restart rsyslog
</code></pre>

<p>To configure Splunk, do the following:</p>

<ol>
<li><p>In Splunk in a browser, choose <strong>Add Data</strong> &gt; <strong>monitor</strong> &gt;
<strong>TCP</strong> &gt; <strong>Port</strong>, and set it to <em>51415</em>.</p></li>

<li><p>Click <strong>Next</strong>, then choose <strong>Source Type (syslog)</strong> &gt; <strong>Review</strong>
&gt; <strong>Done</strong>.</p></li>
</ol>

<p>NetQ Notifier messages now appear in Splunk.</p>

<h3 id="span-precisely-locating-an-issue-on-the-network-span"><span>Precisely Locating an Issue on the Network</span></h3>

<p>NetQ helps you locate exactly where you have an issue on your network.
Use <code>netq check</code> or <code>netq trace</code> to locate a fault, then run <code>netq show
changes</code> to see what could have caused it.</p>

<p>For example, checking the state of the VLANs on your network, you can
see where some nodes have mismatched VLANs with their peers:</p>

<pre><code>cumulus@leaf01:~$ netq check vlan 
Checked Nodes: 25, Checked Links: 775, Failed Nodes: 3, Failed Links: 6
Vlan and/or PVID mismatch found on following links
Node      Interface    Vlans              Peer     Peer Interface    Peer Vlans         Error
--------  -----------  -----------------  -------  ----------------  -----------------  -----------------
server01  torbond1     103-106,1000-1005  leaf02   hostbond2         101-106,1000-1005  VLAN set Mismatch
server01  torbond1     103-106,1000-1005  leaf01   hostbond2         101-106,1000-1005  VLAN set Mismatch
server02  torbond1     102-106,1000-1005  leaf02   hostbond3         101-106,1000-1005  VLAN set Mismatch
server02  torbond1     102-106,1000-1005  leaf01   hostbond3         101-106,1000-1005  VLAN set Mismatch
server03  torbond1     102-106,1000-1005  leaf04   hostbond2         101-106,1000-1005  VLAN set Mismatch
server03  torbond1     102-106,1000-1005  leaf03   hostbond2         101-106,1000-1005  VLAN set Mismatch
</code></pre>

<h2 id="span-extending-netq-with-custom-services-using-curl-span"><span>Extending NetQ with Custom Services Using curl</span></h2>

<p>You can extend NetQ to monitor parameters beyond what it monitors by
default. For example, you can create a service that runs a series of
pings to a known host or between two known hosts to ensure that
connectivity is valid. Or you can create a service that curls a URL and
sends the output to <code>/dev/null</code>. This method works with the <a href="Performing-Network-Diagnostics.html#src-6488212_PerformingNetworkDiagnostics-time_machine" target="_blank">NetQ time
machine</a>
capability regarding <code>netq show services</code>.</p>

<ol>
<li><p>As the sudo user on a node running the NetQ agent, edit the
<code>/etc/netq/config.d/netq-agent-commands.yml</code> file.</p></li>

<li><p>Create the custom service. In the example below, the new service is
called <em>web</em>. You need to specify:</p>

<ul>
<li><p>The <em>period</em> in seconds.</p></li>

<li><p>The <em>key</em> that identifies the name of the service.</p></li>

<li><p>The command will <em>run</em> always. If you do not specify <em>always</em>
here, you must enable the service manually using <code>systemctl</code>.</p></li>

<li><p>The <em>command</em> to run. In this case we are using <code>curl</code> to ping a
web server.</p></li>
</ul>

<!-- end list -->

<pre><code>cumulus@leaf01:~$ sudo vi /etc/netq/config.d/netq-agent-commands.yml 
 
user-commands:
  - service: 'misc'
    commands:
      - period: &quot;60&quot;
        key: &quot;config-interfaces&quot;
        command: &quot;/bin/cat /etc/network/interfaces&quot;
      - period: &quot;60&quot;
        key: &quot;config-ntp&quot;
        command: &quot;/bin/cat /etc/ntp.conf&quot;
  - service: &quot;zebra&quot;
    commands:
      - period: &quot;60&quot;
        key: &quot;config-quagga&quot;
        command: [&quot;/usr/bin/vtysh&quot;, &quot;-c&quot;, &quot;show running-config&quot;]
 
  - service: &quot;web&quot;
    commands:
      - period: &quot;60&quot;
        key: &quot;webping&quot;
        run: &quot;always&quot;
        command: ['/usr/bin/curl https://cumulusnetworks.com/ -o /dev/null']
</code></pre></li>

<li><p>After you save and close the file, restart the NetQ agent:</p>

<pre><code>cumulus@leaf01: netq agent restart
</code></pre></li>

<li><p>You can verify the command is running by checking the
<code>/var/run/netq-agent-running.json</code> file:</p>

<pre><code>cumulus@leaf01: sudo cat /var/run/netq-agent-running.json
cumulus@leaf01:mgmt-vrf:~$ cat /var/run/netq-agent-running.json 
{&quot;commands&quot;: [{&quot;callback&quot;: null, &quot;service&quot;: &quot;web&quot;, &quot;command&quot;: &quot;/usr/bin/curl https://cumulusnetworks.com/ -o /dev/null&quot;, &quot;period&quot;: 60, &quot;key&quot;: &quot;webping&quot;},  #this is the output
 
{&quot;service&quot;: &quot;smond&quot;, &quot;always&quot;: false, &quot;period&quot;: 30, &quot;callback&quot;: {}, &quot;command&quot;: &quot;/usr/sbin/smonctl -j&quot;, &quot;key&quot;: &quot;smonctl-json&quot;}, {&quot;service&quot;: &quot;zebra&quot;, &quot;always&quot;: false, &quot;period&quot;: 60, &quot;callback&quot;: null, &quot;command&quot;: [&quot;/usr/bin/vtysh&quot;, &quot;-c&quot;, &quot;show running-config&quot;], &quot;key&quot;: &quot;config-quagga&quot;}, {&quot;service&quot;: &quot;clagd&quot;, &quot;always&quot;: false, &quot;period&quot;: 15, &quot;callback&quot;: {}, &quot;command&quot;: &quot;/usr/bin/clagctl -j&quot;, &quot;key&quot;: &quot;clagctl-json&quot;}, {&quot;service&quot;: &quot;bgpd&quot;, &quot;always&quot;: false, &quot;period&quot;: 15, &quot;callback&quot;: {}, &quot;command&quot;: [&quot;/usr/bin/vtysh&quot;, &quot;-c&quot;, &quot;show ip bgp vrf all neighbors json&quot;], &quot;key&quot;: &quot;bgp-neighbors&quot;}, {&quot;service&quot;: &quot;misc&quot;, &quot;always&quot;: false, &quot;period&quot;: 30, &quot;callback&quot;: {}, &quot;command&quot;: &quot;/usr/sbin/switchd -lic&quot;, &quot;key&quot;: &quot;cl-license&quot;}, {&quot;service&quot;: &quot;misc&quot;, &quot;always&quot;: false, &quot;period&quot;: 60, &quot;callback&quot;: null, &quot;command&quot;: &quot;/bin/cat /etc/network/interfaces&quot;, &quot;key&quot;: &quot;config-interfaces&quot;}, {&quot;service&quot;: &quot;misc&quot;, &quot;always&quot;: false, &quot;period&quot;: 60, &quot;callback&quot;: null, &quot;command&quot;: &quot;/bin/cat /etc/ntp.conf&quot;, &quot;key&quot;: &quot;config-ntp&quot;}, {&quot;service&quot;: &quot;lldpd&quot;, &quot;always&quot;: false, &quot;period&quot;: 30, &quot;callback&quot;: {}, &quot;command&quot;: &quot;/usr/sbin/lldpctl -f json&quot;, &quot;key&quot;: &quot;lldp-neighbor-json&quot;}, {&quot;service&quot;: &quot;mstpd&quot;, &quot;always&quot;: false, &quot;period&quot;: 15, &quot;callback&quot;: {}, &quot;command&quot;: &quot;/sbin/mstpctl showall json&quot;, &quot;key&quot;: &quot;mstpctl-bridge-json&quot;}], &quot;backend&quot;: {&quot;server&quot;: &quot;192.168.0.254&quot;, &quot;vrf&quot;: &quot;mgmt&quot;, &quot;port&quot;: 6379}}
cumulus@leaf01:mgmt-vrf:~$  
</code></pre></li>

<li><p>And you can see the service is running on the host when you run netq
show services:</p>

<pre><code>cumulus@leaf01: netq show services web
</code></pre></li>
</ol>

<h2 id="span-exporting-netq-data-span"><span>Exporting NetQ Data</span></h2>

<p>Data from the NetQ Telemetry Server can be exported in a number of ways.
First, you can use the <code>json</code> option to output check and show commands
to JSON format for parsing in other applications.</p>

<p>For example, you can check the state of BGP on your network with <code>netq
check bgp</code>:</p>

<pre><code>cumulus@leaf01:~$ netq check bgp
Total Nodes: 25, Failed Nodes: 2, Total Sessions: 228 , Failed Sessions: 2, 
Node        Neighbor    Peer ID     Reason    Time
----------  ----------  ----------  --------  -------
exit01      swp6.2      spine01     Idle      15h ago
spine01     swp3.2      exit01      Idle      15h ago
</code></pre>

<p>When you show the output in JSON format, this same command looks like
this:</p>

<pre><code>cumulus@leaf01:~$ netq check bgp json 
{
    &quot;failedNodes&quot;: [
        {
            &quot;node&quot;: &quot;exit-1&quot;, 
            &quot;reason&quot;: &quot;Idle&quot;, 
            &quot;peerId&quot;: &quot;firewall-1&quot;, 
            &quot;neighbor&quot;: &quot;swp6.2&quot;, 
            &quot;time&quot;: &quot;15h ago&quot;
        }, 
        {
            &quot;node&quot;: &quot;firewall-1&quot;, 
            &quot;reason&quot;: &quot;Idle&quot;, 
            &quot;peerId&quot;: &quot;exit-1&quot;, 
            &quot;neighbor&quot;: &quot;swp3.2&quot;, 
            &quot;time&quot;: &quot;15h ago&quot;
        }
    ], 
    &quot;summary&quot;: {
        &quot;checkedNodeCount&quot;: 25, 
        &quot;failedSessionCount&quot;: 2, 
        &quot;failedNodeCount&quot;: 2, 
        &quot;totalSessionCount&quot;: 228
    }
}
</code></pre>

<article id="html-search-results" class="ht-content" style="display: none;">

</article>

<footer id="ht-footer">

</footer>

<script src="js/lunr.js"></script>

<script src="js/lunr-extras.js"></script>

<script src="assets/js/scroll-search.js"></script>
</article>

      <script src="https://utteranc.es/client.js"
        repo="CumulusNetworks/docs-internal"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
      </script>

    </div>
    

      


  

    <aside class="book-toc fixed">

  
    <div class="toc">
    
      <button>
      <a href="https://github.com/CumulusNetworks/docs/edit/master/content/version/cumulus-netq-10/Proactively-Monitoring-the-Network-Fabric/_index.md" target="_blank" rel="noopener"><img src="/docs.cumulusnetworks.com/svg/pencil-circle.svg" alt="Edit" /> Edit this page</a>
      </button>
    
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#span-netq-notifier-span"><span>NetQ Notifier</span></a>
<ul>
<li><a href="#span-log-message-format-span"><span>Log Message Format</span></a></li>
<li><a href="#span-supported-third-party-applications-span"><span>Supported Third-party Applications</span></a></li>
<li><a href="#span-early-access-support-span"><span>Early Access Support</span></a></li>
<li><a href="#span-exporting-to-elk-span"><span>Exporting to ELK</span></a></li>
<li><a href="#span-exporting-to-splunk-span"><span>Exporting to Splunk</span></a></li>
<li><a href="#span-precisely-locating-an-issue-on-the-network-span"><span>Precisely Locating an Issue on the Network</span></a></li>
</ul></li>
<li><a href="#span-extending-netq-with-custom-services-using-curl-span"><span>Extending NetQ with Custom Services Using curl</span></a></li>
<li><a href="#span-exporting-netq-data-span"><span>Exporting NetQ Data</span></a></li>
</ul></li>
</ul>
</nav>
    </div>
  

</aside>






  </main>
  <footer class="footer-top">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="footer-content">
            <div class="mb-4">
                <img src="https://static.cumulusnetworks.com/static/images/shared/cumulus-networks-rt-white-trademarked.ff839f1b2570.svg">
                <p>© <script type="text/javascript">document.write(new Date().getFullYear());</script> Cumulus Networks.<br>
                Site by <a href="//unomena.com/" target="_blank">Unomena</a>.</p>
            </div>
            <ul class="mb-4">
              <li><h4>Products</h4></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-linux/">Cumulus Linux</a></li>
              <li><a href="//cumulusnetworks.com/products/netq/">Cumulus NetQ</a></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-express/">Cumulus Express</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>Learn</h4></li>
              <li><a href="//cumulusnetworks.com/learn/web-scale-networking-education/">Going web-scale</a></li>
              <li><a href="//cumulusnetworks.com/learn/events/">Events</a></li>
              <li><a href="//cumulusnetworks.com/blog/">Blog</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>About</h4></li>
              <li><a href="//cumulusnetworks.com/about/">Our story</a></li>
              <li><a href="//cumulusnetworks.com/about/careers/">Careers</a></li>
              <li><a href="//cumulusnetworks.com/about/media-coverage/">Media coverage</a></li>
              <li><a href="//docs.cumulusnetworks.com/" target="_blank">Tech docs</a></li>
              <li><a href="//cumulusnetworks.com/community/">Community</a></li>
            </ul>
            <ul>
              <li>
                <a href="//twitter.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M23 6.628l-2-.5 1-2-2.464.7A4.48 4.48 0 0 0 12 8.128v1c-3.539.73-6.634-1.2-9.5-4.5q-.75 4 1.5 6l-3-.5c.405 2.069 1.362 3.7 4 4l-2.5 1c1 2 2.566 2.31 5 2.5a10.748 10.748 0 0 1-6.5 2c12.755 5.669 20-2.664 20-10V8.3z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.facebook.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M17.768 7.5H13.5V5.6a.972.972 0 0 1 1.012-1.1c.418 0 2.988.01 2.988.01V.5h-4.329C9.244.5 8.5 3.474 8.5 5.355V7.5h-3v4h3v12h5v-12h3.851z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//linkedin.com/company/cumulus-networks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M6.5 22.5h-5v-13h5zm9-9a2 2 0 0 0-2 2v7h-5v-13h5v1.485a6.307 6.307 0 0 1 3.99-1.495c2.962 0 5.01 2.2 5.01 6.355V22.5h-5v-7a2 2 0 0 0-2-2zM6.5 5A2.5 2.5 0 1 1 4 2.5 2.5 2.5 0 0 1 6.5 5z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//vimeo.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M.5 7.393l.933 1.224S3.36 7.1 4 7.859s3.1 9.925 3.915 11.617c.714 1.483 2.684 3.444 4.845 2.042s9.34-7.529 10.626-14.769-8.642-5.723-9.693.583c2.627-1.577 4.03.642 2.686 3.154s-2.569 4.145-3.211 4.145-1.135-1.679-1.868-4.613c-.76-3.035-.755-8.5-3.911-7.882C4.412 2.721.5 7.393.5 7.393z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.github.com/cumulusnetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <path class="a" d="M19.459 17c0-5.969-4.126-3.532-7.5-3.532s-7.5-2.375-7.5 3.532a3.5 3.5 0 0 0 3.5 3.5h8a3.5 3.5 0 0 0 3.5-3.5z"></path>
                    <path class="a" d="M21.489 10.214l.032.023s2.646-4.572-.6-7.237c-2 0-5.058 3.3-5.058 3.3l.022.016A14.152 14.152 0 0 0 8.1 6.3C8.083 6.285 5.037 3 3.042 3c-3.173 2.6-.729 7.012-.614 7.217a8.876 8.876 0 0 0-1.395 5.743c.241 3.126 2.847 6.54 5.982 6.54H16.9c3.135 0 5.742-3.414 5.982-6.54a8.857 8.857 0 0 0-1.393-5.746z"></path>
                    <ellipse class="a" cx="15.48" cy="17" rx="1" ry="1.5"></ellipse>
                    <ellipse class="a" cx="8.48" cy="17" rx="1" ry="1.5"></ellipse>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//slack.cumulusnetworks.com/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <rect class="a" x=".5" y=".5" width="23" height="23" rx="6" ry="6"></rect>
                    <circle class="a" cx="12" cy="12" r="6"></circle>
                    <circle class="a" cx="19" cy="5" r="1.5"></circle>
                  </svg>
                </a>
              </li>
              <li>
                <p>Cumulus Networks<sup>®</sup> — Data center networking software for the open, modern data center.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <div class="footer-bottom">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <ul>
                      <li><a href="//cumulusnetworks.com/legal/trademarks/">Trademarks</a></li>
                      <li><a href="//cumulusnetworks.com/legal/privacy/">Privacy</a></li>
                      <li><a href="//cumulusnetworks.com/legal/">Terms of service</a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

  
  

</body>

</html>
