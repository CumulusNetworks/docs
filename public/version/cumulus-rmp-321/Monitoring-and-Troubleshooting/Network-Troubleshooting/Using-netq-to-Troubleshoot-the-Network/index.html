<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Using netq to Troubleshoot the Network | Cumulus Networks Documentation</title>

  
  <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">

  
  
  
  <link rel="stylesheet" href="/docs.cumulusnetworks.com/book.min.a378d8a2da6f5357a83a43dff33d6f77fb70401e0399d5ba78faf81d7a1ae1a8.css">

  
  <link rel="icon" href="/docs.cumulusnetworks.com/icons/favicon.png" type="image/x-icon">

  
  <!--
  Made with Book Theme
  https://github.com/alex-shpak/hugo-book
  -->

  
  
  <script src = "/docs.cumulusnetworks.com/js/codecopy.js"> </script>

</head>


<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  
  <header id="site-nav">
    <div class="header-wrapper flex">
      <a href="/">
        <img src="/header-logo.png" alt="Cumulus Networks">
        <img src="/cumulus-networks-rt-white.svg" alt="Cumulus Networks" class="header-mobile">
        <span>Docs</span>
      </a>
      <ul class="flex">
        <li><a href="//cumulusnetworks.com">HOME</a></li>
        <li><a href="//support.cumulusnetworks.com/">SUPPORT</a></li>
        <li><a href="//docs.cumulusnetworks.com/">DOCS</a></li>
        <li><a href="//education.cumulusnetworks.com">EDUCATION</a></li>
        <li><a href="//cumulusnetworks.com/blog/">BLOG</a></li>
        <li><a href="//forums.cumulusnetworks.com/">FORUMS</a></li>
      </ul>
      <div class="burger-menu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  <div id="product-nav" class="flex">
      
    
    <ul>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-linux/ >
        Cumulus Linux </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-netq/ >
        Cumulus NetQ </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-vx/ >
        Cumulus VX </a> </li>
    
      <li>
        <div id="products-dropdown" class="dropdown">
            <button class="btn" type="button" id="dropdownMenuButton">
              Products
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="">Cumulus RMP</a>
              <a class="dropdown-item" href="">Cumulus Chassis</a>
              <a class="dropdown-item" href="">Cumulus Host Pack</a>
            </div>
        </div>
      </li>
    </ul>
    <div class="search-container">
      <div id="doc-search-box">
        <input type="text" class="doc-search-input" placeholder="Search" value="">
        <span><button type="submit"><img src="/icons/search_20x20.svg" alt=""></button></span>
      </div>
      <div id="dropdown" class="dropdown">
          <button class="btn" type="button" id="dropdownMenuButton">
            v3.2.1
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/cumulus-rmp/"> v3.7</a>
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-rmp-25esr/"> v2.5.12</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-rmp-30/"> v3.0.1</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-rmp-31/"> v3.1.2</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-rmp-321/"> v3.2.1</a>
            
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
          </div>
      </div>
    </div>
  </div>
  <main class="flex container">
    <aside class="book-menu fixed">

      <nav role="navigation">
        <h2 class="book-brand">
          <a href="docs.cumulusnetworks.com">Cumulus Networks Documentation</a>
        </h2>
        
        




  <ul class = "cn-book-section-container" id = "top">
    
        
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
            

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/" >
    Cumulus RMP User Guide
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/" >
    System Configuration
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Authentication-Authorization-and-Accounting/" >
    Authentication, Authorization, and Accounting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Authentication-Authorization-and-Accounting/SSH-for-Remote-Access/" >
    SSH for Remote Access
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Authentication-Authorization-and-Accounting/User-Accounts/" >
    User Accounts
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Authentication-Authorization-and-Accounting/Using-sudo-to-Delegate-Privileges/" >
    Using sudo to Delegate Privileges
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Authentication-Authorization-and-Accounting/LDAP-Authentication-and-Authorization/" >
    LDAP Authentication and Authorization
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Installation-Upgrading-and-Package-Management/" >
    Installation, Upgrading and Package Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Installation-Upgrading-and-Package-Management/Managing-Cumulus-RMP-Disk-Images/" >
    Managing Cumulus RMP Disk Images
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Installation-Upgrading-and-Package-Management/Using-Snapshots/" >
    Using Snapshots
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Installation-Upgrading-and-Package-Management/Adding-and-Updating-Packages/" >
    Adding and Updating Packages
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Installation-Upgrading-and-Package-Management/Zero-Touch-Provisioning/" >
    Zero Touch Provisioning
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Network-Command-Line-Utility/" >
    Network Command Line Utility
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Setting-Date-and-Time/" >
    Setting Date and Time
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Managing-Application-Daemons/" >
    Managing Application Daemons
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/System-Configuration/Configuring-switchd/" >
    Configuring switchd
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Interface-Configuration-and-Management/" >
    Interface Configuration and Management
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Interface-Configuration-and-Management/Layer-1-and-Switch-Port-Attributes/" >
    Layer 1 and Switch Port Attributes
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Interface-Configuration-and-Management/Configuring-DHCP-Relays-and-Servers/" >
    Configuring DHCP Relays and Servers
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/" >
    Layer 1 and Layer 2 Features
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/" >
    Ethernet Bridging - VLANs
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/VLAN-aware-Bridge-Mode-for-Large-scale-Layer-2-Environments/" >
    VLAN-aware Bridge Mode for Large-scale Layer 2 Environments
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/Traditional-Mode-Bridges/" >
    Traditional Mode Bridges
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Ethernet-Bridging-VLANs/VLAN-Tagging/" >
    VLAN Tagging
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Spanning-Tree-and-Rapid-Spanning-Tree/" >
    Spanning Tree and Rapid Spanning Tree
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Link-Layer-Discovery-Protocol/" >
    Link Layer Discovery Protocol
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Prescriptive-Topology-Manager-PTM/" >
    Prescriptive Topology Manager - PTM
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Layer-1-and-Layer-2-Features/Bonding-Link-Aggregation/" >
    Bonding - Link Aggregation
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Routing/" >
    Routing
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Routing/Management-VRF/" >
    Management VRF
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/" >
    Monitoring and Troubleshooting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/" >
    Understanding and Decoding the cl-support Output File
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-Log-Files/" >
    Troubleshooting Log Files
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-the-etc-Directory/" >
    Troubleshooting the etc Directory
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Understanding-and-Decoding-the-cl-support-Output-File/Troubleshooting-the-support-Directory/" >
    Troubleshooting the support Directory
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Troubleshooting-Network-Interfaces/" >
    Troubleshooting Network Interfaces
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Troubleshooting-Network-Interfaces/Monitoring-Interfaces-and-Transceivers-Using-ethtool/" >
    Monitoring Interfaces and Transceivers Using ethtool
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Network-Troubleshooting/" >
    Network Troubleshooting
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Network-Troubleshooting/Using-NCLU-to-Troubleshoot-Your-Network-Configuration/" >
    Using NCLU to Troubleshoot Your Network Configuration
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Network-Troubleshooting/Monitoring-System-Statistics-and-Network-Traffic-with-sFlow/" >
    Monitoring System Statistics and Network Traffic with sFlow
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Network-Troubleshooting/Using-netq-to-Troubleshoot-the-Network/"  class="active" >
    Using netq to Troubleshoot the Network
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/SNMP-Monitoring/" >
    SNMP Monitoring
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/SNMP-Monitoring/Using-Nutanix-Prism-as-a-Monitoring-Tool/" >
    Using Nutanix Prism as a Monitoring Tool
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Single-User-Mode-Boot-Recovery/" >
    Single User Mode - Boot Recovery
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Resource-Diagnostics-Using-cl-resource-query/" >
    Resource Diagnostics Using cl-resource-query
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Monitoring-System-Hardware/" >
    Monitoring System Hardware
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Monitoring-Best-Practices/" >
    Monitoring Best Practices
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Quick-Start-Guide/" >
    Quick Start Guide
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-rmp-321/Cumulus-RMP-Index/" >
    Cumulus RMP Index
  </a>


    </li>
    
  </ul>


  </li>


          
      
          
      
          
      
    
  </ul>









      </nav>

      
      
      
      

      <script src = "/docs.cumulusnetworks.com/js/menuBundle.js"> </script>


    </aside>

    <div class="book-page">

      
      <header class="align-center justify-between book-header">
        <label for="menu-control">
          <img src="/docs.cumulusnetworks.com/svg/menu.svg" alt="Menu" />
        </label>
        <strong>Using netq to Troubleshoot the Network</strong>
      </header>

      
      
<div class= "notices info" id = "info" >
    This documentation is for an older version of the software. If you are using the current version of Cumulus Linux, this content may not be up to date. The current version of the documentation is available [here](https://docs.cumulusnetworks.com/).
  </div>
<article class="markdown">
<h1>Using netq to Troubleshoot the Network</h1>


<div class="notices warning" > <p><strong>Early Access Feature</strong></p>

<p><code>netq</code> is an <a href="https://support.cumulusnetworks.com/hc/en-us/articles/202933878" target="_blank">early access
feature</a>
in Cumulus RMP 3.2. Before you can install <code>netq</code>, you must enable the
Early Access repository. For more information about the Cumulus Linux
repository, read <a href="https://support.cumulusnetworks.com/hc/en-us/articles/217422127" target="_blank">this knowledge base
article</a>.</p>
 </div>


<p><code>netq</code> is a tool for troubleshooting the whole network fabric. Instead
of using other tools to troubleshoot node by node, <code>netq</code> aggregates
data from across all the nodes in a network, so you can query and
diagnose issues affecting the whole network, analyze outages or discover
why two or more switches cannot communicate. <code>netq</code> can return a wealth
of data about your network for both layer 2 and the layer 3 IP fabric,
including:</p>

<ul>
<li><p>Interface history</p></li>

<li><p>MLAG checks</p></li>

<li><p>Anycast IP validation</p></li>

<li><p>Interface address history</p></li>

<li><p>IP neighbor history</p></li>

<li><p>MTU validation of traceroutes</p></li>

<li><p>Route history</p></li>

<li><p>Route origin validation</p></li>
</ul>

<p><code>netq</code> provides the ability to see the output of commands on other
switches, even if a switch is currently unavailable. You can even see
the command history so you can go back in time before the issue arouse
to debug it.</p>

<p>Because <code>netq</code> is a Linux application, it&rsquo;s easy to automate with tools
like Ansible, Puppet or Chef.</p>

<h2 id="span-components-span"><span>Components</span></h2>

<p><code>netq</code> has three primary components:</p>

<ul>
<li><p><code>netq-agent</code>: The back end Python agent installed on every Cumulus
RMP switch in the network; the agent pushes out data to a central
server (a <code>redis</code> server, see below) periodically and when specific
<code>netlink</code>events occur. The <code>redis</code> server processes the queries
and sends back a response to the switch. The agent listens for these
events:</p>

<ul>
<li><p>address (IPv4 and IPv6)</p></li>

<li><p>route (IPv4 and IPv6)</p></li>

<li><p>link</p></li>

<li><p>bridge fdb</p></li>

<li><p>IP neighbor</p></li>
</ul></li>

<li><p><code>netq</code>: The command line interface to the <code>netq-agent</code>. You can use
the <code>netq</code> CLI on every Cumulus RMP switch as well as the <code>redis</code>
server.</p></li>

<li><p><code>redis</code> server: The database/key-value store where all network
information sent from <code>netq-agents</code> running on Cumulus RMP switches
is collected and aggregated. The server runs <code>redis</code>version
2.8.17-1.</p></li>
</ul>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5127565/netq.png" alt = "/images/download/attachments/5127565/netq.png"

height = 250


 />


<h2 id="span-feature-limitations-span"><span>Feature Limitations</span></h2>

<p><code>netq</code> is an <a href="https://support.cumulusnetworks.com/hc/en-us/articles/202933878" target="_blank">early access
feature</a>.
As such, the following features are limited or unavailable at this time,
and should be available in a future release of Cumulus RMP:</p>

<ul>
<li><p>You can check BGP health only at this time; reporting OSPF health
should follow in the near future.</p></li>

<li><p>You cannot determine the origin of static routes.</p></li>

<li><p>Interoperability with <a href="/version/cumulus-rmp-321/Routing/Management-VRF">management
VRF</a> is not
supported.</p></li>

<li><p>Clustering the <code>redis</code> server for high availability has not been
tested.</p></li>

<li><p><code>netq</code> has been tested with up to 20 nodes in a fabric, with 8k
routes and MAC addresses per node.</p></li>
</ul>

<p>If you are interested in trying out this or any other early access
feature, contact your Cumulus Networks account representative to let us
know you are testing it.</p>

<h2 id="span-installing-netq-span"><span>Installing netq</span></h2>

<p>To install the <code>netq</code> package  <code>cumulus-netq</code>  on a switch, follow the
instructions below. The <code>cumulus-netq</code> package contains <code>netq</code> and the
<code>netq-agent</code>. Cumulus Networks recommends you install the <code>netq-agent</code>
on every Cumulus RMP switch in the network; you can also install it on
the redis server.</p>

<ol>
<li><p>Open the <code>/etc/apt/sources.list</code> file in a text editor.</p></li>

<li><p>Uncomment the early access repository lines and save the file:</p>

<pre><code>deb http://repo3.cumulusnetworks.com/repo CumulusLinux-3-early-access cumulus
deb-src http://repo3.cumulusnetworks.com/repo CumulusLinux-3-early-access cumulus
</code></pre></li>

<li><p>Run the following commands in a terminal to install the
<code>cumulus-netq</code> package:</p>

<pre><code>cumulus@switch:~$ sudo apt-get update
cumulus@switch:~$ sudo apt-get install cumulus-netq
</code></pre></li>
</ol>

<h3 id="span-installing-redis-server-span"><span>Installing redis Server</span></h3>

<p>Cumulus Networks recommends you install the <code>redis</code> server on its own
server or VM. Ideally, you should run the <code>redis</code> server on a separate,
powerful server for maximum usability and performance  Cumulus Networks
recommends a system with a quad core CPU, 16GB of RAM (with 8GB for
<code>redis</code> itself) and 512GB of storage.</p>

<p>You need to download and install two packages:</p>

<ul>
<li><p>The <a href="https://packages.debian.org/jessie/database/redis-server" target="_blank"><code>redis-server</code>
package</a>,
version 2.8.17-1.</p></li>

<li><p>The <a href="https://packages.debian.org/jessie/redis-tools" target="_blank"><code>redis-tools</code>
package</a>, version
2.8.17-1.</p></li>
</ul>

<p>Use <code>apt-get</code> to install the packages:</p>

<pre><code>root@redis-server:~# apt-get update
root@redis-server:~# apt-get install redis-server redis-tools
</code></pre>

<p>After you install these packages, connect the server over the management
network to ensure network connectivity even if the in-band network is
unavailable. Note its IP address, as you need to specify it when you
configure <code>netq</code>.</p>


<div class="notices note" > <p>If you want to run the <code>netq</code> CLI on the redis server, you need to
install the <code>cumulus-netq</code> package on the server. You&rsquo;ll need to update
your sources.list file to include the <a href="https://support.cumulusnetworks.com/hc/en-us/articles/217422127" target="_blank">Cumulus Linux
repository</a>.
The install the package, following the instructions in the <a href="https://cumulusnetworks.zendesk.com/hc/en-us/articles/232013208" target="_blank">Cumulus
Linux 3.2 release
notes</a>.
The <code>cumulus-netq</code> package contains the <code>netq</code> client, which contains
the CLI.</p>
 </div>



<div class="notices note" > <p>You cannot specify a port number for the <code>redis</code> server at this time.</p>
 </div>


<p>Once you install the redis server, you must configure it before you can
configure netq on the switch.</p>

<h2 id="span-configuring-the-redis-server-span"><span>Configuring the redis Server</span></h2>

<p>Depending upon the operating system of the redis server host, you may
need to modify its configuration before it can start monitoring the
network. Check the <code>/etc/redis/redis.conf</code> file and verify that the
server is listening to external-facing ports, and not the localhost.</p>

<ol>
<li><p>Edit <code>/etc/redis/redis.conf</code>:</p>

<pre><code>root@redis-server:~# vi /etc/redis/redis.conf
</code></pre></li>

<li><p>If the bind line links to localhost (127.0.0.1), change it to the IP
address of one or more external ports, such as eth0:</p>

<pre><code>bind 192.0.2.240
</code></pre></li>

<li><p>Restart the <code>redis-server</code> service. For example, on a Debian host,
run:</p>

<pre><code>root@redis-server:~# systemctl restart redis-server
</code></pre></li>
</ol>

<h2 id="span-configuring-netq-span"><span>Configuring netq</span></h2>

<p>Once you install the <code>netq</code> packages and configure the redis server, you
need to configure <code>netq</code> to monitor your network.</p>

<ol>
<li><p>To ensure useful output, ensure that
<a href="/version/cumulus-rmp-321/System-Configuration/Setting-Date-and-Time">NTP</a>
is running.</p></li>

<li><p>Specify the IP address of the <code>redis</code> server. For example:</p>

<pre><code>cumulus@switch:~$ sudo netq add server 198.51.100.1
</code></pre></li>

<li><p>Start the <code>netq</code> agent.</p>

<pre><code>cumulus@switch:~$ sudo netq agent start
</code></pre>


<div class="notices note" > <pre><code>If you see the following error, it means you haven't added the redis
server or the server wasn't configured:

    cumulus@switch:~$ sudo netq agent start
    Error: Please specify IP address of DB server
</code></pre>
 </div>
</li>
</ol>

<p>The <code>netq</code> configuration is stored in the following files:</p>

<ul>
<li><p><code>/etc/netq/netq-agent.conf</code>: Contains basic agent configuration,
including the <code>redis</code> server IP address.</p></li>

<li><p><code>/etc/netq/netq-agent-commands.json</code>: Contains key-value pairs of
commands whose outputs are pushed along with the key to be
associated, periodicity of push and so forth.</p></li>

<li><p><code>/etc/netq/netq-agent-running.json</code>: Log of the actual commands that
are being pushed to the agent, as determined when the agent starts,
as well as the <code>redis</code> server IP address and more.</p></li>
</ul>

<h2 id="span-using-netq-span"><span>Using netq</span></h2>

<p><code>netq</code> has a number of options to use with the command to return various
kinds of data about your network  press the <em>Tab</em> key at any time to
reveal the options available to a given part of the command. Running
<code>netq</code> on its own reveals all the options, with a brief explanation for
each one:</p>

<pre><code>cumulus@switch:~$ netq &lt;TAB&gt;
add : Update configuration
agent : Netq agent
health : Show liveness and status of agent/bgp/mlag in fabric
help : Show usage info
resolve : Annotate input with names and interesting info
server : IP address of DB server
show : Show fabric-wide info
view : Show output of pre-defined commands on specific node
</code></pre>

<h3 id="span-checking-the-health-of-the-network-span"><span>Checking the Health of the Network</span></h3>

<p>It&rsquo;s best to start with <code>netq check agents</code>to see the status of every
network node, based on the whether the agent missed receiving any
heartbeats sent from the node. A node&rsquo;s status can be one of the
following:</p>

<ul>
<li><p><strong>Fresh:</strong> The agent is running fine, no heartbeats were missed.</p></li>

<li><p><strong>Stale:</strong> The agent missed one heartbeat, which is not unusual.</p></li>

<li><p><strong>Rotten:</strong> The agent missed five consecutive heartbeats.</p></li>
</ul>

<!-- end list -->

<pre><code>cumulus@switch:~$ sudo netq check agents

Node Name  Connect Time  Time Since Connect       Status
---------- ------------- ------------------------ --------
leaf-1     2016-08-23    03:59:00 15 seconds ago  Fresh
leaf-2     2016-08-23    03:59:00 14 seconds ago  Fresh
leaf-3     2016-08-23    03:58:59 16 seconds ago  Fresh
leaf-4     2016-08-23    03:58:55 20 seconds ago  Fresh
leaf-5     2016-08-23    03:58:59 16 seconds ago  Fresh
leaf-6     2016-08-23    03:58:59 15 seconds ago  Fresh
leaf-7     2016-08-23    03:58:59 16 seconds ago  Fresh
leaf-8     2016-08-23    03:58:58 16 seconds ago  Fresh
leaf-9     2016-08-23    03:58:56 19 seconds ago  Fresh
spine-1    2016-08-23    03:58:59 16 seconds ago  Fresh
spine-2    2016-08-23    03:58:58 17 seconds ago  Fresh
spine-3    2016-08-23    03:58:55 19 seconds ago  Fresh
spine-4    2016-08-23    03:58:56 19 seconds ago  Fresh
</code></pre>

<p>You can also check the health of BGP and MLAG in the network:</p>

<pre><code>cumulus@switch:~$ netq check bgp
No BGP sessions in failed state


cumulus@switch:~$ netq check clag
Failed Node          Reason
-------------------- ------------------------------------------------------------
leaf-9               Peer Connectivity failed
None
</code></pre>

<h3 id="span-using-netq-show-span"><span>Using netq show</span></h3>

<p>The <code>netq show</code> command can return information regarding the network
fabric overall, including:</p>

<ul>
<li><p>Interface IP and MAC addresses across all nodes in the fabric.</p></li>

<li><p>Interfaces across all nodes in the fabric.</p></li>

<li><p>IPv4 and IPv6-related information.</p></li>

<li><p>LLDP-based neighbor information.</p></li>

<li><p>MAC address information, with VLANs if present, across the fabric.</p></li>
</ul>

<p>The <code>netq show</code> command takes the following options:</p>

<pre><code>cumulus@switch:~$ sudo netq show [addresses | info | interfaces | ip | ipv6 | lldp | macs]
</code></pre>

<p>To see MAC address information for switch leaf-1, you would run:</p>

<pre><code>cumulus@switch:~$ netq show macs leaf-1
List of nodes containing MAC *
MAC               VLAN   Node Name   Egress Port   Update Time
----------------- ------ ----------- ------------- --------------
00:00:5e:00:01:01  0     leaf-1      bridge        33 minutes ago
00:00:5e:00:01:01  0     leaf-1      bridge.20     33 minutes ago
00:00:5e:00:01:01  20    leaf-1      bridge        33 minutes ago
08:00:27:51:3f:c2  0     leaf-1      bond-swp6     33 minutes ago
08:00:27:51:3f:c2  20    leaf-1      bridge        33 minutes ago
08:00:27:7f:06:83  0     leaf-1      peer-link     33 minutes ago
08:00:27:9d:9d:2d  0     leaf-1      bond-swp5     33 minutes ago
</code></pre>

<p>You can filter the output to a given interface on a switch, in this case
a bridge on leaf-1 named <em>bridge</em>:</p>

<pre><code>vagrant@spine-1:~$ netq show macs leaf-1 bridge
List of nodes containing MAC *
MAC               VLAN   Node Name   Egress Port   Update Time
----------------- ------ ----------- ------------- --------------
00:00:5e:00:01:01  0     leaf-1      bridge        33 minutes ago
00:00:5e:00:01:01  20    leaf-1      bridge        33 minutes ago
08:00:27:51:3f:c2  20    leaf-1      bridge        33 minutes ago
</code></pre>

<p>To see the route information, run:</p>

<pre><code>cumulus@switch:~$ netq show ip routes 10.1.20.1
Route info about prefix 10.1.20.1 on host *
Origin Table IP               Node             Nexthops                  Update Time
------ ----- ---------------- ---------------- ------------------------- ----------------
0      254   10.1.20.0/24     leaf-3           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp2,
                                               169.254.0.1: swp3
0      254   10.1.20.0/24     leaf-4           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp2
0      254   10.1.20.0/24     leaf-5           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp2
0      254   10.1.20.0/24     leaf-6           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp2,
                                               169.254.0.1: swp1
0      254   10.1.20.0/24     leaf-7           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp2
0      254   10.1.20.0/24     leaf-8           169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp2
0      254   10.1.20.0/24    leaf-9            169.254.0.1: swp4,        38 minutes ago
                                               169.254.0.1: swp3,
                                               169.254.0.1: swp1,
                                               169.254.0.1: swp2
0      254   10.1.20.0/24    spine-1           169.254.0.1: swp2,        38 minutes ago
                                               169.254.0.1: swp1
0      254   10.1.20.0/24    spine-2           169.254.0.1: swp1,        38 minutes ago
                                               169.254.0.1: swp2
0      254   10.1.20.0/24    spine-3           169.254.0.1: swp1,        38 minutes ago
                                               169.254.0.1: swp2
0      254   10.1.20.0/24    spine-4           169.254.0.1: swp1,        38 minutes ago
                                               169.254.0.1: swp2
1      254   10.1.20.0/24    leaf-2            Local                     38 minutes ago
1      255   10.1.20.1/32    leaf-1            Local                     38 minutes ago
</code></pre>

<h3 id="span-using-netq-view-span"><span>Using netq view</span></h3>

<p>The <code>netq view</code> command provides information about a specific node in
the network. The available options are:</p>

<pre><code>cumulus@switch:~$ netq view leaf-1 &lt;TAB&gt;
addr : addr
bgp : bgp
clagctl : clagctl
config : config
counters : counters
ifquery : ifquery
link : link
lldp : lldp
meminfo : meminfo
mstpctl : mstpctl
uptime : uptime
</code></pre>

<p>For example, to see the BGP summary for switch leaf-5, run:</p>

<pre><code>cumulus@switch:~$ netq view leaf-5 bgp summary
Output retrieved from 6 seconds ago
BGP router identifier 192.0.2.10, local AS number 64517 vrf-id 0
BGP table version 27
RIB entries 33, using 3960 bytes of memory
Peers 4, using 65 KiB of memory
Peer groups 1, using 56 bytes of memory

Neighbor V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd
spine-1(swp1) 4 65000 169503 169504 0 0 0 5d21h17m 12
spine-2(swp2) 4 65000 169505 169508 0 0 0 5d21h17m 12
spine-3(swp3) 4 65000 169505 169508 0 0 0 5d21h17m 12
spine-4(swp4) 4 65000 169504 169512 0 0 0 5d21h17m 12


Total number of neighbors 4
</code></pre>

<h2 id="span-monitoring-the-redis-server-span"><span>Monitoring the redis Server</span></h2>

<p>You can use the <code>redis-cli info</code> command to determine how much memory is
consumed by the <code>redis</code> server, how many connections there are, and so
forth.</p>

<p>Two recommended commands to use are <code>redis-cli info</code>and <code>redis-cli
ping</code>.</p>


<div class="notices note" > <p>To use the <a href="http://redis.io/topics/rediscli" target="_blank"><code>redis</code> CLI</a>, you need to
<a href="https://packages.debian.org/jessie/redis-tools" target="_blank">install</a> <code>redis-tools</code>.</p>
 </div>


<h3 id="span-specifying-a-different-redis-server-span"><span>Specifying a Different redis Server</span></h3>

<p>If you need to change the IP address of the <code>redis</code> server, run <code>netq
add server</code> again, specifying the IP address of the new server, then
restart the <code>netq</code> agent. For example:</p>

<pre><code>cumulus@switch:~$ sudo netq add 198.51.100.10
cumulus@switch:~$ sudo netq agent restart
</code></pre>

<p>Note that you need to specify this for every switch that you&rsquo;re
monitoring with <code>netq</code>. Cumulus Networks recommends you use an
automation tool like Ansible or Puppet to quickly update the server
across all switches.</p>

<h2 id="span-troubleshooting-netq-span"><span>Troubleshooting netq</span></h2>

<p><code>netq</code> agent logs to <code>/var/log/netq-agent.log</code>. The logs are logrotated.</p>

<p>To ensure that the <code>netq</code> agent is running, run:</p>

<pre><code>cumulus@switch:~$ sudo netq agent status
Running...
</code></pre>

<article id="html-search-results" class="ht-content" style="display: none;">

</article>

<footer id="ht-footer">

</footer>
</article>

      <script src="https://utteranc.es/client.js"
        repo="CumulusNetworks/docs-internal"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
      </script>

    </div>
    

      


  

    <aside class="book-toc fixed">

  
    <div class="toc">
    
      <button>
      <a href="https://github.com/CumulusNetworks/docs/edit/master/content/version/cumulus-rmp-321/Monitoring-and-Troubleshooting/Network-Troubleshooting/Using-netq-to-Troubleshoot-the-Network.md" target="_blank" rel="noopener"><img src="/docs.cumulusnetworks.com/svg/pencil-circle.svg" alt="Edit" /> Edit this page</a>
      </button>
    
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#span-components-span"><span>Components</span></a></li>
<li><a href="#span-feature-limitations-span"><span>Feature Limitations</span></a></li>
<li><a href="#span-installing-netq-span"><span>Installing netq</span></a>
<ul>
<li><a href="#span-installing-redis-server-span"><span>Installing redis Server</span></a></li>
</ul></li>
<li><a href="#span-configuring-the-redis-server-span"><span>Configuring the redis Server</span></a></li>
<li><a href="#span-configuring-netq-span"><span>Configuring netq</span></a></li>
<li><a href="#span-using-netq-span"><span>Using netq</span></a>
<ul>
<li><a href="#span-checking-the-health-of-the-network-span"><span>Checking the Health of the Network</span></a></li>
<li><a href="#span-using-netq-show-span"><span>Using netq show</span></a></li>
<li><a href="#span-using-netq-view-span"><span>Using netq view</span></a></li>
</ul></li>
<li><a href="#span-monitoring-the-redis-server-span"><span>Monitoring the redis Server</span></a>
<ul>
<li><a href="#span-specifying-a-different-redis-server-span"><span>Specifying a Different redis Server</span></a></li>
</ul></li>
<li><a href="#span-troubleshooting-netq-span"><span>Troubleshooting netq</span></a></li>
</ul></li>
</ul>
</nav>
    </div>
  

</aside>






  </main>
  <footer class="footer-top">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="footer-content">
            <div class="mb-4">
                <img src="https://static.cumulusnetworks.com/static/images/shared/cumulus-networks-rt-white-trademarked.ff839f1b2570.svg">
                <p> <script type="text/javascript">document.write(new Date().getFullYear());</script> Cumulus Networks.<br>
                Site by <a href="//unomena.com/" target="_blank">Unomena</a>.</p>
            </div>
            <ul class="mb-4">
              <li><h4>Products</h4></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-linux/">Cumulus Linux</a></li>
              <li><a href="//cumulusnetworks.com/products/netq/">Cumulus NetQ</a></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-express/">Cumulus Express</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>Learn</h4></li>
              <li><a href="//cumulusnetworks.com/learn/web-scale-networking-education/">Going web-scale</a></li>
              <li><a href="//cumulusnetworks.com/learn/events/">Events</a></li>
              <li><a href="//cumulusnetworks.com/blog/">Blog</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>About</h4></li>
              <li><a href="//cumulusnetworks.com/about/">Our story</a></li>
              <li><a href="//cumulusnetworks.com/about/careers/">Careers</a></li>
              <li><a href="//cumulusnetworks.com/about/media-coverage/">Media coverage</a></li>
              <li><a href="//docs.cumulusnetworks.com/" target="_blank">Tech docs</a></li>
              <li><a href="//cumulusnetworks.com/community/">Community</a></li>
            </ul>
            <ul>
              <li>
                <a href="//twitter.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M23 6.628l-2-.5 1-2-2.464.7A4.48 4.48 0 0 0 12 8.128v1c-3.539.73-6.634-1.2-9.5-4.5q-.75 4 1.5 6l-3-.5c.405 2.069 1.362 3.7 4 4l-2.5 1c1 2 2.566 2.31 5 2.5a10.748 10.748 0 0 1-6.5 2c12.755 5.669 20-2.664 20-10V8.3z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.facebook.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M17.768 7.5H13.5V5.6a.972.972 0 0 1 1.012-1.1c.418 0 2.988.01 2.988.01V.5h-4.329C9.244.5 8.5 3.474 8.5 5.355V7.5h-3v4h3v12h5v-12h3.851z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//linkedin.com/company/cumulus-networks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M6.5 22.5h-5v-13h5zm9-9a2 2 0 0 0-2 2v7h-5v-13h5v1.485a6.307 6.307 0 0 1 3.99-1.495c2.962 0 5.01 2.2 5.01 6.355V22.5h-5v-7a2 2 0 0 0-2-2zM6.5 5A2.5 2.5 0 1 1 4 2.5 2.5 2.5 0 0 1 6.5 5z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//vimeo.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M.5 7.393l.933 1.224S3.36 7.1 4 7.859s3.1 9.925 3.915 11.617c.714 1.483 2.684 3.444 4.845 2.042s9.34-7.529 10.626-14.769-8.642-5.723-9.693.583c2.627-1.577 4.03.642 2.686 3.154s-2.569 4.145-3.211 4.145-1.135-1.679-1.868-4.613c-.76-3.035-.755-8.5-3.911-7.882C4.412 2.721.5 7.393.5 7.393z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.github.com/cumulusnetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <path class="a" d="M19.459 17c0-5.969-4.126-3.532-7.5-3.532s-7.5-2.375-7.5 3.532a3.5 3.5 0 0 0 3.5 3.5h8a3.5 3.5 0 0 0 3.5-3.5z"></path>
                    <path class="a" d="M21.489 10.214l.032.023s2.646-4.572-.6-7.237c-2 0-5.058 3.3-5.058 3.3l.022.016A14.152 14.152 0 0 0 8.1 6.3C8.083 6.285 5.037 3 3.042 3c-3.173 2.6-.729 7.012-.614 7.217a8.876 8.876 0 0 0-1.395 5.743c.241 3.126 2.847 6.54 5.982 6.54H16.9c3.135 0 5.742-3.414 5.982-6.54a8.857 8.857 0 0 0-1.393-5.746z"></path>
                    <ellipse class="a" cx="15.48" cy="17" rx="1" ry="1.5"></ellipse>
                    <ellipse class="a" cx="8.48" cy="17" rx="1" ry="1.5"></ellipse>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//slack.cumulusnetworks.com/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <rect class="a" x=".5" y=".5" width="23" height="23" rx="6" ry="6"></rect>
                    <circle class="a" cx="12" cy="12" r="6"></circle>
                    <circle class="a" cx="19" cy="5" r="1.5"></circle>
                  </svg>
                </a>
              </li>
              <li>
                <p>Cumulus Networks<sup></sup>  Data center networking software for the open, modern data center.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <div class="footer-bottom">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <ul>
                      <li><a href="//cumulusnetworks.com/legal/trademarks/">Trademarks</a></li>
                      <li><a href="//cumulusnetworks.com/legal/privacy/">Privacy</a></li>
                      <li><a href="//cumulusnetworks.com/legal/">Terms of service</a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

  
  

</body>

</html>
