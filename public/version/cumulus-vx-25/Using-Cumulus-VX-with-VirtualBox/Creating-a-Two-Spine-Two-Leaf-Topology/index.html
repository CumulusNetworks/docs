<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Creating a Two-Spine, Two-Leaf Topology | Cumulus Networks Documentation</title>

  
  <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">

  
  
  
  <link rel="stylesheet" href="/docs.cumulusnetworks.com/book.min.a378d8a2da6f5357a83a43dff33d6f77fb70401e0399d5ba78faf81d7a1ae1a8.css">

  
  <link rel="icon" href="/docs.cumulusnetworks.com/icons/favicon.png" type="image/x-icon">

  
  <!--
  Made with Book Theme
  https://github.com/alex-shpak/hugo-book
  -->

  
  
  <script src = "/docs.cumulusnetworks.com/js/codecopy.js"> </script>

</head>


<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  
  <header id="site-nav">
    <div class="header-wrapper flex">
      <a href="/">
        <img src="/header-logo.png" alt="Cumulus Networks">
        <img src="/cumulus-networks-rt-white.svg" alt="Cumulus Networks" class="header-mobile">
        <span>Docs</span>
      </a>
      <ul class="flex">
        <li><a href="//cumulusnetworks.com">HOME</a></li>
        <li><a href="//support.cumulusnetworks.com/">SUPPORT</a></li>
        <li><a href="//docs.cumulusnetworks.com/">DOCS</a></li>
        <li><a href="//education.cumulusnetworks.com">EDUCATION</a></li>
        <li><a href="//cumulusnetworks.com/blog/">BLOG</a></li>
        <li><a href="//forums.cumulusnetworks.com/">FORUMS</a></li>
      </ul>
      <div class="burger-menu">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  <div id="product-nav" class="flex">
      
    
    <ul>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-linux/ >
        Cumulus Linux </a> </li>
    
      <li><a href = docs.cumulusnetworks.com/cumulus-netq/ >
        Cumulus NetQ </a> </li>
    
      <li class = "active" ><a href = docs.cumulusnetworks.com/cumulus-vx/ >
        Cumulus VX </a> </li>
    
      <li>
        <div id="products-dropdown" class="dropdown">
            <button class="btn" type="button" id="dropdownMenuButton">
              Products
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="">Cumulus RMP</a>
              <a class="dropdown-item" href="">Cumulus Chassis</a>
              <a class="dropdown-item" href="">Cumulus Host Pack</a>
            </div>
        </div>
      </li>
    </ul>
    <div class="search-container">
      <div id="doc-search-box">
        <input type="text" class="doc-search-input" placeholder="Search" value="">
        <span><button type="submit"><img src="/icons/search_20x20.svg" alt=""></button></span>
      </div>
      <div id="dropdown" class="dropdown">
          <button class="btn" type="button" id="dropdownMenuButton">
            v2.5
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/cumulus-vx/"> v3.4</a>
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-vx-25/"> v2.5</a>
            
            
            
             
             
            <a class = "dropdown-item" href = "docs.cumulusnetworks.com/version/cumulus-vx-30/"> v3.0</a>
            
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
             
            
            
             
             
            
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
             
            
          </div>
      </div>
    </div>
  </div>
  <main class="flex container">
    <aside class="book-menu fixed">

      <nav role="navigation">
        <h2 class="book-brand">
          <a href="docs.cumulusnetworks.com">Cumulus Networks Documentation</a>
        </h2>
        
        




  <ul class = "cn-book-section-container" id = "top">
    
        
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
      
          
            

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/" >
    Cumulus VX Getting Started Guide
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VMware/" >
    Using Cumulus VX with VMware
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VMware/Using-Cumulus-VX-with-VMware-vSphere-ESXi-5.5/" >
    Using Cumulus VX with VMware vSphere - ESXi 5.5
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VMware/Using-Cumulus-VX-with-VMware-Fusion/" >
    Using Cumulus VX with VMware Fusion
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VMware/Using-Cumulus-VX-with-VMware-Workstation/" >
    Using Cumulus VX with VMware Workstation
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VirtualBox/" >
    Using Cumulus VX with VirtualBox
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VirtualBox/Creating-a-Two-Spine-Two-Leaf-Topology/"  class="active" >
    Creating a Two-Spine, Two-Leaf Topology
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-VirtualBox/An-Alternative-Method-for-Adding-More-Nodes-to-the-Network/" >
    An Alternative Method for Adding More Nodes to the Network
  </a>


    </li>
    
  </ul>


  </li>


    
      

  <li class="cn-book-section">
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-GNS3/" >
    Using Cumulus VX with GNS3
  </a>



      

  <ul class="cn-book-section-container" id = "subsection">
    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-GNS3/Using-GNS3-with-QEMU-and-KVM-Virtual-Machines/" >
    Using GNS3 with QEMU and KVM Virtual Machines
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-GNS3/Using-GNS3-with-VirtualBox-VMs/" >
    Using GNS3 with VirtualBox VMs
  </a>


    </li>
    
  </ul>


  </li>


    
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-KVM/" >
    Using Cumulus VX with KVM
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Using-Cumulus-VX-with-Vagrant/" >
    Using Cumulus VX with Vagrant
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Comparing-Cumulus-VX-with-Other-Cumulus-Networks-Products/" >
    Comparing Cumulus VX with Other Cumulus Networks Products
  </a>


    </li>
    
    <li >
      

  <a href="docs.cumulusnetworks.com/version/cumulus-vx-25/Configuring-the-Network-Interfaces-and-Quagga/" >
    Configuring the Network Interfaces and Quagga
  </a>


    </li>
    
  </ul>


  </li>


          
      
          
      
    
  </ul>









      </nav>

      
      
      
      

      <script src = "/docs.cumulusnetworks.com/js/menuBundle.js"> </script>


    </aside>

    <div class="book-page">

      
      <header class="align-center justify-between book-header">
        <label for="menu-control">
          <img src="/docs.cumulusnetworks.com/svg/menu.svg" alt="Menu" />
        </label>
        <strong>Creating a Two-Spine, Two-Leaf Topology</strong>
      </header>

      
      
<div class= "notices info" id = "info" >
    This documentation is for an older version of the software. If you are using the current version of Cumulus Linux, this content may not be up to date. The current version of the documentation is available [here](https://docs.cumulusnetworks.com/).
  </div>
<article class="markdown">
<h1>Creating a Two-Spine, Two-Leaf Topology</h1>

<p>To create a two-spine/two-leaf configuration, you start by importing the
OVA image into VirtualBox four times, as each instance of the VM
represents one leaf or spine switch (Cumulus VX-leaf1, Cumulus VX-leaf2,
Cumulus VX-spine1 and Cumulus VX-spine2). Then you configure each VM&rsquo;s
network interfaces and routing settings.</p>

<h2 id="span-configuring-the-leaf1-vm-span"><span>Configuring the leaf1 VM</span></h2>

<p>Import the Cumulus VX-leaf1 VM into VirtualBox, then configure its
settings.</p>

<ol>
<li><p>Double-click the OVA image file to open VirtualBox.</p></li>

<li><p>Check <strong>Reinitialize the MAC addresses of all network cards</strong>,
unless you have a strong reason not to do so.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5115392/VX_import.png" alt = "/images/download/attachments/5115392/VX_import.png"


width = 500

 />
</li>

<li><p>Click <strong>Import</strong> to start importing the image into VirtualBox.</p></li>

<li><p>Configure the VM settings. In the VM list, select this VM and click
<strong>Settings</strong>.</p>

<ul>
<li><p>On the <strong>General</strong> tab, change the <strong>Name</strong> to <em>Cumulus
VX-leaf1</em>.</p></li>

<li><p>On the <strong>Network</strong> tab, configure the virtual NICs:</p>

<ul>
<li><p>On the <strong>Adapter1</strong> tab, in the <strong>Attached to</strong> list, select
<em>NAT</em>. This provides the VM with outside connectivity;
depending upon your virtual network, you may need to choose
a <a href="https://www.virtualbox.org/manual/ch06.html" target="_blank">different
option</a>.</p></li>

<li><p>On the <strong>Adapter2</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l1s1</em>,
which indicates that the Cumulus VX-leaf1 VM connects to the
Cumulus VX-spine1 VM.</p></li>

<li><p>On the <strong>Adapter3</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l1s2</em>,
which indicates that the Cumulus VX-leaf1 VM connects to the
Cumulus VX-spine2 VM.</p></li>

<li><p>On the <strong>Adapter4</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>leaf1</em>.</p></li>
</ul></li>
</ul></li>

<li><p>Click <strong>OK</strong> to apply your settings.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5115392/VX_vbox_settings_leaf1.png" alt = "/images/download/attachments/5115392/VX_vbox_settings_leaf1.png"


width = 500

 />
</li>
</ol>

<h2 id="span-configuring-the-leaf2-vm-span"><span>Configuring the leaf2 VM</span></h2>

<p>Import the Cumulus VX-leaf2 VM into VirtualBox, reinitializing the MAC
addresses as stated above, then configure its settings.</p>

<ol>
<li><p>In the VM list, select this VM and click <strong>Settings</strong>.</p>

<ul>
<li><p>On the <strong>General</strong> tab, change the <strong>Name</strong> to <em>Cumulus
VX-leaf2</em>.</p></li>

<li><p>On the <strong>Network</strong> tab, configure the virtual NICs:</p>

<ul>
<li><p>On the <strong>Adapter1</strong> tab, in the <strong>Attached to</strong> list, select
<em>NAT</em>. This provides the VM with outside connectivity;
depending upon your virtual network, you may need to choose
a <a href="https://www.virtualbox.org/manual/ch06.html" target="_blank">different
option</a>.</p></li>

<li><p>On the <strong>Adapter2</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l2s1</em>,
which indicates that the Cumulus VX-leaf2 VM connects to the
Cumulus VX-spine1 VM.</p></li>

<li><p>On the <strong>Adapter3</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l2s2</em>,
which indicates that the Cumulus VX-leaf2 VM connects to the
Cumulus VX-spine2 VM.</p></li>

<li><p>On the <strong>Adapter4</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>leaf2</em>.</p></li>
</ul></li>
</ul></li>

<li><p>Click <strong>OK</strong> to apply your settings.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5115392/VX_vbox_settings_leaf2.png" alt = "/images/download/attachments/5115392/VX_vbox_settings_leaf2.png"


width = 500

 />
</li>
</ol>

<h2 id="span-configuring-the-spine1-vm-span"><span>Configuring the spine1 VM</span></h2>

<p>Import the Cumulus VX-spine1 VM into VirtualBox, reinitializing the MAC
addresses as stated above, then configure its settings.</p>

<ol>
<li><p>In the VM list, select this VM and click <strong>Settings</strong>.</p>

<ul>
<li><p>On the <strong>General</strong> tab, change the <strong>Name</strong> to <em>Cumulus
VX-spine1</em>.</p></li>

<li><p>On the <strong>Network</strong> tab, configure the virtual NICs:</p>

<ul>
<li><p>On the <strong>Adapter1</strong> tab, in the <strong>Attached to</strong> list, select
<em>NAT</em>. This provides the VM with outside connectivity;
depending upon your virtual network, you may need to choose
a <a href="https://www.virtualbox.org/manual/ch06.html" target="_blank">different
option</a>.</p></li>

<li><p>On the <strong>Adapter2</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l1s1</em>,
which indicates that the Cumulus VX-spine1 VM connects to
the Cumulus VX-leaf1 VM.</p></li>

<li><p>On the <strong>Adapter3</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l2s1</em>,
which indicates that the Cumulus VX-spine1 VM connects to
the Cumulus VX-leaf2 VM.</p></li>

<li><p>On the <strong>Adapter4</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>spine1</em>.</p></li>
</ul></li>
</ul></li>

<li><p>Click <strong>OK</strong> to apply your settings.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5115392/VX_vbox_settings_spine1.png" alt = "/images/download/attachments/5115392/VX_vbox_settings_spine1.png"


width = 500

 />
</li>
</ol>

<h2 id="span-configuring-the-spine2-vm-span"><span>Configuring the spine2 VM</span></h2>

<p>Import the Cumulus VX-spine2 VM into VirtualBox, reinitializing the MAC
addresses as stated above, then configure its settings.</p>

<ol>
<li><p>In the VM list, select this VM and click <strong>Settings</strong>.</p>

<ul>
<li><p>On the <strong>General</strong> tab, change the <strong>Name</strong> to <em>Cumulus
VX-spine2</em>.</p></li>

<li><p>On the <strong>Network</strong> tab, configure the virtual NICs:</p>

<ul>
<li><p>On the <strong>Adapter1</strong> tab, in the <strong>Attached to</strong> list, select
<em>NAT</em>. This provides the VM with outside connectivity;
depending upon your virtual network, you may need to choose
a <a href="https://www.virtualbox.org/manual/ch06.html" target="_blank">different
option</a>.</p></li>

<li><p>On the <strong>Adapter2</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l1s2</em>,
which indicates that the Cumulus VX-spine2 VM connects to
the Cumulus VX-leaf1 VM.</p></li>

<li><p>On the <strong>Adapter3</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>l2s2</em>,
which indicates that the Cumulus VX-spine2 VM connects to
the Cumulus VX-leaf2 VM.</p></li>

<li><p>On the <strong>Adapter4</strong> tab, in the <strong>Attached to</strong> list, select
<em>Internal Network</em>. Then, change the <strong>Name</strong> to <em>spine2</em>.</p></li>
</ul></li>
</ul></li>

<li><p>Click <strong>OK</strong> to apply your settings.</p>








<img class = "confluence-embedded-image" src = "/images/download/attachments/5115392/VX_vbox_settings_spine2.png" alt = "/images/download/attachments/5115392/VX_vbox_settings_spine2.png"


width = 500

 />
</li>
</ol>

<h2 id="span-configuring-network-interfaces-and-quagga-span"><span>Configuring Network Interfaces and Quagga</span></h2>

<p>The next step is to configure the 2 leaf/2 spine topology. This includes
setting up the network interfaces, and Quagga, and assumes the previous
sections have been completed.</p>

<h3 id="span-configuring-leaf1-vm-span"><span>Configuring leaf1 VM</span></h3>

<p>To configure leaf1:</p>

<ol>
<li><p>Power on and log into the VM using the following credentials:</p>

<ul>
<li><p>username: cumulus</p></li>

<li><p>password: CumulusLinux!</p></li>
</ul></li>

<li><p>Configure the interfaces:</p>

<ol>
<li><p>Log in as root, using the password CumulusLinux!</p>

<pre><code>cumulus@leaf1:~$ sudo -i
</code></pre></li>

<li><p>Open <code>/etc/network/interfaces</code> in a text editor.</p></li>

<li><p>Edit the interfaces as shown below, and save the file:</p>

<pre><code># The loopback network interface
auto lo
  iface lo inet loopback
  address 10.2.1.1/32

# The primary network interface
auto eth0
  iface eth0 inet dhcp

auto swp1
  iface swp1
  address 10.2.1.1/32

auto swp2
  iface swp2
  address 10.2.1.1/32

auto swp3
  iface swp3
  address 10.4.1.1/24
</code></pre></li>
</ol></li>

<li><p>Configure Quagga:</p>

<ol>
<li><p>Open the <code>/etc/quagga/daemons</code> file in a text editor.</p></li>

<li><p>Set <code>zebra</code>, <code>bgpd</code>, and <code>ospfd</code> to <em>yes</em>, and save the file.</p>

<pre><code>zebra=yes
bgpd=yes
ospfd=yes
...
</code></pre></li>

<li><p>Create the <code>/etc/quagga/Quagga.conf</code> file in a text editor.</p></li>

<li><p>Configure the file as shown below, and save the file:</p>

<pre><code>service integrated-vtysh-config

interface swp1
  ip ospf network point-to-point

interface swp2
  ip ospf network point-to-point

router-id 10.2.1.1

router ospf
  ospf router-id 10.2.1.1
  network 10.2.1.1/32 area 0.0.0.0
  network 10.4.1.0/24 area 0.0.0.0
</code></pre></li>
</ol></li>

<li><p>Restart the networking service:</p>

<pre><code>root@leaf1:~$ service networking restart
</code></pre></li>

<li><p>Restart Quagga:</p>

<pre><code>root@leaf1:~$ service quagga restart
</code></pre></li>
</ol>

<h3 id="span-configuring-leaf2-spine1-and-spine2-vms-span"><span>Configuring leaf2, spine1, and spine2 VMs</span></h3>

<p>The configuration steps for leaf2, spine1, and spine2 are the same as
those listed above for leaf1, however the file configurations are
different. Listed below are the configurations for each VM.</p>

<h4 id="span-leaf2-span"><span>leaf2</span></h4>

<ul>
<li><p><code>/etc/network/interfaces</code> file:</p>

<pre><code># The loopback network interface
auto lo
  iface lo inet loopback
  address 10.2.1.2/32

# The primary network interface
auto eth0
  iface eth0 inet dhcp

auto swp1
  iface swp1
  address 10.2.1.2/32

auto swp2
  iface swp2
  address 10.2.1.2/32

auto swp3
  iface swp3
  address 10.4.2.1/25
</code></pre></li>

<li><p><code>/etc/quagga/Quagga.conf</code> file:</p>

<pre><code>service integrated-vtysh-config 

interface swp1
  ip ospf network point-to-point

interface swp2
  ip ospf network point-to-point

router-id 10.2.1.2

router ospf
  ospf router-id 10.2.1.2                                                           
  network 10.2.1.2/32 area 0.0.0.0  
  network 10.4.2.0/24 area 0.0.0.0
</code></pre></li>
</ul>

<h4 id="span-spine1-span"><span>spine1</span></h4>

<ul>
<li><p><code>/etc/network/interfaces</code> file:</p>

<pre><code># The loopback network interface
auto lo
  iface lo inet loopback
  address 10.2.1.3/32

# The primary network interface
auto eth0
  iface eth0 inet dhcp

auto swp1
  iface swp1
  address 10.2.1.3/32

auto swp2
  iface swp2
  address 10.2.1.3/32

auto swp3
  iface swp3
</code></pre></li>

<li><p><code>/etc/quagga/Quagga.conf</code> file:</p>

<pre><code>service integrated-vtysh-config 
    
interface swp1
  ip ospf network point-to-point
    
interface swp2
  ip ospf network point-to-point
    
router-id 10.2.1.3
    
router ospf
  ospf router-id 10.2.1.3
  network 10.2.1.3/32 area 0.0.0.0  
</code></pre></li>
</ul>

<h4 id="span-spine2-span"><span>spine2</span></h4>

<ul>
<li><p><code>/etc/network/interfaces</code> file:</p>

<pre><code># The loopback network interface
auto lo
  iface lo inet loopback
  address 10.2.1.4/32

# The primary network interface
auto eth0
  iface eth0 inet dhcp

auto swp1
  iface swp1
  address 10.2.1.4/32

auto swp2
  iface swp2
  address 10.2.1.4/32

auto swp3
  iface swp3
</code></pre></li>

<li><p><code>/etc/quagga/Quagga.conf</code> file:</p>

<pre><code>service integrated-vtysh-config 

interface swp1
  ip ospf network point-to-point

interface swp2
  ip ospf network point-to-point

router-id 10.2.1.4

router ospf
  ospf router-id 10.2.1.4
  network 10.2.1.4/32 area 0.0.0.0
</code></pre></li>
</ul>


<div class="notices note" > <p>Remember to restart the networking and Quagga services on all VMs before
continuing.</p>
 </div>


<h2 id="span-testing-the-connections-span"><span>Testing the Connections</span></h2>

<p>Once the VMs have been restarted, you can ping across VMs to test. From
leaf1:</p>

<ul>
<li><p>Ping leaf2:</p>

<pre><code>root@leaf1:~# ping 10.2.1.2
</code></pre></li>

<li><p>Ping spine1:</p>

<pre><code>root@leaf1:~# ping 10.2.1.3
</code></pre></li>

<li><p>Ping spine2:</p>

<pre><code>root@leaf1:~# ping 10.2.1.4
</code></pre></li>
</ul>

<h2 id="span-further-information-span"><span>Further Information</span></h2>

<p>For the next steps regarding configuring Cumulus VX, check out these
community articles, and the rest of the Cumulus Documentation:</p>

<ul>
<li><p>Management network with Cumulus VX:<br />
<a href="https://community.cumulusnetworks.com/cumulus/topics/using-a-management-vm-with-cumulus-vx" target="_blank">https://community.cumulusnetworks.com/cumulus/topics/using-a-management-vm-with-cumulus-vx</a></p></li>

<li><p>Network automation with Cumulus VX:<br />
<a href="https://community.cumulusnetworks.com/cumulus/topics/testing-network-automation-with-cumulus-vx-3028v0i4u6aw4" target="_blank">https://community.cumulusnetworks.com/cumulus/topics/testing-network-automation-with-cumulus-vx-3028v0i4u6aw4</a></p></li>

<li><p>Routing protocols: Unnumbered OSPF/BGP with Cumulus VX:<br />
<a href="https://community.cumulusnetworks.com/cumulus/topics/un-numbered-ospf-bgp-setup-on-vmware-esxi-with-cumulus-vx" target="_blank">https://community.cumulusnetworks.com/cumulus/topics/un-numbered-ospf-bgp-setup-on-vmware-esxi-with-cumulus-vx</a></p></li>

<li><p>Network redundancy: Multi-chassis Link Aggregation (MLAG) with
Cumulus VX:<br />
<a href="https://community.cumulusnetworks.com/cumulus/topics/spinning-up-a-virtual-mlag-environment" target="_blank">https://community.cumulusnetworks.com/cumulus/topics/spinning-up-a-virtual-mlag-environment</a></p></li>

<li><p>Network virtualization: Cumulus VX with VMware NSX:<br />
<a href="https://community.cumulusnetworks.com/cumulus/topics/integrating-cumulus-vx-with-vmware-nsx-using-vmware-esxi" target="_blank">https://community.cumulusnetworks.com/cumulus/topics/integrating-cumulus-vx-with-vmware-nsx-using-vmware-esxi</a></p></li>

<li><p>Cumulus Linux documentation:<br />
<a href="http://docs.cumulusnetworks.com/display/DOCS/" target="_blank">http://docs.cumulusnetworks.com/display/DOCS/</a></p></li>
</ul>

<article id="html-search-results" class="ht-content" style="display: none;">

</article>

<footer id="ht-footer">

</footer>
</article>

      <script src="https://utteranc.es/client.js"
        repo="CumulusNetworks/docs-internal"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
      </script>

    </div>
    

      


  

    <aside class="book-toc fixed">

  
    <div class="toc">
    
      <button>
      <a href="https://github.com/CumulusNetworks/docs/edit/master/content/version/cumulus-vx-25/Using-Cumulus-VX-with-VirtualBox/Creating-a-Two-Spine,-Two-Leaf-Topology.md" target="_blank" rel="noopener"><img src="/docs.cumulusnetworks.com/svg/pencil-circle.svg" alt="Edit" /> Edit this page</a>
      </button>
    
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#span-configuring-the-leaf1-vm-span"><span>Configuring the leaf1 VM</span></a></li>
<li><a href="#span-configuring-the-leaf2-vm-span"><span>Configuring the leaf2 VM</span></a></li>
<li><a href="#span-configuring-the-spine1-vm-span"><span>Configuring the spine1 VM</span></a></li>
<li><a href="#span-configuring-the-spine2-vm-span"><span>Configuring the spine2 VM</span></a></li>
<li><a href="#span-configuring-network-interfaces-and-quagga-span"><span>Configuring Network Interfaces and Quagga</span></a>
<ul>
<li><a href="#span-configuring-leaf1-vm-span"><span>Configuring leaf1 VM</span></a></li>
<li><a href="#span-configuring-leaf2-spine1-and-spine2-vms-span"><span>Configuring leaf2, spine1, and spine2 VMs</span></a>
<ul>
<li><a href="#span-leaf2-span"><span>leaf2</span></a></li>
<li><a href="#span-spine1-span"><span>spine1</span></a></li>
<li><a href="#span-spine2-span"><span>spine2</span></a></li>
</ul></li>
</ul></li>
<li><a href="#span-testing-the-connections-span"><span>Testing the Connections</span></a></li>
<li><a href="#span-further-information-span"><span>Further Information</span></a></li>
</ul></li>
</ul>
</nav>
    </div>
  

</aside>






  </main>
  <footer class="footer-top">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="footer-content">
            <div class="mb-4">
                <img src="https://static.cumulusnetworks.com/static/images/shared/cumulus-networks-rt-white-trademarked.ff839f1b2570.svg">
                <p> <script type="text/javascript">document.write(new Date().getFullYear());</script> Cumulus Networks.<br>
                Site by <a href="//unomena.com/" target="_blank">Unomena</a>.</p>
            </div>
            <ul class="mb-4">
              <li><h4>Products</h4></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-linux/">Cumulus Linux</a></li>
              <li><a href="//cumulusnetworks.com/products/netq/">Cumulus NetQ</a></li>
              <li><a href="//cumulusnetworks.com/products/cumulus-express/">Cumulus Express</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>Learn</h4></li>
              <li><a href="//cumulusnetworks.com/learn/web-scale-networking-education/">Going web-scale</a></li>
              <li><a href="//cumulusnetworks.com/learn/events/">Events</a></li>
              <li><a href="//cumulusnetworks.com/blog/">Blog</a></li>
            </ul>
            <ul class="mb-4">
              <li><h4>About</h4></li>
              <li><a href="//cumulusnetworks.com/about/">Our story</a></li>
              <li><a href="//cumulusnetworks.com/about/careers/">Careers</a></li>
              <li><a href="//cumulusnetworks.com/about/media-coverage/">Media coverage</a></li>
              <li><a href="//docs.cumulusnetworks.com/" target="_blank">Tech docs</a></li>
              <li><a href="//cumulusnetworks.com/community/">Community</a></li>
            </ul>
            <ul>
              <li>
                <a href="//twitter.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M23 6.628l-2-.5 1-2-2.464.7A4.48 4.48 0 0 0 12 8.128v1c-3.539.73-6.634-1.2-9.5-4.5q-.75 4 1.5 6l-3-.5c.405 2.069 1.362 3.7 4 4l-2.5 1c1 2 2.566 2.31 5 2.5a10.748 10.748 0 0 1-6.5 2c12.755 5.669 20-2.664 20-10V8.3z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.facebook.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M17.768 7.5H13.5V5.6a.972.972 0 0 1 1.012-1.1c.418 0 2.988.01 2.988.01V.5h-4.329C9.244.5 8.5 3.474 8.5 5.355V7.5h-3v4h3v12h5v-12h3.851z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//linkedin.com/company/cumulus-networks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                      .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M6.5 22.5h-5v-13h5zm9-9a2 2 0 0 0-2 2v7h-5v-13h5v1.485a6.307 6.307 0 0 1 3.99-1.495c2.962 0 5.01 2.2 5.01 6.355V22.5h-5v-7a2 2 0 0 0-2-2zM6.5 5A2.5 2.5 0 1 1 4 2.5 2.5 2.5 0 0 1 6.5 5z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//vimeo.com/CumulusNetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                      <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                      </style>
                    </defs>
                    <path class="a" d="M.5 7.393l.933 1.224S3.36 7.1 4 7.859s3.1 9.925 3.915 11.617c.714 1.483 2.684 3.444 4.845 2.042s9.34-7.529 10.626-14.769-8.642-5.723-9.693.583c2.627-1.577 4.03.642 2.686 3.154s-2.569 4.145-3.211 4.145-1.135-1.679-1.868-4.613c-.76-3.035-.755-8.5-3.911-7.882C4.412 2.721.5 7.393.5 7.393z"></path>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//www.github.com/cumulusnetworks/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <path class="a" d="M19.459 17c0-5.969-4.126-3.532-7.5-3.532s-7.5-2.375-7.5 3.532a3.5 3.5 0 0 0 3.5 3.5h8a3.5 3.5 0 0 0 3.5-3.5z"></path>
                    <path class="a" d="M21.489 10.214l.032.023s2.646-4.572-.6-7.237c-2 0-5.058 3.3-5.058 3.3l.022.016A14.152 14.152 0 0 0 8.1 6.3C8.083 6.285 5.037 3 3.042 3c-3.173 2.6-.729 7.012-.614 7.217a8.876 8.876 0 0 0-1.395 5.743c.241 3.126 2.847 6.54 5.982 6.54H16.9c3.135 0 5.742-3.414 5.982-6.54a8.857 8.857 0 0 0-1.393-5.746z"></path>
                    <ellipse class="a" cx="15.48" cy="17" rx="1" ry="1.5"></ellipse>
                    <ellipse class="a" cx="8.48" cy="17" rx="1" ry="1.5"></ellipse>
                  </svg>
                </a>
              </li>
              <li>
                <a href="//slack.cumulusnetworks.com/" target="_blank">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <defs>
                        <style>
                        .a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round}
                        </style>
                    </defs>
                    <rect class="a" x=".5" y=".5" width="23" height="23" rx="6" ry="6"></rect>
                    <circle class="a" cx="12" cy="12" r="6"></circle>
                    <circle class="a" cx="19" cy="5" r="1.5"></circle>
                  </svg>
                </a>
              </li>
              <li>
                <p>Cumulus Networks<sup></sup>  Data center networking software for the open, modern data center.</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <div class="footer-bottom">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <ul>
                      <li><a href="//cumulusnetworks.com/legal/trademarks/">Trademarks</a></li>
                      <li><a href="//cumulusnetworks.com/legal/privacy/">Privacy</a></li>
                      <li><a href="//cumulusnetworks.com/legal/">Terms of service</a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>

  
  

</body>

</html>
