<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Data Center Host to ToR Architecture - Cumulus Linux 3.2.1</title>

    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>


<link rel="stylesheet" href="assets/css/content-style.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

    </head>

<body pageid="5126727">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">CL321</span>
                    <img class="space-logo" src="spacelogo.png" />
                </h1>
                <a href="Cumulus_Linux_User_Guide.html" class="ht-space-link">
                    <h2>Cumulus Linux 3.2.1</h2>
                </a>
            </header>

            <nav class="ht-pages-nav">
                <ul class="ht-pages-nav-top">
                                                <li class="leaf">
        <a class="ht-nav-page-link" href="Quick_Start_Guide.html">Quick Start Guide</a>

            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Installation_Management.html">Installation Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Managing_Cumulus_Linux_Disk_Images.html">Managing Cumulus Linux Disk Images</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Installing_a_New_Cumulus_Linux_Image.html">Installing a New Cumulus Linux Image</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Upgrading_Cumulus_Linux.html">Upgrading Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_Snapshots.html">Using Snapshots</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Adding_and_Updating_Packages.html">Adding and Updating Packages</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Zero_Touch_Provisioning_-_ZTP.html">Zero Touch Provisioning - ZTP</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="System_Configuration.html">System Configuration</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Command_Line_Utility.html">Network Command Line Utility</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Setting_Date_and_Time.html">Setting Date and Time</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Authentication,_Authorization,_and_Accounting.html">Authentication, Authorization, and Accounting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="SSH_for_Remote_Access.html">SSH for Remote Access</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="User_Accounts.html">User Accounts</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_sudo_to_Delegate_Privileges.html">Using sudo to Delegate Privileges</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LDAP_Authentication_and_Authorization.html">LDAP Authentication and Authorization</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="TACACS_Plus.html">TACACS Plus</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Netfilter_-_ACLs.html">Netfilter - ACLs</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Default_Cumulus_Linux_ACL_Configuration.html">Default Cumulus Linux ACL Configuration</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Managing_Application_Daemons.html">Managing Application Daemons</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_switchd.html">Configuring switchd</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Power_over_Ethernet_-_PoE.html">Power over Ethernet - PoE</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_a_Global_Proxy.html">Configuring a Global Proxy</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Interface_Configuration_and_Management.html">Interface Configuration and Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Layer_1_and_Switch_Port_Attributes.html">Layer 1 and Switch Port Attributes</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Buffer_and_Queue_Management.html">Buffer and Queue Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_Hardware-enabled_DDOS_Protection.html">Configuring Hardware-enabled DDOS Protection</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_DHCP_Relays.html">Configuring DHCP Relays</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_DHCP_Servers.html">Configuring DHCP Servers</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Layer_One_and_Two.html">Layer One and Two</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Spanning_Tree_and_Rapid_Spanning_Tree.html">Spanning Tree and Rapid Spanning Tree</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Link_Layer_Discovery_Protocol.html">Link Layer Discovery Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Prescriptive_Topology_Manager_-_PTM.html">Prescriptive Topology Manager - PTM</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Bonding_-_Link_Aggregation.html">Bonding - Link Aggregation</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Ethernet_Bridging_-_VLANs.html">Ethernet Bridging - VLANs</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VLAN-aware_Bridge_Mode_for_Large-scale_Layer_2_Environments.html">VLAN-aware Bridge Mode for Large-scale Layer 2 Environments</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Traditional_Mode_Bridges.html">Traditional Mode Bridges</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VLAN_Tagging.html">VLAN Tagging</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Multi-Chassis_Link_Aggregation_-_MLAG.html">Multi-Chassis Link Aggregation - MLAG</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LACP_Bypass.html">LACP Bypass</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Virtual_Router_Redundancy_-_VRR.html">Virtual Router Redundancy - VRR</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="ifplugd.html">ifplugd</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="IGMP_and_MLD_Snooping.html">IGMP and MLD Snooping</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Virtualization.html">Network Virtualization</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Integrating_with_VMware_NSX.html">Integrating with VMware NSX</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack.html">Integrating Hardware VTEPs with Midokura MidoNet and OpenStack</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Lightweight_Network_Virtualization_-_LNV_Overview.html">Lightweight Network Virtualization - LNV Overview</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LNV_VXLAN_Active-Active_Mode.html">LNV VXLAN Active-Active Mode</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LNV_Full_Example.html">LNV Full Example</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Static_MAC_Bindings_with_VXLAN.html">Static MAC Bindings with VXLAN</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Ethernet_Virtual_Private_Network_-_EVPN.html">Ethernet Virtual Private Network - EVPN</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VXLAN_Hyperloop.html">VXLAN Hyperloop</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Static_VXLAN_Tunnels.html">Static VXLAN Tunnels</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Layer_Three.html">Layer Three</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Routing.html">Routing</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Introduction_to_Routing_Protocols.html">Introduction to Routing Protocols</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Topology.html">Network Topology</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Quagga_Overview.html">Quagga Overview</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Configuring_Quagga.html">Configuring Quagga</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Comparing_NCLU_and_vtysh_Commands.html">Comparing NCLU and vtysh Commands</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Open_Shortest_Path_First_-_OSPF_-_Protocol.html">Open Shortest Path First - OSPF - Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Open_Shortest_Path_First_v3_-_OSPFv3_-_Protocol.html">Open Shortest Path First v3 - OSPFv3 - Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Border_Gateway_Protocol_-_BGP.html">Border Gateway Protocol - BGP</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Bidirectional_Forwarding_Detection_-_BFD.html">Bidirectional Forwarding Detection - BFD</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP.html">Equal Cost Multipath Load Sharing - Hardware ECMP</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Redistribute_Neighbor.html">Redistribute Neighbor</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Virtual_Routing_and_Forwarding_-_VRF.html">Virtual Routing and Forwarding - VRF</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Management_VRF.html">Management VRF</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Protocol_Independent_Multicast_-_PIM.html">Protocol Independent Multicast - PIM</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Monitoring_and_Troubleshooting.html">Monitoring and Troubleshooting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Single_User_Mode_-_Boot_Recovery.html">Single User Mode - Boot Recovery</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Resource_Diagnostics_Using_cl-resource-query.html">Resource Diagnostics Using cl-resource-query</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Monitoring_System_Hardware.html">Monitoring System Hardware</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Switch_Port_LED_and_Status_LED_Guidelines.html">Network Switch Port LED and Status LED Guidelines</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Virtual_Device_Counters.html">Monitoring Virtual Device Counters</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Understanding_the_cl-support_Output_File.html">Understanding the cl-support Output File</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Troubleshooting_Log_Files.html">Troubleshooting Log Files</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Troubleshooting_the_etc_Directory.html">Troubleshooting the etc Directory</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Troubleshooting_Network_Interfaces.html">Troubleshooting Network Interfaces</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Interfaces_and_Transceivers_Using_ethtool.html">Monitoring Interfaces and Transceivers Using ethtool</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Troubleshooting.html">Network Troubleshooting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_NCLU_to_Troubleshoot_Your_Network_Configuration.html">Using NCLU to Troubleshoot Your Network Configuration</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_System_Statistics_and_Network_Traffic_with_sFlow.html">Monitoring System Statistics and Network Traffic with sFlow</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_netq_to_Troubleshoot_the_Network.html">Using netq to Troubleshoot the Network</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="SNMP_Monitoring.html">SNMP Monitoring</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_Nutanix_Prism_as_a_Monitoring_Tool.html">Using Nutanix Prism as a Monitoring Tool</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Best_Practices.html">Monitoring Best Practices</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Solutions.html">Network Solutions</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link current" href="Data_Center_Host_to_ToR_Architecture.html">Data Center Host to ToR Architecture</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Cumulus_Networks_Services_Demos.html">Cumulus Networks Services Demos</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Docker_on_Cumulus_Linux.html">Docker on Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="OpenStack_Neutron_ML2_and_Cumulus_Linux.html">OpenStack Neutron ML2 and Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Anycast_Design_Guide.html">Anycast Design Guide</a>

            </li>
                            </ul>
            </li>
                                                <li class="leaf">
        <a class="ht-nav-page-link" href="Cumulus_Linux_Index.html">Cumulus Linux Index</a>

            </li>
                                    </ul>
            </nav>
        </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Cumulus_Linux_User_Guide.html">Cumulus Linux 3.2.1</a></li>
                                                                                     <li><a href="Network_Solutions.html">Network Solutions</a></li>
                                                            </ul>
</div>            <h1 id="src-5127088"> <span>Data Center Host to ToR Architecture</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <p  >This chapter discusses the various architectures and strategies available from the top of rack (ToR) switches all the way down to the server hosts.    </p>
    <div class="section section-1" id="src-5127088_DataCenterHosttoToRArchitecture-Contents">
        <h1 class="heading "><span>Contents</span></h1>
    <p  class="expand-control-text">This chapter covers ...    </p>
    </div>
    <div class="section section-1" id="src-5127088_DataCenterHosttoToRArchitecture-Layer2-Architecture">
        <h1 class="heading "><span>Layer 2 - Architecture</span></h1>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-TraditionalSpanningTree-SingleAttached">
        <h2 class="heading "><span>Traditional Spanning Tree - Single Attached</span></h2>
    <p  ><strong class=" ">    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/singleattach.png" alt="images/download/attachments/5127088/singleattach.png"  height="250" />
</strong>    </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><a   href="Bonding_-_Link_Aggregation.html">Bond</a>/Etherchannel is not configured on host to multiple switches (bonds can still occur but only to one switch at a time), so leaf01 and leaf02 see two different MAC addresses.    </p>
    <p  ><strong class=" ">Configurations</strong>    </p>
    <p  ><strong class=" ">leaf01 Config</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto bridge</code></div>
<div class="line"><code class="plain">iface bridge</code></div>
<div class="line"><code class="plain">  bridge-vlan-aware yes</code></div>
<div class="line"><code class="plain">  bridge-ports swp1 peerlink</code></div>
<div class="line"><code class="plain">  bridge-vids 1-2000</code></div>
<div class="line"><code class="plain">  bridge-stp on</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto bridge.10</code></div>
<div class="line"><code class="plain">iface bridge.10</code></div>
<div class="line"><code class="plain">  address 10.1.10.2/24</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto peerlink</code></div>
<div class="line"><code class="plain">iface peerlink</code></div>
<div class="line"><code class="plain">    bond-slaves glob swp49-50</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto swp1</code></div>
<div class="line"><code class="plain">iface swp1</code></div>
<div class="line"><code class="plain">  mstpctl-portadminedge yes</code></div>
<div class="line"><code class="plain">  mstpctl-bpduguard yes</code></div>
</div>
    </div>
    <p  ><strong class=" ">Example Host Config (Ubuntu)</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto eth1</code></div>
<div class="line"><code class="plain">iface eth1 inet manual</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto eth1.10</code></div>
<div class="line"><code class="plain">iface eth1.10 inet manual</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto eth2</code></div>
<div class="line"><code class="plain">iface eth1 inet manual</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto eth2.20</code></div>
<div class="line"><code class="plain">iface eth2.20 inet manual</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto br-10</code></div>
<div class="line"><code class="plain">iface br-10 inet manual</code></div>
<div class="line"><code class="plain">  bridge-ports eth1.10 vnet0</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto br-20</code></div>
<div class="line"><code class="plain">iface br-20 inet manual</code></div>
<div class="line"><code class="plain">  bridge-ports eth2.20 vnet1</code></div>
</div>
    </div>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">Benefits</strong>    </p>
<ul class=" "><li class=" ">    <p  >Established technology    </p>
<ul class=" "><li class=" ">    <p  >Interoperability with other vendors    </p>
</li><li class=" ">    <p  >Easy configuration for customer    </p>
</li><li class=" ">    <p  >Immense documentation from multiple vendors and industry    </p>
</li></ul></li><li class=" ">    <p  >Ability to use <a   href="Spanning_Tree_and_Rapid_Spanning_Tree.html">spanning tree</a> commands    </p>
<ul class=" "><li class=" ">    <p  >mstpctl-portadminedge    </p>
</li><li class=" ">    <p  ><a   href="Spanning_Tree_and_Rapid_Spanning_Tree.html#src-5126866_SpanningTreeandRapidSpanningTree-bpdu">BPDU guard</a>    </p>
</li></ul></li><li class=" ">    <p  >Layer 2 reachability to all VMs    </p>
</li></ul>    <p  ><strong class=" ">Caveats</strong>    </p>
<ul class=" "><li class=" ">    <p  >The load balancing mechanism on the host can cause problems. If there is only host pinning to each NIC, there are no problems, but if you are doing a bond, you need to look at an MLAG solution.    </p>
</li><li class=" ">    <p  >No active-active host links. Some operating systems allow HA (NIC failover), but this still does not utilize all the bandwidth. VMs are using one NIC, not two.    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Active Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Passive Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">L2 to L3 Demarcation</strong>    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >None (not possible with traditional spanning tree)    </p>
</li></ul>    <p  >    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a   href="Virtual_Router_Redundancy_-_VRR.html">VRR</a>    </p>
</li><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/202971633-Deploying-VRRP-on-Cumulus-Linux">vrrpd</a>    </p>
</li></ul>    <p  ><strong class=" "><br/></strong>    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >ToR layer (recommended)    </p>
</li><li class=" ">    <p  >Spine layer    </p>
</li><li class=" ">    <p  >Core/edge/exit    </p>
</li></ul>    <p  class="expand-control-text">More Info...    </p>
    <p  >VRR or <tt class=" ">vrrpd</tt> can be configured on a pair of switches at any level in the network. However, the higher up the network you configure it, the larger the L2 domain becomes. The benefit here is L2 reachability. The drawback is the L2 domain is more difficult to troubleshoot, does not scale as well, and the pair of switches running VRR/vrrpd needs to carry the entire MAC address table of everything below it in the network. Minimizing the L2 domain as much as possible is recommended by Cumulus Professional Services. <a  class="external-link" href="https://docs.google.com/presentation/d/1l1d_6iUF7RTUHTSAmGuLwm3WCUXTNdFjndCLLxzBSOU/edit?usp=sharing">Please see this presentation for more information</a>.    </p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-mlagMLAG">
        <h2 class="heading "><span id="src-5127088_DataCenterHosttoToRArchitecture-mlag" class="confluence-anchor-link"></span><span>MLAG</span></h2>
    <p  ><strong class=" ">    <img  class="confluence-embedded-image confluence-thumbnail" src="images/download/thumbnails/5127088/mlag.png" alt="images/download/thumbnails/5127088/mlag.png"  height="150" />
</strong>    </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><a   href="Multi-Chassis_Link_Aggregation_-_MLAG.html">MLAG</a> (multi-chassis link aggregation) is when both uplinks are utilized at the same time. VRR gives the ability for both spines to act as gateways simultaneously for HA (high availability) and <a   href="LNV_VXLAN_Active-Active_Mode.html">active-active mode</a> (both are being used at the same time).    </p>
    <p  ><strong class=" ">Configurations</strong>    </p>
    <p  ><strong class=" ">leaf01 Config</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto bridge</code></div>
<div class="line"><code class="plain">iface bridge</code></div>
<div class="line"><code class="plain">  bridge-vlan-aware yes</code></div>
<div class="line"><code class="plain">  bridge-ports host-01 peerlink</code></div>
<div class="line"><code class="plain">  bridge-vids 1-2000</code></div>
<div class="line"><code class="plain">  bridge-stp on</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto bridge.10</code></div>
<div class="line"><code class="plain">iface bridge.10</code></div>
<div class="line"><code class="plain">  address 172.16.1.2/24</code></div>
<div class="line"><code class="plain">  address-virtual 44:38:39:00:00:10 172.16.1.1/24</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto peerlink</code></div>
<div class="line"><code class="plain">iface peerlink</code></div>
<div class="line"><code class="plain">    bond-slaves glob swp49-50</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto peerlink.4094</code></div>
<div class="line"><code class="plain">iface peerlink.4094</code></div>
<div class="line"><code class="plain">    address 169.254.1.2</code></div>
<div class="line"><code class="plain">    clagd-enable yes</code></div>
<div class="line"><code class="plain">    clagd-peer-ip 169.254.1.2</code></div>
<div class="line"><code class="plain">    clagd-system-mac 44:38:39:FF:40:94</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto host-01</code></div>
<div class="line"><code class="plain">iface host-01</code></div>
<div class="line"><code class="plain">  bond-slaves swp1</code></div>
<div class="line"><code class="plain">  clag-id 1</code></div>
<div class="line"><code class="plain">  {bond-defaults removed for brevity}</code></div>
</div>
    </div>
    <p  ><strong class=" ">Example Host Config (Ubuntu)</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto bond0</code></div>
<div class="line"><code class="plain">iface bond0 inet manual</code></div>
<div class="line"><code class="plain">  bond-slaves eth0 eth1</code></div>
<div class="line"><code class="plain">  {bond-defaults removed for brevity}</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto bond0.10</code></div>
<div class="line"><code class="plain">iface bond0.10 inet manual</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto vm-br10</code></div>
<div class="line"><code class="plain">iface vm-br10 inet manual</code></div>
<div class="line"><code class="plain">  bridge-ports bond0.10 vnet0</code></div>
</div>
    </div>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">Benefits</strong>    </p>
<ul class=" "><li class=" ">    <p  >100% of links utilized    </p>
</li></ul>    <p  ><strong class=" ">Caveats</strong>    </p>
<ul class=" "><li class=" ">    <p  >More complicated (more moving parts)    </p>
</li><li class=" ">    <p  >More configuration    </p>
</li><li class=" ">    <p  >No interoperability between vendors    </p>
</li><li class=" ">    <p  >ISL (inter-switch link) required    </p>
</li></ul>    <p  ><strong class=" ">Additional Comments</strong>    </p>
<ul class=" "><li class=" ">    <p  >Can be done with either the <a   href="Ethernet_Bridging_-_VLANs.html">traditional</a> or <a   href="VLAN-aware_Bridge_Mode_for_Large-scale_Layer_2_Environments.html">VLAN-aware</a> bridge driver depending on overall STP needs    </p>
</li><li class=" ">    <p  >There are a few different solutions including Cisco VPC and Arista MLAG, but none of them interoperate and are very vendor specific    </p>
</li><li class=" ">    <p  ><a  class="external-link" href="https://cumulusnetworks.com/media/resources/validated-design-guides/Cumulus-Linux-Layer-2-HA-Validated-Design-Guide_v1.0.0.pdf">Cumulus Networks Layer 2 HA validated design guide</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Active Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Passive Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">L2-&gt;L3 Demarcation</strong>    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a   href="Virtual_Router_Redundancy_-_VRR.html">VRR</a>    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/202971633-Deploying-VRRP-on-Cumulus-Linux">vrrpd</a>    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >ToR layer (recommended)    </p>
</li><li class=" ">    <p  >Spine layer    </p>
</li><li class=" ">    <p  >Core/edge/exit    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127088_DataCenterHosttoToRArchitecture-Layer3Architecture">
        <h1 class="heading "><span>Layer 3 Architecture</span></h1>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-Single-attachedHosts">
        <h2 class="heading "><span>Single-attached Hosts</span></h2>
    <p  >    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/Screen_Shot_2016-04-04_at_4.00.28_PM.png" alt="images/download/attachments/5127088/Screen_Shot_2016-04-04_at_4.00.28_PM.png"  height="250" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >The server (physical host) has only has one link to one ToR switch.    </p>
    <p  ><strong class=" ">Configurations</strong>    </p>
    <p  ><strong class=" ">leaf01 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto swp1</code></div>
<div class="line"><code class="plain">iface swp1</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code><code class="plain">/</code><code class="value">30</code></div>
</div>
    </div>
    <p  ><tt class=" ">/etc/quagga/Quagga.conf</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">router ospf</code></div>
<div class="line"><code class="plain">  router-id </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"><code class="keyword">interface</code><code class="plain"> swp1</code></div>
<div class="line"><code class="plain">  ip ospf area </code><code class="value">0</code></div>
</div>
    </div>
    <p  ><strong class=" ">leaf02 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto swp1</code></div>
<div class="line"><code class="plain">iface swp1</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">2.1</code><code class="plain">/</code><code class="value">30</code></div>
</div>
    </div>
    <p  ><tt class=" ">/etc/quagga/Quagga.conf</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">router ospf</code></div>
<div class="line"><code class="plain">  router-id </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.12</code></div>
<div class="line"><code class="keyword">interface</code><code class="plain"> swp1</code></div>
<div class="line"><code class="plain">  ip ospf area </code><code class="value">0</code></div>
</div>
    </div>
    <p  ><strong class=" ">host1 Example Config (Ubuntu)</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto eth1</code></div>
<div class="line"><code class="plain">iface eth1 inet </code><code class="keyword">static</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.2</code><code class="plain">/</code><code class="value">30</code></div>
<div class="line"><code class="plain">  up ip route add </code><code class="value">0.0</code><code class="plain">.</code><code class="value">0.0</code><code class="plain">/</code><code class="value">0</code><code class="plain"> nexthop via </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code></div>
</div>
    </div>
    <p  ><strong class=" ">host2 Example Config (Ubuntu)</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto eth1</code></div>
<div class="line"><code class="plain">iface eth1 inet </code><code class="keyword">static</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">2.2</code><code class="plain">/</code><code class="value">30</code></div>
<div class="line"><code class="plain">  up ip route add </code><code class="value">0.0</code><code class="plain">.</code><code class="value">0.0</code><code class="plain">/</code><code class="value">0</code><code class="plain"> nexthop via </code><code class="value">172.16</code><code class="plain">.</code><code class="value">2.1</code></div>
</div>
    </div>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" "><strong class=" ">Benefits</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >Relatively simple network configuration    </p>
</li><li class=" ">    <p  >No STP    </p>
</li><li class=" ">    <p  >No MLAG    </p>
</li><li class=" ">    <p  >No L2 loops    </p>
</li><li class=" ">    <p  >No crosslink between leafs    </p>
</li><li class=" ">    <p  >Greater route scaling and flexibility    </p>
</li></ul>    <p  ><strong class=" "><strong class=" ">Caveats</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >No redundancy for ToR, upgrades would cause downtime    </p>
</li><li class=" ">    <p  >Many customers do not have software to support application layer redundancy    </p>
</li></ul>    <p  ><strong class=" ">Additional Comments</strong>    </p>
<ul class=" "><li class=" ">    <p  >For additional bandwidth links between host and leaf may be bonded    </p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >No redundancy, uses single ToR as gateway.    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://cumulusnetworks.com/media/cumulus/pdf/technical/validated-design-guides/Big-Data-Cumulus-Linux-Validated-Design-Guide.pdf">Big Data validated design guide</a> uses single attached ToR    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-RedistributeNeighbor">
        <h2 class="heading "><span>Redistribute Neighbor</span></h2>
    <p  >    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/redisneigh.png" alt="images/download/attachments/5127088/redisneigh.png"  height="250" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/204339077">Redistribute neighbor</a> daemon grabs ARP entries dynamically, utilizes redistribute table for Quagga to grab these dynamic entries and redistribute them into the fabric.    </p>
    <p  >    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">Benefits</strong>    </p>
<ul class=" "><li class=" ">    <p  >Configuration in Quagga is simple (route-map + redist table)    </p>
</li><li class=" ">    <p  >Supported by Cumulus Networks    </p>
</li></ul>    <p  ><strong class=" ">Caveats</strong>    </p>
<ul class=" "><li class=" ">    <p  >Silent hosts don't receive traffic (depending on ARP).    </p>
</li><li class=" ">    <p  >IPv4 only.    </p>
</li><li class=" ">    <p  >If two VMs are on same L2 domain, they could learn about each other directly rather than utilizing gateway, which causes problems (VM migration for example, or getting their network routed). Put hosts on /32 (no other L2 adjacency).    </p>
</li><li class=" ">    <p  >VM move does not trigger route withdrawal from original leaf (4 hour timeout).    </p>
</li><li class=" ">    <p  >Clearing ARP impacts routing. May not be obvious.    </p>
</li><li class=" ">    <p  >No L2 adjacency between servers without VXLAN.    </p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >Equal cost route installed on server/host/hypervisor to both ToRs to load balance evenly.    </p>
</li><li class=" ">    <p  >For host/VM/container mobility, use the same default route on all hosts (such as x.x.x.1) but don't distribute or advertise the .1 on the ToR into the fabric. This allows the VM to use the same gateway no matter which pair of leafs it is cabled to.    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://cumulusnetworks.com/blog/introducing-rdnbr/">Cumulus Networks blog post introducing redistribute neighbor</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-RoutingontheHost">
        <h2 class="heading "><span>Routing on the Host</span></h2>
    <p  ><strong class=" ">    <img  class="confluence-embedded-image confluence-thumbnail" src="images/download/thumbnails/5127088/routingonhost.png" alt="images/download/thumbnails/5127088/routingonhost.png"  height="250" />
</strong>    </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >Routing on the host means there is a routing application (such as <a   href="https://docs.cumulusnetworks.com/display/DOCS/Quagga+Overview">Cumulus Networks Quagga</a>) either on the bare metal host (no VMs/containers) or the hypervisor (for example, Ubuntu with KVM). This is highly recommended by the Cumulus Networks Professional Services team.    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">Benefits</strong>    </p>
<ul class=" "><li class=" ">    <p  >No requirement for MLAG    </p>
</li><li class=" ">    <p  >No spanning-tree or layer 2 domain    </p>
</li><li class=" ">    <p  >No loops    </p>
</li><li class=" ">    <p  >3 or more ToRs can be used instead of usual 2    </p>
</li><li class=" ">    <p  >Host and VM mobility    </p>
</li><li class=" ">    <p  >Traffic engineering can be used to migrate traffic from one ToR to another for upgrading both hardware and software    </p>
</li></ul>    <p  ><strong class=" ">Caveats</strong>    </p>
<ul class=" "><li class=" ">    <p  >Certain hypervisors or host OSes might not support a routing application like Quagga and will require a virtual router on the hypervisor    </p>
</li><li class=" ">    <p  >No L2 adjacnecy between servers without VXLAN    </p>
</li></ul>    <p  >    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >The first hop is still the ToR, just like redistribute neighbor    </p>
</li><li class=" ">    <p  >A default route can be advertised by all leaf/ToRs for dynamic ECMP paths    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/216805858-Routing-on-the-Host-An-Introduction">Routing on the Host: An Introduction</a>    </p>
</li><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/213177027-Installing-the-Cumulus-Linux-Quagga-Package-on-an-Ubuntu-Server">Installing the Cumulus Linux Quagga Package on an Ubuntu Server</a>    </p>
</li><li class=" ">    <p  ><a   href="Configuring_Quagga.html">Configuring Quagga</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-RoutingontheVM">
        <h2 class="heading "><span>Routing on the VM</span></h2>
    <p  >    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/routingvm.png" alt="images/download/attachments/5127088/routingvm.png"  height="250" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >Instead of routing on the hypervisor, each virtual machine utilizes its own routing stack.    </p>
    <p  >    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">Benefits</strong>    </p>
<ul class=" "><li class=" ">    <p  >In addition to routing on host:    </p>
<ul class=" "><li class=" ">    <p  >Hypervisor/base OS does not need to be able to do routing    </p>
</li><li class=" ">    <p  >VMs can be authenticated into routing fabric    </p>
</li></ul></li></ul>    <p  ><strong class=" "><strong class=" ">Caveats</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >All VMs must be capable of routing    </p>
</li><li class=" ">    <p  >Scale considerations might need to be taken into an account &mdash;<br/>instead of one routing process, there are as many as there are VMs    </p>
</li><li class=" ">    <p  >No L2 adjacency between servers without VXLAN    </p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >The first hop is still the ToR, just like redistribute neighbor    </p>
</li><li class=" ">    <p  >Multiple ToRs (2+) can be used    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/216805858-Routing-on-the-Host-An-Introduction">Routing on the host: An Introduction</a>    </p>
</li><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/213177027-Installing-the-Cumulus-Linux-Quagga-Package-on-an-Ubuntu-Server">Installing the Cumulus Linux Quagga Package on an Ubuntu Server</a>    </p>
</li><li class=" ">    <p  ><a   href="Configuring_Quagga.html">Configuring Quagga</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-VirtualRouter">
        <h2 class="heading "><span>Virtual Router</span></h2>
    <p  >    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/vrouter.png" alt="images/download/attachments/5127088/vrouter.png"  height="250" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >Virtual router (vRouter) runs as a VM on the hypervisor/host, sends routes to the ToR using <a  class="unresolved" href="#src-5127088">BGP</a> or <a   href="Open_Shortest_Path_First_-_OSPF_-_Protocol.html">OSPF</a>.    </p>
    <p  >    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" "><strong class=" ">Benefits</strong></strong>    </p>
    <p  >In addition to routing on a host:    </p>
<ul class=" "><li class=" ">    <p  >Multi-tenancy can work (multiple customers sharing same racks)    </p>
</li><li class=" ">    <p  >Base OS does not need to be routing capable    </p>
</li></ul>    <p  ><strong class=" "><strong class=" ">Caveats</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  ><a   href="Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP.html">ECMP</a> might not work correctly (load balancing to multiple ToRs); Linux kernel in older versions is not capable of ECMP per flow (does it per packet)    </p>
</li><li class=" ">    <p  >No L2 adjacency between servers without VXLAN    </p>
</li></ul>    <p  >    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >The gateway would be the vRouter, which has two routes out (two ToRs)    </p>
</li><li class=" ">    <p  >Multiple vRouters could be used    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/216805858-Routing-on-the-Host-An-Introduction">Routing on the Host: An Introduction</a>    </p>
</li><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/213177027-Installing-the-Cumulus-Linux-Quagga-Package-on-an-Ubuntu-Server">Installing the Cumulus Linux Quagga Package on an Ubuntu Server</a>    </p>
</li><li class=" ">    <p  ><a   href="Configuring_Quagga.html">Configuring Quagga</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-AnycastwithManualRedistribution">
        <h2 class="heading "><span>Anycast with Manual Redistribution</span></h2>
    <p  >    <img  class="confluence-embedded-image confluence-thumbnail" src="images/download/thumbnails/5127088/anycast.png" alt="images/download/thumbnails/5127088/anycast.png"  height="150" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >In contrast to routing on the host (preferred), this method allows a user to route <strong class=" ">to</strong> the host. The ToRs are the gateway, as with redistribute neighbor, except because there is no daemon running, the networks must be manually configured under the routing process. There is a potential to black hole unless a script is run to remove the routes when the host no longer responds.    </p>
    <p  ><strong class=" ">Configurations</strong>    </p>
    <p  ><strong class=" ">leaf01 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto swp1</code></div>
<div class="line"><code class="plain">iface swp1</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code><code class="plain">/</code><code class="value">30</code></div>
</div>
    </div>
    <p  ><tt class=" ">/etc/quagga/Quagga.conf</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">router ospf</code></div>
<div class="line"><code class="plain">  router-id </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"><code class="keyword">interface</code><code class="plain"> swp1</code></div>
<div class="line"><code class="plain">  ip ospf area </code><code class="value">0</code></div>
</div>
    </div>
    <p  ><strong class=" ">leaf02 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto swp2</code></div>
<div class="line"><code class="plain">iface swp2</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code><code class="plain">/</code><code class="value">30</code></div>
</div>
    </div>
    <p  ><tt class=" ">/etc/quagga/Quagga.conf</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">router ospf</code></div>
<div class="line"><code class="plain">  router-id </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.12</code></div>
<div class="line"><code class="keyword">interface</code><code class="plain"> swp1</code></div>
<div class="line"><code class="plain">  ip ospf area </code><code class="value">0</code></div>
</div>
    </div>
    <p  ><strong class=" ">Example Host Config (Ubuntu)</strong>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto lo</code></div>
<div class="line"><code class="plain">iface lo inet loopback</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto lo:</code><code class="value">1</code></div>
<div class="line"><code class="plain">iface lo:</code><code class="value">1</code><code class="plain"> inet </code><code class="keyword">static</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.2</code><code class="plain">/</code><code class="value">32</code></div>
<div class="line"><code class="plain">  up ip route add </code><code class="value">0.0</code><code class="plain">.</code><code class="value">0.0</code><code class="plain">/</code><code class="value">0</code><code class="plain"> nexthop via </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code><code class="plain"> dev eth0 onlink nexthop via </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.1</code><code class="plain"> dev eth1 onlink</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto eth1</code></div>
<div class="line"><code class="plain">iface eth2 inet </code><code class="keyword">static</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.2</code><code class="plain">/</code><code class="value">32</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto eth2</code></div>
<div class="line"><code class="plain">iface eth2 inet </code><code class="keyword">static</code></div>
<div class="line"><code class="plain">  address </code><code class="value">172.16</code><code class="plain">.</code><code class="value">1.2</code><code class="plain">/</code><code class="value">32</code></div>
</div>
    </div>
    <p  >    </p>
    <p  >    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" "><strong class=" ">Benefits</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >Most benefits of routing <strong class=" ">on</strong> the host    </p>
</li><li class=" ">    <p  >No requirement for host to run routing    </p>
</li><li class=" ">    <p  >No requirement for redistribute neighbor    </p>
</li></ul>    <p  ><strong class=" "><strong class=" ">Caveats</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >Removing a subnet from one ToR and re-adding it to another (hence, network statements from your router process) is a manual process    </p>
</li><li class=" ">    <p  >Network team and server team would have to be in sync, or server team controls the ToR, or automation is being used whenever VM migration happens    </p>
</li><li class=" ">    <p  >When using VMs/containers it is very easy to black hole traffic, as the leafs continue to advertise prefixes even when VM is down    </p>
</li><li class=" ">    <p  >No L2 adjacency between servers without VXLAN    </p>
</li></ul>    <p  >    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">FHR (First Hop Redundancy)</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >The gateways would be the ToRs, exactly like redistribute neighbor with an equal cost route installed    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127088_DataCenterHosttoToRArchitecture-NetworkVirtualization">
        <h1 class="heading "><span>Network Virtualization</span></h1>
    <div class="section section-2" id="src-5127088_DataCenterHosttoToRArchitecture-LNVwithMLAG">
        <h2 class="heading "><span>LNV with MLAG</span></h2>
    <p  >    <img  class="confluence-embedded-image" src="images/download/attachments/5127088/lnvmlag.png" alt="images/download/attachments/5127088/lnvmlag.png"  height="250" />
        </p>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >Summary    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  >More Information    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >The host runs LACP (Etherchannel/bond) to the pair of ToRs. <a   href="Lightweight_Network_Virtualization_-_LNV_Overview.html">LNV</a> (Lightweight Network Virtualization) then transports the L2 bridges across an L3 fabric.    </p>
    <p  ><strong class=" ">Configurations</strong>    </p>
    <p  ><strong class=" ">leaf01 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto lo</code></div>
<div class="line"><code class="plain">iface lo inet loopback </code></div>
<div class="line"><code class="plain">  address </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.11</code><code class="plain">/</code><code class="value">32</code></div>
<div class="line"><code class="plain">  vxrd-src-ip </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"><code class="plain">  vxrd-svcnode-ip </code><code class="value">10.10</code><code class="plain">.</code><code class="value">10.10</code></div>
<div class="line"><code class="plain">  clagd-vxlan-anycast-ip </code><code class="value">36.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto vni-</code><code class="value">10</code></div>
<div class="line"><code class="plain">iface vni-</code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">  vxlan-id </code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">  vxlan-local-tunnelip </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto br-</code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">iface br-</code><code class="value">10</code></div>
<div class="line"><code class="plain">  bridge-ports swp1 vni-</code><code class="value">10</code></div>
</div>
    </div>
    <p  ><strong class=" ">leaf02 Config</strong>    </p>
    <p  ><tt class=" ">/etc/network/interfaces</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto lo</code></div>
<div class="line"><code class="plain">iface lo inet loopback </code></div>
<div class="line"><code class="plain">  address </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.12</code><code class="plain">/</code><code class="value">32</code></div>
<div class="line"><code class="plain">  Vxrd-src-ip </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.12</code></div>
<div class="line"><code class="plain">  vxrd-svcnode-ip </code><code class="value">10.10</code><code class="plain">.</code><code class="value">10.10</code></div>
<div class="line"><code class="plain">  clagd-vxlan-anycast-ip </code><code class="value">36.0</code><code class="plain">.</code><code class="value">0.11</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto vni-</code><code class="value">10</code></div>
<div class="line"><code class="plain">iface vni-</code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">  vxlan-id </code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">  vxlan-local-tunnelip </code><code class="value">10.0</code><code class="plain">.</code><code class="value">0.12</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">auto br-</code><code class="value">10</code><code class="plain"> </code></div>
<div class="line"><code class="plain">iface br-</code><code class="value">10</code></div>
<div class="line"><code class="plain">  bridge-ports swp1 vni-</code><code class="value">10</code></div>
</div>
    </div>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" "><strong class=" ">Benefits</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >Layer 2 domain is reduced to the pair of ToRs    </p>
</li><li class=" ">    <p  >Aggregation layer is all L3 (VLANs do not have to exist on spine switches)    </p>
</li><li class=" ">    <p  >Greater route scaling and flexibility    </p>
</li><li class=" ">    <p  >High availability    </p>
</li></ul>    <p  ><strong class=" "><strong class=" ">Caveats</strong></strong>    </p>
<ul class=" "><li class=" ">    <p  >Needs MLAG (with the same caveats from the <a   href="#src-5127088_DataCenterHosttoToRArchitecture-mlag">MLAG section</a> above) and <a   href="Spanning_Tree_and_Rapid_Spanning_Tree.html">spanning tree</a>    </p>
</li></ul>    <p  >    </p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    <div  class="tablewrap">
        <table class="confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Active Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Active-Passive Mode</strong>    </p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
        <p  ><strong class=" ">Demarcation</strong>    </p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a   href="Virtual_Router_Redundancy_-_VRR.html">VRR</a>    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a  class="external-link" href="https://support.cumulusnetworks.com/hc/en-us/articles/202971633-Deploying-VRRP-on-Cumulus-Linux">vrrpd</a> (not recommended, not tested, will be asymetrical)    </p>
</li></ul>            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  >ToR layer or exit leafs    </p>
</li></ul>            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
        <p  ><strong class=" ">More Information</strong>    </p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
        <p  >&nbsp;    </p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ul class=" "><li class=" ">    <p  ><a   href="Lightweight_Network_Virtualization_-_LNV_Overview.html">Cumulus Linux Lightweight Network Virtualization (LNV) documentation</a>    </p>
</li></ul>            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Network_Solutions.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Network Solutions</span>
        </a>
                <a href="Cumulus_Networks_Services_Demos.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Cumulus Networks Services Demos</span>
        </a>
    </nav>    
            
            <article id="html-search-results" class="ht-content" style="display: none;">
            <header class="ht-content-header">
                <div id="ht-spacetitle">
                    <ul>
                        <li><a href="Cumulus_Linux_User_Guide.html">Cumulus Linux 3.2.1</a></li>
                    </ul>
                </div>
                <h1>Search results</h1>
            </header>
            <div id="search-results"></div>
        </article>
    
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>


</body>
</html>
