<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Management VRF - Cumulus Linux 3.2.1</title>

    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>


<link rel="stylesheet" href="assets/css/content-style.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

    </head>

<body pageid="5126727">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">CL321</span>
                    <img class="space-logo" src="spacelogo.png" />
                </h1>
                <a href="Cumulus_Linux_User_Guide.html" class="ht-space-link">
                    <h2>Cumulus Linux 3.2.1</h2>
                </a>
            </header>

            <nav class="ht-pages-nav">
                <ul class="ht-pages-nav-top">
                                                <li class="leaf">
        <a class="ht-nav-page-link" href="Quick_Start_Guide.html">Quick Start Guide</a>

            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Installation_Management.html">Installation Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Managing_Cumulus_Linux_Disk_Images.html">Managing Cumulus Linux Disk Images</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Installing_a_New_Cumulus_Linux_Image.html">Installing a New Cumulus Linux Image</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Upgrading_Cumulus_Linux.html">Upgrading Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_Snapshots.html">Using Snapshots</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Adding_and_Updating_Packages.html">Adding and Updating Packages</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Zero_Touch_Provisioning_-_ZTP.html">Zero Touch Provisioning - ZTP</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="System_Configuration.html">System Configuration</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Command_Line_Utility.html">Network Command Line Utility</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Setting_Date_and_Time.html">Setting Date and Time</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Authentication,_Authorization,_and_Accounting.html">Authentication, Authorization, and Accounting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="SSH_for_Remote_Access.html">SSH for Remote Access</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="User_Accounts.html">User Accounts</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_sudo_to_Delegate_Privileges.html">Using sudo to Delegate Privileges</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LDAP_Authentication_and_Authorization.html">LDAP Authentication and Authorization</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="TACACS_Plus.html">TACACS Plus</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Netfilter_-_ACLs.html">Netfilter - ACLs</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Default_Cumulus_Linux_ACL_Configuration.html">Default Cumulus Linux ACL Configuration</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Managing_Application_Daemons.html">Managing Application Daemons</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_switchd.html">Configuring switchd</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Power_over_Ethernet_-_PoE.html">Power over Ethernet - PoE</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_a_Global_Proxy.html">Configuring a Global Proxy</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Interface_Configuration_and_Management.html">Interface Configuration and Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Layer_1_and_Switch_Port_Attributes.html">Layer 1 and Switch Port Attributes</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Buffer_and_Queue_Management.html">Buffer and Queue Management</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_Hardware-enabled_DDOS_Protection.html">Configuring Hardware-enabled DDOS Protection</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_DHCP_Relays.html">Configuring DHCP Relays</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Configuring_DHCP_Servers.html">Configuring DHCP Servers</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Layer_One_and_Two.html">Layer One and Two</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Spanning_Tree_and_Rapid_Spanning_Tree.html">Spanning Tree and Rapid Spanning Tree</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Link_Layer_Discovery_Protocol.html">Link Layer Discovery Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Prescriptive_Topology_Manager_-_PTM.html">Prescriptive Topology Manager - PTM</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Bonding_-_Link_Aggregation.html">Bonding - Link Aggregation</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Ethernet_Bridging_-_VLANs.html">Ethernet Bridging - VLANs</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VLAN-aware_Bridge_Mode_for_Large-scale_Layer_2_Environments.html">VLAN-aware Bridge Mode for Large-scale Layer 2 Environments</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Traditional_Mode_Bridges.html">Traditional Mode Bridges</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VLAN_Tagging.html">VLAN Tagging</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Multi-Chassis_Link_Aggregation_-_MLAG.html">Multi-Chassis Link Aggregation - MLAG</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LACP_Bypass.html">LACP Bypass</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Virtual_Router_Redundancy_-_VRR.html">Virtual Router Redundancy - VRR</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="ifplugd.html">ifplugd</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="IGMP_and_MLD_Snooping.html">IGMP and MLD Snooping</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Virtualization.html">Network Virtualization</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Integrating_with_VMware_NSX.html">Integrating with VMware NSX</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Integrating_Hardware_VTEPs_with_Midokura_MidoNet_and_OpenStack.html">Integrating Hardware VTEPs with Midokura MidoNet and OpenStack</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Lightweight_Network_Virtualization_-_LNV_Overview.html">Lightweight Network Virtualization - LNV Overview</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LNV_VXLAN_Active-Active_Mode.html">LNV VXLAN Active-Active Mode</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="LNV_Full_Example.html">LNV Full Example</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Static_MAC_Bindings_with_VXLAN.html">Static MAC Bindings with VXLAN</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Ethernet_Virtual_Private_Network_-_EVPN.html">Ethernet Virtual Private Network - EVPN</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="VXLAN_Hyperloop.html">VXLAN Hyperloop</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Static_VXLAN_Tunnels.html">Static VXLAN Tunnels</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Layer_Three.html">Layer Three</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Routing.html">Routing</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Introduction_to_Routing_Protocols.html">Introduction to Routing Protocols</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Topology.html">Network Topology</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Quagga_Overview.html">Quagga Overview</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Configuring_Quagga.html">Configuring Quagga</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Comparing_NCLU_and_vtysh_Commands.html">Comparing NCLU and vtysh Commands</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Open_Shortest_Path_First_-_OSPF_-_Protocol.html">Open Shortest Path First - OSPF - Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Open_Shortest_Path_First_v3_-_OSPFv3_-_Protocol.html">Open Shortest Path First v3 - OSPFv3 - Protocol</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Border_Gateway_Protocol_-_BGP.html">Border Gateway Protocol - BGP</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Bidirectional_Forwarding_Detection_-_BFD.html">Bidirectional Forwarding Detection - BFD</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Equal_Cost_Multipath_Load_Sharing_-_Hardware_ECMP.html">Equal Cost Multipath Load Sharing - Hardware ECMP</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Redistribute_Neighbor.html">Redistribute Neighbor</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Virtual_Routing_and_Forwarding_-_VRF.html">Virtual Routing and Forwarding - VRF</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link current" href="Management_VRF.html">Management VRF</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Protocol_Independent_Multicast_-_PIM.html">Protocol Independent Multicast - PIM</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Monitoring_and_Troubleshooting.html">Monitoring and Troubleshooting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Single_User_Mode_-_Boot_Recovery.html">Single User Mode - Boot Recovery</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Resource_Diagnostics_Using_cl-resource-query.html">Resource Diagnostics Using cl-resource-query</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Monitoring_System_Hardware.html">Monitoring System Hardware</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Network_Switch_Port_LED_and_Status_LED_Guidelines.html">Network Switch Port LED and Status LED Guidelines</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Virtual_Device_Counters.html">Monitoring Virtual Device Counters</a>

            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Understanding_the_cl-support_Output_File.html">Understanding the cl-support Output File</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Troubleshooting_Log_Files.html">Troubleshooting Log Files</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Troubleshooting_the_etc_Directory.html">Troubleshooting the etc Directory</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Troubleshooting_Network_Interfaces.html">Troubleshooting Network Interfaces</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Interfaces_and_Transceivers_Using_ethtool.html">Monitoring Interfaces and Transceivers Using ethtool</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Troubleshooting.html">Network Troubleshooting</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_NCLU_to_Troubleshoot_Your_Network_Configuration.html">Using NCLU to Troubleshoot Your Network Configuration</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_System_Statistics_and_Network_Traffic_with_sFlow.html">Monitoring System Statistics and Network Traffic with sFlow</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_netq_to_Troubleshoot_the_Network.html">Using netq to Troubleshoot the Network</a>

            </li>
                            </ul>
            </li>
                                        <li class="collapsed">
        <a class="ht-nav-page-link" href="SNMP_Monitoring.html">SNMP Monitoring</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Using_Nutanix_Prism_as_a_Monitoring_Tool.html">Using Nutanix Prism as a Monitoring Tool</a>

            </li>
                            </ul>
            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Monitoring_Best_Practices.html">Monitoring Best Practices</a>

            </li>
                            </ul>
            </li>
                                                <li class="collapsed">
        <a class="ht-nav-page-link" href="Network_Solutions.html">Network Solutions</a>

                    <span class="sp-toggle sp-aui-icon-small ht-pages-nav-toggle">
                <svg id="icon-minus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
                <svg id="icon-plus" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#CCCCCC">
                        <rect x="11" y="7" width="2" height="10"></rect>
                        <rect x="7" y="11" width="10" height="2"></rect>
                    </g>
                </svg>
            </span>

            <ul class="nav ht-pages-nav-sub">
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Data_Center_Host_to_ToR_Architecture.html">Data Center Host to ToR Architecture</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Cumulus_Networks_Services_Demos.html">Cumulus Networks Services Demos</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Docker_on_Cumulus_Linux.html">Docker on Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="OpenStack_Neutron_ML2_and_Cumulus_Linux.html">OpenStack Neutron ML2 and Cumulus Linux</a>

            </li>
                                        <li class="leaf">
        <a class="ht-nav-page-link" href="Anycast_Design_Guide.html">Anycast Design Guide</a>

            </li>
                            </ul>
            </li>
                                                <li class="leaf">
        <a class="ht-nav-page-link" href="Cumulus_Linux_Index.html">Cumulus Linux Index</a>

            </li>
                                    </ul>
            </nav>
        </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="Cumulus_Linux_User_Guide.html">Cumulus Linux 3.2.1</a></li>
                                                                                     <li><a href="Layer_Three.html">Layer Three</a></li>
                                                            </ul>
</div>            <h1 id="src-5127063"> <span>Management VRF</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

    <p  ><i class=" ">Management VRF</i> &mdash; a subset of <a   href="Virtual_Routing_and_Forwarding_-_VRF.html">VRF</a> (virtual routing tables and forwarding) &mdash; provides a separation between the out-of-band management network and the in-band data plane network. For all VRFs, the <i class=" ">main</i> routing table is the default table for all of the data plane switch ports. With management VRF, a second table, <i class=" ">mgmt</i>, is used for routing through the switch's Ethernet ports. The <i class=" ">mgmt</i> name is special cased to identify the management VRF from a data plane VRF. FIB rules are installed for DNS servers since this is the typical deployment case.    </p>
    <p  >Cumulus Linux only supports eth0 as the management interface, or eth1, depending on the switch platform. The Ethernet ports are software-only parts that are not hardware accelerated by <tt class=" ">switchd</tt>. VLAN subinterfaces, bonds, bridges and the front panel switch ports are not supported as management interfaces.    </p>
    <p  >When management VRF is enabled, logins to the switch are set into the management VRF context. IPv4 and IPv6 networking applications (for example, Ansible, Chef and <tt class=" ">apt-get</tt>) run by an administrator communicate out the management network by default. This default context does not impact services run through <tt class=" ">systemd</tt> and the <tt class=" ">systemctl</tt> command, and does not impact commands examining the state of the switch; for example, using the <tt class=" ">ip</tt> command to list links, neighbors or routes.    </p>
    <div  class="confbox admonition admonition-tip">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >The management VRF configurations in this chapter contain a localhost loopback IP address (127.0.0.1/8). Putting the loopback address in the management VRF's L3 domain prevents issues with applications that expect the loopback IP address to exist in the VRF, such as NTP.    </p>
        </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-Contents">
        <h1 class="heading "><span>Contents</span></h1>
    <p  class="expand-control-text">This chapter covers ...    </p>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-enablevrfEnablingManagementVRF">
        <h1 class="heading "><span id="src-5127063_ManagementVRF-enablevrf" class="confluence-anchor-link"></span><span>Enabling Management VRF</span></h1>
    <p  >To enable management VRF on eth0, complete the following steps:    </p>
    <div  class="confbox admonition admonition-info has-no-icon">
                    <p class="title">Example Management VRF Configuration</p>
                        <div class="admonition-body">
    <p  >The example NCLU commands below create a VRF called <i class=" ">mgmt</i>:    </p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >The management VRF must be named <tt class=" ">mgmt</tt> to differentiate from a data plane VRF.    </p>
        </div>
    </div>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@switch:~$ net add vrf mgmt</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ net pending</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ net commit</code></div>
</div>
    </div>
    <p  >The NCLU commands above create the following snippets in <tt class=" ">/etc/network/interfaces:</tt>    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">...</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">auto eth0</code></div>
<div class="line"><code class="plain">iface eth0 inet dhcp</code></div>
<div class="line"><code class="plain">    vrf mgmt</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">...</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">auto mgmt</code></div>
<div class="line"><code class="plain">iface mgmt</code></div>
<div class="line"><code class="plain">    address 127.0.0.1/8</code></div>
<div class="line"><code class="plain">    vrf-table auto</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">...</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >When you commit the change for adding the management VRF, it drops all connections over eth0. This can impact any automation that may be running, such as Ansible or Puppet scripts.    </p>
        </div>
    </div>
        </div>
    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-BringingtheManagementVRFUpafterDowningItwithifdown">
        <h2 class="heading "><span>Bringing the Management VRF Up after Downing It with ifdown</span></h2>
    <p  >If you take down the management VRF using <tt class=" ">ifdown</tt>, to bring it back up you need to do one of two things:    </p>
<ul class=" "><li class=" ">    <p  >Use <tt class=" ">ifup --with-depends &lt;vrf&gt;</tt>    </p>
</li><li class=" ">    <p  >Use <tt class=" ">ifreload -a</tt>    </p>
</li></ul>    <p  >For example:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@switch:~$ sudo ifdown mgmt</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ sudo ifup --with-depends mgmt</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >Running <tt class=" ">ifreload -a</tt> disconnects the session for any interface configured as <i class=" ">auto</i>.    </p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-EnablingNTP">
        <h2 class="heading "><span>Enabling NTP</span></h2>
    <p  >To enable NTP to run in the mgmt VRF:    </p>
<ol class=" "><li class=" ">    <p  >Configure the <tt class=" ">mgmt</tt> VRF as described in <a   href="#">the Enabling Management VRF section above</a>.    </p>
</li><li class=" ">    <p  >If NTP is running, stop the service:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl stop ntp.service</code></div>
</div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >By default, NTP is running in the default VRF, and to automatically start when the system boots; the NTP service needs to be stopped, disabled, and then restarted once the mgmt VRF is configured.    </p>
        </div>
    </div>
</li><li class=" ">    <p  >Disable NTP from automatically starting in the default VRF:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl disable ntp.service</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Start NTP in the mgmt VRF.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl start ntp</code><code class="color1">@mgmt</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Verify that NTP peers are active.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ ntpq -pn</code></div>
<div class="line"><code class="plain">     remote           refid      st t when poll reach   delay   offset  jitter</code></div>
<div class="line"><code class="plain">==============================================================================</code></div>
<div class="line"><code class="plain">*</code><code class="value">38.229</code><code class="plain">.</code><code class="value">71.1</code><code class="plain">     </code><code class="value">204.9</code><code class="plain">.</code><code class="value">54.119</code><code class="plain">     </code><code class="value">2</code><code class="plain"> u   </code><code class="value">42</code><code class="plain">   </code><code class="value">64</code><code class="plain">  </code><code class="value">377</code><code class="plain">   </code><code class="value">31.275</code><code class="plain">   -</code><code class="value">0.625</code><code class="plain">   </code><code class="value">3.105</code></div>
<div class="line"><code class="plain">-</code><code class="value">104.131</code><code class="plain">.</code><code class="value">53.252</code><code class="plain">  </code><code class="value">209.51</code><code class="plain">.</code><code class="value">161.238</code><code class="plain">   </code><code class="value">2</code><code class="plain"> u   </code><code class="value">47</code><code class="plain">   </code><code class="value">64</code><code class="plain">  </code><code class="value">377</code><code class="plain">   </code><code class="value">16.381</code><code class="plain">   -</code><code class="value">5.251</code><code class="plain">   </code><code class="value">0.681</code></div>
<div class="line"><code class="plain">+</code><code class="value">45.79</code><code class="plain">.</code><code class="value">10.228</code><code class="plain">    </code><code class="value">200.98</code><code class="plain">.</code><code class="value">196.212</code><code class="plain">   </code><code class="value">2</code><code class="plain"> u   </code><code class="value">44</code><code class="plain">   </code><code class="value">64</code><code class="plain">  </code><code class="value">377</code><code class="plain">   </code><code class="value">42.998</code><code class="plain">    </code><code class="value">0.115</code><code class="plain">   </code><code class="value">0.585</code></div>
<div class="line"><code class="plain">+</code><code class="value">74.207</code><code class="plain">.</code><code class="value">240.206</code><code class="plain">  </code><code class="value">127.67</code><code class="plain">.</code><code class="value">113.92</code><code class="plain">    </code><code class="value">2</code><code class="plain"> u   </code><code class="value">43</code><code class="plain">   </code><code class="value">64</code><code class="plain">  </code><code class="value">377</code><code class="plain">   </code><code class="value">73.240</code><code class="plain">   -</code><code class="value">1.623</code><code class="plain">   </code><code class="value">0.320</code><code class="plain"> </code></div>
</div>
    </div>
</li><li class=" ">    <p  >Enable ntp@mgmt so that it starts when the switch boots:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl enable ntp</code><code class="color1">@mgmt</code></div>
</div>
    </div>
</li></ol>    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-Enablingsnmpd">
        <h2 class="heading "><span>Enabling snmpd</span></h2>
    <p  >To enable <tt class=" ">snmpd</tt> to run in the mgmt VRF:    </p>
<ol class=" "><li class=" ">    <p  >Configure the <tt class=" ">mgmt</tt> VRF as described in <a   href="#">the Enabling Management VRF section above</a>.    </p>
</li><li class=" ">    <p  >Stop the <tt class=" ">snmpd</tt> daemon if it is running:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl stop snmpd.service</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Disable <tt class=" ">snmpd</tt> to ensure it does not start in the default VRF if the system is rebooted:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl disable snmpd.service</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Start <tt class=" ">snmpd</tt> in the the mgmt VRF:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl start snmpd</code><code class="color1">@mgmt</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Enable snmpd@mgmt so it starts when the switch boots:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo systemctl enable snmpd</code><code class="color1">@mgmt</code></div>
</div>
    </div>
</li></ol>    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-Enablinghsflowd">
        <h2 class="heading "><span>Enabling hsflowd</span></h2>
    <p  >If you're using <a   href="https://docs.cumulusnetworks.com/display/CL31/Monitoring+System+Statistics+and+Network+Traffic+with+sFlow">sFlow</a> to monitor traffic in the mgmt VRF, you need to complete the following steps to enable it.    </p>
<ol class=" "><li class=" ">    <p  >Add the <tt class=" ">hsflowd</tt> process to the <tt class=" ">systemd</tt> configuration file in <tt class=" ">/etc/vrf</tt>. Edit <tt class=" ">/etc/vrf/systemd.conf</tt> in a text editor.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@switch:~$ sudo nano /etc/vrf/systemd.conf </code></div>
<div class="line"><code class="plain"># Systemd-based services that are expected to be run in a VRF context.</code></div>
<div class="line"><code class="plain">#</code></div>
<div class="line"><code class="plain"># If changes are made to this file run systemctl daemon-reload</code></div>
<div class="line"><code class="plain"># to re-generate systemd files.</code></div>
<div class="line"><code class="plain">chef-client</code></div>
<div class="line"><code class="plain">collectd</code></div>
<div class="line"><code class="plain">dhcpd</code></div>
<div class="line"><code class="plain">dhcrelay</code></div>
<div class="line"><code class="plain">hsflowd  &lt;&lt;&lt; Add this line</code></div>
<div class="line"><code class="plain">ntp</code></div>
<div class="line"><code class="plain">puppet</code></div>
<div class="line"><code class="plain">snmpd</code></div>
<div class="line"><code class="plain">snmptrapd</code></div>
<div class="line"><code class="plain">ssh</code></div>
<div class="line"><code class="plain">zabbix-agent</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Stop, disable, reload, reenable and restart the <tt class=" ">hsflowd</tt> service.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@switch:~$ sudo systemctl stop hsflowd.service</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ sudo systemctl disable hsflowd.service</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ sudo systemctl daemon-reload</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ sudo systemctl enable hsflowd@mgmt.service</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ sudo systemctl start hsflowd@mgmt.service</code></div>
</div>
    </div>
</li><li class=" ">    <p  >Verify that the hsflowd service is running in the mgmt VRF.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@switch:~$ ps aux | grep flow</code></div>
<div class="line"><code class="plain">root      7294  0.0  0.4  81320  2108 ?        Ssl  22:22   0:00 /usr/sbin/hsflowd</code></div>
<div class="line"><code class="plain">cumulus   7906  0.0  0.4  12728  2056 pts/0    S+   22:34   0:00 grep flow</code></div>
<div class="line"><code class="plain">cumulus@switch:~$ vrf task identify 7294</code></div>
<div class="line"><code class="plain">mgmt</code></div>
</div>
    </div>
</li></ol>    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-Usingpingortraceroute">
        <h2 class="heading "><span>Using ping or traceroute</span></h2>
    <p  >By default, issuing a <tt class=" ">ping</tt> or <tt class=" ">traceroute</tt> assumes the packet should be sent to the dataplane network (the main routing table). If you wish to use <tt class=" ">ping</tt> or <tt class=" ">traceroute</tt> on the management network, use the <tt class=" ">-I</tt> flag for ping and <tt class=" ">-i</tt> for <tt class=" ">traceroute</tt>.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ ping -I mgmt</code></div>
</div>
    </div>
    <p  >Or:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo traceroute -i mgmt</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-OSPFandBGP">
        <h1 class="heading "><span>OSPF and BGP</span></h1>
    <p  >In general, no changes are required for either BGP or OSPF. Quagga was updated in Cumulus Linux 3.0 to be VRF-aware and automatically sends packets based on the switch port routing table. This includes BGP peering via loopback interfaces. BGP does routing lookups in the default table. However, one modification you may consider has to do with how your routes get redistributed.    </p>
    <div class="section section-2" id="src-5127063_ManagementVRF-RedistributingRoutesinManagementVRF">
        <h2 class="heading "><span>Redistributing Routes in Management VRF</span></h2>
    <p  >Management VRF uses the mgmt table, including local routes. It does not affect how the routes are redistributed when using routing protocols such as OSPF and BGP.    </p>
    <p  >To redistribute the routes in your network, use the <tt class=" ">redistribute connected</tt> command under BGP or OSPF. This enables the directly connected network out of eth0 to be advertised to its neighbor.    </p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >This also creates a route on the neighbor device to the management network through the data plane, which may not be desired.    </p>
        </div>
    </div>
    <p  >Cumulus Networks recommends you always use route maps to control the advertised networks redistributed by the <tt class=" ">redistribute connected</tt> command. For example, you can specify a route map to redistribute routes in this way (for both BGP and OSPF):    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus@leaf01:~$ net add routing route-map REDISTRIBUTE-CONNECTED deny 100 match interface eth0</code></div>
<div class="line"><code class="plain">cumulus@leaf01:~$ net add routing route-map REDISTRIBUTE-CONNECTED permit 1000</code></div>
</div>
    </div>
    <p  >These commands produce the following configuration snippet in the <tt class=" ">/etc/quagga/Quagga.conf</tt> file:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">&lt;routing protocol&gt; </code></div>
<div class="line"><code class="plain">redistribute connected route-map REDISTRIBUTE-CONNECTED</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">route-map REDISTRIBUTE-CONNECTED deny </code><code class="value">100</code></div>
<div class="line"><code class="plain"> match </code><code class="keyword">interface</code><code class="plain"> eth0</code></div>
<div class="line"><code class="plain">!</code></div>
<div class="line"><code class="plain">route-map REDISTRIBUTE-CONNECTED permit </code><code class="value">1000</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-SNMPTrapsUseeth0Only">
        <h1 class="heading "><span>SNMP Traps Use eth0 Only</span></h1>
    <p  >SNMP cannot use a switch port to send data. For any SNMP traps, this traffic gets sent out to eth0. Cumulus Networks plans to support switch ports in the future.    </p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >For SNMP, this restriction only applies to traps. SNMP polling is not affected.    </p>
        </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-UsingSSHwithinaManagementVRFContext">
        <h1 class="heading "><span>Using SSH within a Management VRF Context</span></h1>
    <p  >If you SSH to the switch through a switch port, it works as expected. If you need to SSH from the device out of a switch port, use <tt class=" ">vrf exec default ssh &lt;ip_address_of_swp_port&gt;</tt>. For example:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo vrf exec </code><code class="keyword">default</code><code class="plain"> ssh </code><code class="value">10.23</code><code class="plain">.</code><code class="value">23.2</code><code class="plain"> </code><code class="value">10.3</code><code class="plain">.</code><code class="value">3.3</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-ViewingtheRoutingTables">
        <h1 class="heading "><span>Viewing the Routing Tables</span></h1>
    <p  >When you look at the routing table with <tt class=" ">ip route show</tt>, you are looking at the switch port (<i class=" ">main</i>) table. You can also see the dataplane routing table with <tt class=" ">net show route vrf main</tt>.    </p>
    <p  >To look at information about eth0 (the management routing table), use <tt class=" ">net show route vrf mgmt</tt>.    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ net show route vrf mgmt</code></div>
<div class="line"><code class="keyword">default</code><code class="plain"> via </code><code class="value">192.168</code><code class="plain">.</code><code class="value">0.1</code><code class="plain"> dev eth0</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ net show route</code></div>
<div class="line"><code class="keyword">default</code><code class="plain"> via </code><code class="value">10.23</code><code class="plain">.</code><code class="value">23.3</code><code class="plain"> dev swp17  proto zebra  metric </code><code class="value">20</code></div>
<div class="line"><code class="value">10.3</code><code class="plain">.</code><code class="value">3.3</code><code class="plain"> via </code><code class="value">10.23</code><code class="plain">.</code><code class="value">23.3</code><code class="plain"> dev swp17</code></div>
<div class="line"><code class="value">10.23</code><code class="plain">.</code><code class="value">23.0</code><code class="plain">/</code><code class="value">24</code><code class="plain"> dev swp17  proto kernel  scope link  src </code><code class="value">10.23</code><code class="plain">.</code><code class="value">23.2</code></div>
<div class="line"><code class="value">192.168</code><code class="plain">.</code><code class="value">0.0</code><code class="plain">/</code><code class="value">24</code><code class="plain"> dev eth0  proto kernel  scope link  src </code><code class="value">192.168</code><code class="plain">.</code><code class="value">0.11</code></div>
</div>
    </div>
    <div class="section section-2" id="src-5127063_ManagementVRF-ViewingaSingleRoute">
        <h2 class="heading "><span>Viewing a Single Route</span></h2>
    <p  >Note that if you use <tt class=" ">ip route get</tt> to return information about a single route, the command resolves over the <i class=" ">mgmt</i> table by default. To get information about the route in the switching silicon, use:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ net show route &lt;addr&gt; </code></div>
</div>
    </div>
    <p  >To get the route for any VRF, run:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ net show route vrf mgmt &lt;addr&gt;</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-UsingthemgmtInterfaceClass">
        <h1 class="heading "><span>Using the mgmt Interface Class</span></h1>
    <p  >In <tt class=" ">ifupdown2</tt> <a   href="Interface_Configuration_and_Management.html#src-5126993_InterfaceConfigurationandManagement-classes">interface classes</a> are used to create a user-defined grouping for interfaces. The special class <i class=" ">mgmt</i> is available to separate the switch's management interfaces from the data interfaces. This allows you to manage the data interfaces by default using <tt class=" ">ifupdown2</tt> commands. Performing operations on the <i class=" ">mgmt</i> interfaces requires specifying the <tt class=" ">--allow-mgmt</tt> option, which prevents inadvertent outages on the management interfaces. Cumulus Linux by default brings up all interfaces in both the <i class=" ">auto</i> (default) class and the <i class=" ">mgmt</i> interface class when the switch boots.    </p>
    <p  >You configure the management interface in <tt class=" ">/etc/network/interfaces</tt>. In the example below, the management interface, eth0, and the mgmt VRF stanzas are added to the <i class=" ">mgmt</i> interface class:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">auto lo</code></div>
<div class="line"><code class="plain">iface lo inet loopback </code></div>
<div class="line"> </div>
<div class="line"><code class="plain">allow-mgmt eth0</code></div>
<div class="line"><code class="plain">iface eth0 inet dhcp</code></div>
<div class="line"><code class="plain">    vrf mgmt</code></div>
<div class="line"><code class="plain">  </code></div>
<div class="line"><code class="plain">allow-mgmt mgmt</code></div>
<div class="line"><code class="plain">iface mgmt</code></div>
<div class="line"><code class="plain">    address </code><code class="value">127.0</code><code class="plain">.</code><code class="value">0.1</code><code class="plain">/</code><code class="value">8</code></div>
<div class="line"><code class="plain">    vrf-table auto </code></div>
</div>
    </div>
    <p  >When you run <tt class=" ">ifupdown2</tt> commands against the interfaces in the mgmt class, include <tt class=" ">--allow=mgmt</tt> with the commands. For example, to see which interfaces are in the mgmt interface class, run:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ ifquery l --allow=mgmt</code></div>
<div class="line"><code class="plain">eth0</code></div>
<div class="line"><code class="plain">mgmt </code></div>
</div>
    </div>
    <p  >To reload the configurations for interfaces in the mgmt class, run:    </p>
    <div  class="confbox programlisting">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code">
<div class="line"><code class="plain">cumulus</code><code class="color1">@switch</code><code class="plain">:~$ sudo ifreload --allow=mgmt</code></div>
</div>
    </div>
    <p  >However, you can still bring the management interface up and down using <tt class=" ">ifup eth0</tt> and <tt class=" ">ifdown eth0</tt>.    </p>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-ManagementVRFandDNS">
        <h1 class="heading "><span>Management VRF and DNS</span></h1>
    <p  >Cumulus Linux supports both DHCP and static DNS entries over management VRF through IP FIB rules. These rules are added to direct lookups to the DNS addresses out of the management VRF. However, nameservers configured through DHCP are automatically updated, while statically configured nameservers (configured in <tt class=" ">/etc/resolv.conf</tt>) only get updated when you run <tt class=" ">ifreload -a</tt>.    </p>
    <p  >Because DNS lookups are forced out of the management interface using FIB rules, this could affect data plane ports if there are overlapping addresses.    </p>
    </div>
    <div class="section section-1" id="src-5127063_ManagementVRF-Incompatibilitywithcl-ns-mgmt">
        <h1 class="heading "><span>Incompatibility with cl-ns-mgmt</span></h1>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
    <p  >Management VRF has replaced the management namespace functionality in Cumulus Linux. The management namespace feature (via the <tt class=" ">cl-ns-mgmt</tt> utility) has been deprecated, and the <tt class=" ">cl-ns-mgmt</tt> command has been removed.    </p>
        </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Virtual_Routing_and_Forwarding_-_VRF.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Virtual Routing and Forwarding - VRF</span>
        </a>
                <a href="Protocol_Independent_Multicast_-_PIM.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Protocol Independent Multicast - PIM</span>
        </a>
    </nav>    
            
            <article id="html-search-results" class="ht-content" style="display: none;">
            <header class="ht-content-header">
                <div id="ht-spacetitle">
                    <ul>
                        <li><a href="Cumulus_Linux_User_Guide.html">Cumulus Linux 3.2.1</a></li>
                    </ul>
                </div>
                <h1>Search results</h1>
            </header>
            <div id="search-results"></div>
        </article>
    
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>


</body>
</html>
